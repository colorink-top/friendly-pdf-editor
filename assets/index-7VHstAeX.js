var Co=(C,T)=>()=>(T||C((T={exports:{}}).exports,T),T.exports);var jo=Co((Ht,xt)=>{(function(){const T=document.createElement("link").relList;if(T&&T.supports&&T.supports("modulepreload"))return;for(const P of document.querySelectorAll('link[rel="modulepreload"]'))A(P);new MutationObserver(P=>{for(const D of P)if(D.type==="childList")for(const K of D.addedNodes)K.tagName==="LINK"&&K.rel==="modulepreload"&&A(K)}).observe(document,{childList:!0,subtree:!0});function m(P){const D={};return P.integrity&&(D.integrity=P.integrity),P.referrerPolicy&&(D.referrerPolicy=P.referrerPolicy),P.crossOrigin==="use-credentials"?D.credentials="include":P.crossOrigin==="anonymous"?D.credentials="omit":D.credentials="same-origin",D}function A(P){if(P.ep)return;P.ep=!0;const D=m(P);fetch(P.href,D)}})();(function(){var C=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||this||{},T=C._,m=Array.prototype,A=Object.prototype,P=typeof Symbol<"u"?Symbol.prototype:null,D=m.push,K=m.slice,R=A.toString,M=A.hasOwnProperty,j=Array.isArray,ne=Object.keys,Z=Object.create,Y=function(){},u=function(a){if(a instanceof u)return a;if(!(this instanceof u))return new u(a);this._wrapped=a};typeof Ht<"u"&&!Ht.nodeType?(typeof xt<"u"&&!xt.nodeType&&xt.exports&&(Ht=xt.exports=u),Ht._=u):C._=u,u.VERSION="1.8.3";var le=function(a,c,S){if(c===void 0)return a;switch(S){case 1:return function(O){return a.call(c,O)};case null:case 3:return function(O,E,x){return a.call(c,O,E,x)};case 4:return function(O,E,x,V){return a.call(c,O,E,x,V)}}return function(){return a.apply(c,arguments)}},be,q=function(a,c,S){return u.iteratee!==be?u.iteratee(a,c):a==null?u.identity:u.isFunction(a)?le(a,c,S):u.isObject(a)&&!u.isArray(a)?u.matcher(a):u.property(a)};u.iteratee=be=function(a,c){return q(a,c,1/0)};var W=function(a,c){return c=c==null?a.length-1:+c,function(){for(var S=Math.max(arguments.length-c,0),O=Array(S),E=0;E<S;E++)O[E]=arguments[E+c];switch(c){case 0:return a.call(this,O);case 1:return a.call(this,arguments[0],O);case 2:return a.call(this,arguments[0],arguments[1],O)}var x=Array(c+1);for(E=0;E<c;E++)x[E]=arguments[E];return x[c]=O,a.apply(this,x)}},l=function(a){if(!u.isObject(a))return{};if(Z)return Z(a);Y.prototype=a;var c=new Y;return Y.prototype=null,c},h=function(a){return function(c){return c==null?void 0:c[a]}},o=function(a,c){for(var S=c.length,O=0;O<S;O++){if(a==null)return;a=a[c[O]]}return S?a:void 0},f=Math.pow(2,53)-1,v=h("length"),b=function(a){var c=v(a);return typeof c=="number"&&c>=0&&c<=f};u.each=u.forEach=function(a,c,S){c=le(c,S);var O,E;if(b(a))for(O=0,E=a.length;O<E;O++)c(a[O],O,a);else{var x=u.keys(a);for(O=0,E=x.length;O<E;O++)c(a[x[O]],x[O],a)}return a},u.map=u.collect=function(a,c,S){c=q(c,S);for(var O=!b(a)&&u.keys(a),E=(O||a).length,x=Array(E),V=0;V<E;V++){var ue=O?O[V]:V;x[V]=c(a[ue],ue,a)}return x};var we=function(a){var c=function(S,O,E,x){var V=!b(S)&&u.keys(S),ue=(V||S).length,Ae=a>0?0:ue-1;for(x||(E=S[V?V[Ae]:Ae],Ae+=a);Ae>=0&&Ae<ue;Ae+=a){var Me=V?V[Ae]:Ae;E=O(E,S[Me],Me,S)}return E};return function(S,O,E,x){var V=arguments.length>=3;return c(S,le(O,x,4),E,V)}};u.reduce=u.foldl=u.inject=we(1),u.reduceRight=u.foldr=we(-1),u.find=u.detect=function(a,c,S){var O=b(a)?u.findIndex:u.findKey,E=O(a,c,S);if(E!==void 0&&E!==-1)return a[E]},u.filter=u.select=function(a,c,S){var O=[];return c=q(c,S),u.each(a,function(E,x,V){c(E,x,V)&&O.push(E)}),O},u.reject=function(a,c,S){return u.filter(a,u.negate(q(c)),S)},u.every=u.all=function(a,c,S){c=q(c,S);for(var O=!b(a)&&u.keys(a),E=(O||a).length,x=0;x<E;x++){var V=O?O[x]:x;if(!c(a[V],V,a))return!1}return!0},u.some=u.any=function(a,c,S){c=q(c,S);for(var O=!b(a)&&u.keys(a),E=(O||a).length,x=0;x<E;x++){var V=O?O[x]:x;if(c(a[V],V,a))return!0}return!1},u.contains=u.includes=u.include=function(a,c,S,O){return b(a)||(a=u.values(a)),(typeof S!="number"||O)&&(S=0),u.indexOf(a,c,S)>=0},u.invoke=W(function(a,c,S){var O,E;return u.isFunction(c)?E=c:u.isArray(c)&&(O=c.slice(0,-1),c=c[c.length-1]),u.map(a,function(x){var V=E;if(!V){if(O&&O.length&&(x=o(x,O)),x==null)return;V=x[c]}return V==null?V:V.apply(x,S)})}),u.pluck=function(a,c){return u.map(a,u.property(c))},u.where=function(a,c){return u.filter(a,u.matcher(c))},u.findWhere=function(a,c){return u.find(a,u.matcher(c))},u.max=function(a,c,S){var O=-1/0,E=-1/0,x,V;if(c==null||typeof c=="number"&&typeof a[0]!="object"&&a!=null){a=b(a)?a:u.values(a);for(var ue=0,Ae=a.length;ue<Ae;ue++)x=a[ue],x!=null&&x>O&&(O=x)}else c=q(c,S),u.each(a,function(Me,Ge,gt){V=c(Me,Ge,gt),(V>E||V===-1/0&&O===-1/0)&&(O=Me,E=V)});return O},u.min=function(a,c,S){var O=1/0,E=1/0,x,V;if(c==null||typeof c=="number"&&typeof a[0]!="object"&&a!=null){a=b(a)?a:u.values(a);for(var ue=0,Ae=a.length;ue<Ae;ue++)x=a[ue],x!=null&&x<O&&(O=x)}else c=q(c,S),u.each(a,function(Me,Ge,gt){V=c(Me,Ge,gt),(V<E||V===1/0&&O===1/0)&&(O=Me,E=V)});return O},u.shuffle=function(a){return u.sample(a,1/0)},u.sample=function(a,c,S){if(c==null||S)return b(a)||(a=u.values(a)),a[u.random(a.length-1)];var O=b(a)?u.clone(a):u.values(a),E=v(O);c=Math.max(Math.min(c,E),0);for(var x=E-1,V=0;V<c;V++){var ue=u.random(V,x),Ae=O[V];O[V]=O[ue],O[ue]=Ae}return O.slice(0,c)},u.sortBy=function(a,c,S){var O=0;return c=q(c,S),u.pluck(u.map(a,function(E,x,V){return{value:E,index:O++,criteria:c(E,x,V)}}).sort(function(E,x){var V=E.criteria,ue=x.criteria;if(V!==ue){if(V>ue||V===void 0)return 1;if(V<ue||ue===void 0)return-1}return E.index-x.index}),"value")};var Se=function(a,c){return function(S,O,E){var x=c?[[],[]]:{};return O=q(O,E),u.each(S,function(V,ue){var Ae=O(V,ue,S);a(x,V,Ae)}),x}};u.groupBy=Se(function(a,c,S){u.has(a,S)?a[S].push(c):a[S]=[c]}),u.indexBy=Se(function(a,c,S){a[S]=c}),u.countBy=Se(function(a,c,S){u.has(a,S)?a[S]++:a[S]=1});var Ie=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;u.toArray=function(a){return a?u.isArray(a)?K.call(a):u.isString(a)?a.match(Ie):b(a)?u.map(a,u.identity):u.values(a):[]},u.size=function(a){return a==null?0:b(a)?a.length:u.keys(a).length},u.partition=Se(function(a,c,S){a[S?0:1].push(c)},!0),u.first=u.head=u.take=function(a,c,S){if(!(a==null||a.length<1))return c==null||S?a[0]:u.initial(a,a.length-c)},u.initial=function(a,c,S){return K.call(a,0,Math.max(0,a.length-(c==null||S?1:c)))},u.last=function(a,c,S){if(!(a==null||a.length<1))return c==null||S?a[a.length-1]:u.rest(a,Math.max(0,a.length-c))},u.rest=u.tail=u.drop=function(a,c,S){return K.call(a,c==null||S?1:c)},u.compact=function(a){return u.filter(a,Boolean)};var te=function(a,c,S,O){O=O||[];for(var E=O.length,x=0,V=v(a);x<V;x++){var ue=a[x];if(b(ue)&&(u.isArray(ue)||u.isArguments(ue)))if(c)for(var Ae=0,Me=ue.length;Ae<Me;)O[E++]=ue[Ae++];else te(ue,c,S,O),E=O.length;else S||(O[E++]=ue)}return O};u.flatten=function(a,c){return te(a,c,!1)},u.without=W(function(a,c){return u.difference(a,c)}),u.uniq=u.unique=function(a,c,S,O){u.isBoolean(c)||(O=S,S=c,c=!1),S!=null&&(S=q(S,O));for(var E=[],x=[],V=0,ue=v(a);V<ue;V++){var Ae=a[V],Me=S?S(Ae,V,a):Ae;c?((!V||x!==Me)&&E.push(Ae),x=Me):S?u.contains(x,Me)||(x.push(Me),E.push(Ae)):u.contains(E,Ae)||E.push(Ae)}return E},u.union=W(function(a){return u.uniq(te(a,!0,!0))}),u.intersection=function(a){for(var c=[],S=arguments.length,O=0,E=v(a);O<E;O++){var x=a[O];if(!u.contains(c,x)){var V;for(V=1;V<S&&u.contains(arguments[V],x);V++);V===S&&c.push(x)}}return c},u.difference=W(function(a,c){return c=te(c,!0,!0),u.filter(a,function(S){return!u.contains(c,S)})}),u.unzip=function(a){for(var c=a&&u.max(a,v).length||0,S=Array(c),O=0;O<c;O++)S[O]=u.pluck(a,O);return S},u.zip=W(u.unzip),u.object=function(a,c){for(var S={},O=0,E=v(a);O<E;O++)c?S[a[O]]=c[O]:S[a[O][0]]=a[O][1];return S};var ie=function(a){return function(c,S,O){S=q(S,O);for(var E=v(c),x=a>0?0:E-1;x>=0&&x<E;x+=a)if(S(c[x],x,c))return x;return-1}};u.findIndex=ie(1),u.findLastIndex=ie(-1),u.sortedIndex=function(a,c,S,O){S=q(S,O,1);for(var E=S(c),x=0,V=v(a);x<V;){var ue=Math.floor((x+V)/2);S(a[ue])<E?x=ue+1:V=ue}return x};var ae=function(a,c,S){return function(O,E,x){var V=0,ue=v(O);if(typeof x=="number")a>0?V=x>=0?x:Math.max(x+ue,V):ue=x>=0?Math.min(x+1,ue):x+ue+1;else if(S&&x&&ue)return x=S(O,E),O[x]===E?x:-1;if(E!==E)return x=c(K.call(O,V,ue),u.isNaN),x>=0?x+V:-1;for(x=a>0?V:ue-1;x>=0&&x<ue;x+=a)if(O[x]===E)return x;return-1}};u.indexOf=ae(1,u.findIndex,u.sortedIndex),u.lastIndexOf=ae(-1,u.findLastIndex),u.range=function(a,c,S){c==null&&(c=a||0,a=0),S||(S=c<a?-1:1);for(var O=Math.max(Math.ceil((c-a)/S),0),E=Array(O),x=0;x<O;x++,a+=S)E[x]=a;return E},u.chunk=function(a,c){if(c==null||c<1)return[];for(var S=[],O=0,E=a.length;O<E;)S.push(K.call(a,O,O+=c));return S};var de=function(a,c,S,O,E){if(!(O instanceof c))return a.apply(S,E);var x=l(a.prototype),V=a.apply(x,E);return u.isObject(V)?V:x};u.bind=W(function(a,c,S){if(!u.isFunction(a))throw new TypeError("Bind must be called on a function");var O=W(function(E){return de(a,O,c,this,S.concat(E))});return O}),u.partial=W(function(a,c){var S=u.partial.placeholder,O=function(){for(var E=0,x=c.length,V=Array(x),ue=0;ue<x;ue++)V[ue]=c[ue]===S?arguments[E++]:c[ue];for(;E<arguments.length;)V.push(arguments[E++]);return de(a,O,this,this,V)};return O}),u.partial.placeholder=u,u.bindAll=W(function(a,c){c=te(c,!1,!1);var S=c.length;if(S<1)throw new Error("bindAll must be passed function names");for(;S--;){var O=c[S];a[O]=u.bind(a[O],a)}}),u.memoize=function(a,c){var S=function(O){var E=S.cache,x=""+(c?c.apply(this,arguments):O);return u.has(E,x)||(E[x]=a.apply(this,arguments)),E[x]};return S.cache={},S},u.delay=W(function(a,c,S){return setTimeout(function(){return a.apply(null,S)},c)}),u.defer=u.partial(u.delay,u,1),u.throttle=function(a,c,S){var O,E,x,V,ue=0;S||(S={});var Ae=function(){ue=S.leading===!1?0:u.now(),O=null,V=a.apply(E,x),O||(E=x=null)},Me=function(){var Ge=u.now();!ue&&S.leading===!1&&(ue=Ge);var gt=c-(Ge-ue);return E=this,x=arguments,gt<=0||gt>c?(O&&(clearTimeout(O),O=null),ue=Ge,V=a.apply(E,x),O||(E=x=null)):!O&&S.trailing!==!1&&(O=setTimeout(Ae,gt)),V};return Me.cancel=function(){clearTimeout(O),ue=0,O=E=x=null},Me},u.debounce=function(a,c,S){var O,E,x=function(ue,Ae){O=null,Ae&&(E=a.apply(ue,Ae))},V=W(function(ue){if(O&&clearTimeout(O),S){var Ae=!O;O=setTimeout(x,c),Ae&&(E=a.apply(this,ue))}else O=u.delay(x,c,this,ue);return E});return V.cancel=function(){clearTimeout(O),O=null},V},u.wrap=function(a,c){return u.partial(c,a)},u.negate=function(a){return function(){return!a.apply(this,arguments)}},u.compose=function(){var a=arguments,c=a.length-1;return function(){for(var S=c,O=a[c].apply(this,arguments);S--;)O=a[S].call(this,O);return O}},u.after=function(a,c){return function(){if(--a<1)return c.apply(this,arguments)}},u.before=function(a,c){var S;return function(){return--a>0&&(S=c.apply(this,arguments)),a<=1&&(c=null),S}},u.once=u.partial(u.before,2),u.restArgs=W;var me=!{toString:null}.propertyIsEnumerable("toString"),Oe=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Te=function(a,c){var S=Oe.length,O=a.constructor,E=u.isFunction(O)&&O.prototype||A,x="constructor";for(u.has(a,x)&&!u.contains(c,x)&&c.push(x);S--;)x=Oe[S],x in a&&a[x]!==E[x]&&!u.contains(c,x)&&c.push(x)};u.keys=function(a){if(!u.isObject(a))return[];if(ne)return ne(a);var c=[];for(var S in a)u.has(a,S)&&c.push(S);return me&&Te(a,c),c},u.allKeys=function(a){if(!u.isObject(a))return[];var c=[];for(var S in a)c.push(S);return me&&Te(a,c),c},u.values=function(a){for(var c=u.keys(a),S=c.length,O=Array(S),E=0;E<S;E++)O[E]=a[c[E]];return O},u.mapObject=function(a,c,S){c=q(c,S);for(var O=u.keys(a),E=O.length,x={},V=0;V<E;V++){var ue=O[V];x[ue]=c(a[ue],ue,a)}return x},u.pairs=function(a){for(var c=u.keys(a),S=c.length,O=Array(S),E=0;E<S;E++)O[E]=[c[E],a[c[E]]];return O},u.invert=function(a){for(var c={},S=u.keys(a),O=0,E=S.length;O<E;O++)c[a[S[O]]]=S[O];return c},u.functions=u.methods=function(a){var c=[];for(var S in a)u.isFunction(a[S])&&c.push(S);return c.sort()};var He=function(a,c){return function(S){var O=arguments.length;if(c&&(S=Object(S)),O<2||S==null)return S;for(var E=1;E<O;E++)for(var x=arguments[E],V=a(x),ue=V.length,Ae=0;Ae<ue;Ae++){var Me=V[Ae];(!c||S[Me]===void 0)&&(S[Me]=x[Me])}return S}};u.extend=He(u.allKeys),u.extendOwn=u.assign=He(u.keys),u.findKey=function(a,c,S){c=q(c,S);for(var O=u.keys(a),E,x=0,V=O.length;x<V;x++)if(E=O[x],c(a[E],E,a))return E};var ft=function(a,c,S){return c in S};u.pick=W(function(a,c){var S={},O=c[0];if(a==null)return S;u.isFunction(O)?(c.length>1&&(O=le(O,c[1])),c=u.allKeys(a)):(O=ft,c=te(c,!1,!1),a=Object(a));for(var E=0,x=c.length;E<x;E++){var V=c[E],ue=a[V];O(ue,V,a)&&(S[V]=ue)}return S}),u.omit=W(function(a,c){var S=c[0],O;return u.isFunction(S)?(S=u.negate(S),c.length>1&&(O=c[1])):(c=u.map(te(c,!1,!1),String),S=function(E,x){return!u.contains(c,x)}),u.pick(a,S,O)}),u.defaults=He(u.allKeys,!0),u.create=function(a,c){var S=l(a);return c&&u.extendOwn(S,c),S},u.clone=function(a){return u.isObject(a)?u.isArray(a)?a.slice():u.extend({},a):a},u.tap=function(a,c){return c(a),a},u.isMatch=function(a,c){var S=u.keys(c),O=S.length;if(a==null)return!O;for(var E=Object(a),x=0;x<O;x++){var V=S[x];if(c[V]!==E[V]||!(V in E))return!1}return!0};var Ue,vt;Ue=function(a,c,S,O){if(a===c)return a!==0||1/a===1/c;if(a==null||c==null)return!1;if(a!==a)return c!==c;var E=typeof a;return E!=="function"&&E!=="object"&&typeof c!="object"?!1:vt(a,c,S,O)},vt=function(a,c,S,O){a instanceof u&&(a=a._wrapped),c instanceof u&&(c=c._wrapped);var E=R.call(a);if(E!==R.call(c))return!1;switch(E){case"[object RegExp]":case"[object String]":return""+a==""+c;case"[object Number]":return+a!=+a?+c!=+c:+a==0?1/+a===1/c:+a==+c;case"[object Date]":case"[object Boolean]":return+a==+c;case"[object Symbol]":return P.valueOf.call(a)===P.valueOf.call(c)}var x=E==="[object Array]";if(!x){if(typeof a!="object"||typeof c!="object")return!1;var V=a.constructor,ue=c.constructor;if(V!==ue&&!(u.isFunction(V)&&V instanceof V&&u.isFunction(ue)&&ue instanceof ue)&&"constructor"in a&&"constructor"in c)return!1}S=S||[],O=O||[];for(var Ae=S.length;Ae--;)if(S[Ae]===a)return O[Ae]===c;if(S.push(a),O.push(c),x){if(Ae=a.length,Ae!==c.length)return!1;for(;Ae--;)if(!Ue(a[Ae],c[Ae],S,O))return!1}else{var Me=u.keys(a),Ge;if(Ae=Me.length,u.keys(c).length!==Ae)return!1;for(;Ae--;)if(Ge=Me[Ae],!(u.has(c,Ge)&&Ue(a[Ge],c[Ge],S,O)))return!1}return S.pop(),O.pop(),!0},u.isEqual=function(a,c){return Ue(a,c)},u.isEmpty=function(a){return a==null?!0:b(a)&&(u.isArray(a)||u.isString(a)||u.isArguments(a))?a.length===0:u.keys(a).length===0},u.isElement=function(a){return!!(a&&a.nodeType===1)},u.isArray=j||function(a){return R.call(a)==="[object Array]"},u.isObject=function(a){var c=typeof a;return c==="function"||c==="object"&&!!a},u.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(a){u["is"+a]=function(c){return R.call(c)==="[object "+a+"]"}}),u.isArguments(arguments)||(u.isArguments=function(a){return u.has(a,"callee")});var dt=C.document&&C.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof dt!="function"&&(u.isFunction=function(a){return typeof a=="function"||!1}),u.isFinite=function(a){return!u.isSymbol(a)&&isFinite(a)&&!isNaN(parseFloat(a))},u.isNaN=function(a){return u.isNumber(a)&&isNaN(a)},u.isBoolean=function(a){return a===!0||a===!1||R.call(a)==="[object Boolean]"},u.isNull=function(a){return a===null},u.isUndefined=function(a){return a===void 0},u.has=function(a,c){if(!u.isArray(c))return a!=null&&M.call(a,c);for(var S=c.length,O=0;O<S;O++){var E=c[O];if(a==null||!M.call(a,E))return!1;a=a[E]}return!!S},u.noConflict=function(){return C._=T,this},u.identity=function(a){return a},u.constant=function(a){return function(){return a}},u.noop=function(){},u.property=function(a){return u.isArray(a)?function(c){return o(c,a)}:h(a)},u.propertyOf=function(a){return a==null?function(){}:function(c){return u.isArray(c)?o(a,c):a[c]}},u.matcher=u.matches=function(a){return a=u.extendOwn({},a),function(c){return u.isMatch(c,a)}},u.times=function(a,c,S){var O=Array(Math.max(0,a));c=le(c,S,1);for(var E=0;E<a;E++)O[E]=c(E);return O},u.random=function(a,c){return c==null&&(c=a,a=0),a+Math.floor(Math.random()*(c-a+1))},u.now=Date.now||function(){return new Date().getTime()};var St={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},en=u.invert(St),tn=function(a){var c=function(x){return a[x]},S="(?:"+u.keys(a).join("|")+")",O=RegExp(S),E=RegExp(S,"g");return function(x){return x=x==null?"":""+x,O.test(x)?x.replace(E,c):x}};u.escape=tn(St),u.unescape=tn(en),u.result=function(a,c,S){u.isArray(c)||(c=[c]);var O=c.length;if(!O)return u.isFunction(S)?S.call(a):S;for(var E=0;E<O;E++){var x=a==null?void 0:a[c[E]];x===void 0&&(x=S,E=O),a=u.isFunction(x)?x.call(a):x}return a};var pn=0;u.uniqueId=function(a){var c=++pn+"";return a?a+c:c},u.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Nt=/(.)^/,nn={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},yn=/\\|'|\r|\n|\u2028|\u2029/g,rn=function(a){return"\\"+nn[a]};u.template=function(a,c,S){!c&&S&&(c=S),c=u.defaults({},c,u.templateSettings);var O=RegExp([(c.escape||Nt).source,(c.interpolate||Nt).source,(c.evaluate||Nt).source].join("|")+"|$","g"),E=0,x="__p+='";a.replace(O,function(Me,Ge,gt,Mt,Kt){return x+=a.slice(E,Kt).replace(yn,rn),E=Kt+Me.length,Ge?x+=`'+
((__t=(`+Ge+`))==null?'':_.escape(__t))+
'`:gt?x+=`'+
((__t=(`+gt+`))==null?'':__t)+
'`:Mt&&(x+=`';
`+Mt+`
__p+='`),Me}),x+=`';
`,c.variable||(x=`with(obj||{}){
`+x+`}
`),x=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+x+`return __p;
`;var V;try{if(c.async){const Me=(async function(){}).constructor;V=new Me(c.variable||"obj","_",x)}else V=new Function(c.variable||"obj","_",x)}catch(Me){throw Me.source=x,Me}var ue=function(Me){return V.call(this,Me,u)},Ae=c.variable||"obj";return ue.source="function("+Ae+`){
`+x+"}",ue},u.chain=function(a){var c=u(a);return c._chain=!0,c};var Et=function(a,c){return a._chain?u(c).chain():c};u.mixin=function(a){return u.each(u.functions(a),function(c){var S=u[c]=a[c];u.prototype[c]=function(){var O=[this._wrapped];return D.apply(O,arguments),Et(this,S.apply(u,O))}}),u},u.mixin(u),u.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var c=m[a];u.prototype[a]=function(){var S=this._wrapped;return c.apply(S,arguments),(a==="shift"||a==="splice")&&S.length===0&&delete S[0],Et(this,S)}}),u.each(["concat","join","slice"],function(a){var c=m[a];u.prototype[a]=function(){return Et(this,c.apply(this._wrapped,arguments))}}),u.prototype.value=function(){return this._wrapped},u.prototype.valueOf=u.prototype.toJSON=u.prototype.value,u.prototype.toString=function(){return String(this._wrapped)},typeof define=="function"&&define.amd&&define("underscore",[],function(){return u})})();const ze={};ze.parseBase64Data=function(C){var T,m;return m=C.substring(C.indexOf(":")+1,C.indexOf(";")),T=C.substring(C.indexOf(",")+1),{type:m,data:T}};ze.parseQueryString=function(C){var T,m,A;return T=C.indexOf(":"),A="",m=C,T>0&&(A=C.substring(0,T),m=C.substring(T+1)),{tag:A,q:m}};ze.dataURL2ObjectURL=function(C){if(!window.URL||!window.URL.createObjectURL)return"";const T=ze.dataURL2Blob(C);return T?window.URL.createObjectURL(T):""};ze.blobToString=function(C,T){const m=new FileReader;return m.onload=function(){return T(null,m.result)},m.readAsText(C)};ze.base642Blob=function(C,T){var m,A,P,D,K,R,M,j,ne,Z,Y,u;for(T=T||"",Y=1024,D=atob(C),R=D.length,u=Math.ceil(R/Y),P=new Array(u),Z=0;Z<u;){for(m=Z*Y,M=Math.min(m+Y,R),K=new Array(M-m),ne=m,j=0;ne<M;)K[j]=D[ne].charCodeAt(0),++j,++ne;P[Z]=new Uint8Array(K),Z++}return A=new Blob(P,{type:T}),A};ze.blob2Base64=function(C,T){var m;return m=new window.FileReader,m.onloadend=function(){var A,P;return P=m.result,A=P.substr(P.indexOf(",")+1),T(null,A)},m.readAsDataURL(C)};ze.blob2Text=function(C,T){var m;return m=new window.FileReader,m.onloadend=function(){return T(null,m.result)},m.readAsText(C)};ze.blob2DataURL=function(C,T){var m;return m=new window.FileReader,m.onloadend=function(){var A;return A=m.result,T(null,A)},m.readAsDataURL(C)};ze.dataURL2String=function(C){var T,m,A,P,D,K,R;if(!(!window.URL||!window.URL.createObjectURL)){if(K=C.split(",")[0],A=C.split(",")[1],T="",K.indexOf("base64")>=0){R=function(M){var j,ne,Z,Y;for(j=new ArrayBuffer(M.length),ne=new Uint8Array(j),Z=0,Y=M.length;Z<Y;)ne[Z]=M.charCodeAt(Z),Z++;return j};try{T=atob(A),m=R(T),P=new TextDecoder("UTF-8"),T=P.decode(m)}catch(M){D=M,T=""}}else T=unescape(A);return T}};ze.dataURL2Blob=function(C){var T,m,A,P,D,K,R,M,j;if(!(!window.URL||!window.URL.createObjectURL)){if(K=C.split(",")[0],A=C.split(",")[1],T="",K.indexOf("base64")>=0)try{T=atob(A)}catch(ne){P=ne,T=""}else T=unescape(A);for(D=K.split(":")[1].split(";")[0],m=new Uint8Array(T.length),R=M=0,j=T.length;0<=j?M<=j:M>=j;R=0<=j?++M:--M)m[R]=T.charCodeAt(R);return new Blob([m],{type:D})}};ze.objectURLToArrayBuffer=function(C,T){var m;if(!C){T("objectURL required");return}return m=new XMLHttpRequest,m.open("GET",C,!0),m.responseType="arraybuffer",m.onload=function(A){return this.status===200||this.status===0?T(null,this.response,this.getResponseHeader("Content-Type")||"image/png"):T("convert error")},m.onerror=function(A){return T(A)},m.send()};ze.objectURLToString=function(C,T){var m;return m=new XMLHttpRequest,m.open("GET",C,!0),m.responseType="text",m.onload=function(A){return this.status===200||this.status===0?T(null,this.response):T("convert error")},m.onerror=function(A){return T(A)},m.send()};ze.urlToBlob=function(C,T){C||T(""),fetch(C,{referrer:""}).then(m=>m.blob()).then(m=>T(m)).catch(m=>{T("")})};ze.urlToDataURL=function(C,T){var m;return m=new XMLHttpRequest,m.open("GET",C,!0),m.responseType="blob",m.onload=function(A){var P,D;return this.status===200||this.status===0?(P=this.response,D=new FileReader,D.onerror=function(K){return T(K)},D.onload=function(K){var R;return R=K.target.result,T(null,R)},D.readAsDataURL(P)):T("convert error")},m.onerror=function(A){T("error")},m.ontimeout=function(A){T("tiemout")},m.onabort=function(A){T("abort")},m.send()};ze.stringToArrayBuffer=function(C){var T,m;return T=new TextEncoder,m=T.encode(C),m};ze.arrayBufferToBase64=function(C){var T,m,A,P;for(T="",m=new Uint8Array(C),P=m.byteLength,A=0;A<P;)T+=String.fromCharCode(m[A]),A++;return window.btoa(T)};ze.base64ToArrayBuffer=function(C){var T,m,A,P;for(T=window.atob(C),P=T.length,m=new Uint8Array(P),A=0;A<P;)m[A]=T.charCodeAt(A),A++;return m.buffer};ze.blobToArrayBuffer=function(C,T){var m;return m=new FileReader,m.onerror=function(A){return T(A)},m.onload=function(){var A;return A=this.result,T(null,A)},m.readAsArrayBuffer(C)};ze.arrayBufferToNodeBuffer=function(C){var T,m,A,P,D;for(T=new Buffer(C.byteLength),D=new Uint8Array(C),m=A=0,P=T.length;A<P;m=++A)T[m],T[m]=D[m];return T};ze.nodeBufferToArrayBuffer=function(C){return new Uint8Array(C).buffer};ze.blobToMd5=function(C,T){return new Promise((m,A)=>{T||(T=(P,D)=>{P?A(P):m(D)}),ze.blobToArrayBuffer(C,function(P){return function(D,K){var R,M;return K?(M=new SparkMD5.ArrayBuffer,M.append(K),R=M.end(),T(null,R)):T(D)}}())})};const mn={};mn.timeoutFn=function(C="",T=3e3){return async function(){return new Promise(m=>{setTimeout(()=>{m(C)},T)})}};mn.timeoutProxyFn=async function(C,T={}){const m=mn.timeoutFn(T.result,T.maxTimeout);return Promise.race([C(),m()])};const zt=()=>{let C=Date.now();return C<=zt.previous?C=++zt.previous:zt.previous=C,C};zt.previous=0;const tt={},Do=function(C){var T,m,A,P,D,K,R,M;for(R=[],A=[].slice.call(C.attributes),M=[],D=0,K=A.length;D<K;D++)m=A[D],T=m.name,T.indexOf("on")===0?(P={},P.attribute=m.name,P.value=m.value,R.push(P),M.push(C.attributes.removeNamedItem(T))):M.push(void 0);return M};tt.stripScripts=function(C){var T,m,A,P,D,K,R,M,j,ne,Z;for(M=new DOMParser,Z=M.parseFromString("","text/html"),A=Z.body,A.innerHTML=C,R=A.getElementsByTagName("meta"),P=R.length;P--;)R[P].remove();for(j=A.getElementsByTagName("script"),P=j.length;P--;)T=j[P],T.remove();for(m=A.getElementsByTagName("*"),D=0,K=m.length;D<K;D++)ne=m[D],Do(ne);return A.innerHTML};tt.stripStyles=function(C){var T,m,A,P,D,K,R,M;for(K=new DOMParser,M=K.parseFromString("","text/html"),A=M.body,A.innerHTML=C,D=A.getElementsByTagName("link"),P=D.length;P--;)D[P].remove();for(R=A.getElementsByTagName("style"),P=R.length;P--;)T=R[P],m=T.outerHTML,T.outerHTML="<pre><code>"+_.escape(m)+"</code></pre>";return A.innerHTML};tt.escapeHtml=function(C){return C.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};tt.isElementInViewport=function(C){const T=C.ownerDocument;if(!T)return!1;const m=T.defaultView;if(!m)return!1;var A=C.getBoundingClientRect();return A.top>=0&&A.left>=0&&A.bottom<=(m.innerHeight||T.documentElement.clientHeight)&&A.right<=(m.innerWidth||T.documentElement.clientWidth)};tt.captureVideo=function(C){if(C.tagName!=="VIDEO")return"";const T=document.createElement("canvas");return T.width=C.videoWidth,T.height=C.videoHeight,T.getContext("2d").drawImage(C,0,0,C.videoWidth,C.videoHeight),T.toDataURL("image/jpeg")};tt.appHighlightPos=function(C,T){if(T=T||{},T.skipIfHighlighting&&tt.appHighlightPos.highlightPosTimeout)return;var m=document.querySelector(".app_highlight_pos_element"),A=function(){tt.appHighlightPos.highlightPosTimeout&&clearTimeout(tt.appHighlightPos.highlightPosTimeout),tt.appHighlightPos.highlightPosTimeout=null,m&&m.parentNode&&m.parentNode.removeChild(m)};tt.appHighlightPos.highlightPosTimeout&&(clearTimeout(tt.appHighlightPos.highlightPosTimeout),tt.appHighlightPos.highlightPosTimeout=null),m||(m=document.createElement("div"),m.classList.add("app_highlight_pos_element"),m.classList.add("highlight-pos"),document.body.append(m));let P=C.left,D=C.top;T.offsetLeft&&(P+=T.offsetLeft),T.offsetTop&&(D+=T.offsetTop),m.style.left=P+"px",m.style.top=D+"px",tt.appHighlightPos.highlightPosTimeout=setTimeout(A,T.autoHideTimeout||1e3)};tt.appHighlightPosByEl=function(C,T={}){const m=C.getBoundingClientRect(),A={left:m.left,top:m.top};T.rb&&(A.left+=m.width,A.top+=m.height),tt.appHighlightPos(A,T)};tt.convertElementToNewTagName=function(C,T){let m=C.tagName;const A=C.ownerDocument||document;if(m===T)return C;const P=A.createDocumentFragment();for(;C.firstChild;)P.appendChild(C.firstChild);const D=A.createElement(T);return D.appendChild(P),function(R,M){[...M.attributes].forEach(j=>{R.setAttribute(j.nodeName,j.nodeValue)})}(D,C),C.parentNode.replaceChild(D,C),D};window.CONSTANT||(window.CONSTANT={exportHosts:"http://localhost:3011",exportHost:"https://colorink.top"});var ni;const jt={host:(ni=window.CONSTANT)==null?void 0:ni.exportHost,maxFilesize:1024*1024*30},Po=async function(C){const T=async function(){return(await(await fetch(jt.host+"/getcrossorigindomainresource?"+new URLSearchParams({url:C}))).json()).data};return mn.timeoutProxyFn(T,{maxTimeout:1e4})},qo=function(C){const T=async function(A){return new Promise(function(P,D){C(A,function(K){P(K)})})},m=async function(A){const P=await T(A);return P||await Po(A)};return function(A,P){m(A).then(P).catch(()=>P(""))}},Lo=function(C,T){const m=new Image;m.onload=function(){const A=document.createElement("canvas");A.width=this.naturalWidth,A.height=this.naturalHeight,A.getContext("2d").drawImage(this,0,0),A.toBlob(T,"image/jpeg",.95)},m.onerror=function(){T()},m.src=C.src},ti=function(C,T){var m,A,P,D,K,R,M,j,ne,Z;const Y=$(C);if(Y.attr("width"),Y.attr("height"),M=C.naturalWidth||Y.width(),R=C.naturalHeight||Y.height(),Y.width(),Y.height(),T.indexOf("data:image/svg")===0)return ne=ze.dataURL2String(T),D=`
      <!DOCTYPE html>
      <html lang="en">
        <head>
          <meta charset="UTF-8">
          <style>
          html, body{
            margin: 0;
            padding: 0;
            overflow: hidden;
          }
          body>svg{
            width: ${M}px!important;
            height: ${R}px!important;
            max-width: 100%!important;
          }
          </style>
        </head>
        <body>
        ${ne}
        </body>
      </html>
    `,Z=ze.stringToArrayBuffer(D),K="data:text/html;base64,"+ze.arrayBufferToBase64(Z),j=Y.attr("style"),A=Y.attr("class"),P=Y.attr("id"),m=$("<iframe src='"+K+"' style='max-width: 100%;'></iframe"),m.attr("width",M),m.attr("height",R),j&&m.attr("style",j),A&&m.attr("class",A),P&&m.attr("id",P),m.css({border:"0",overflow:"hidden",width:M,height:R,display:"inline-block"}),Y.replaceWith(m)},Ro=function(C){C.find(".attachment, video, audio, iframe").remove(),C.find("picture").each(function(T,m){tt.convertElementToNewTagName(m,"div")}),C.find("figure").each(function(T,m){tt.convertElementToNewTagName(m,"div")}),C.find("figcaption").each(function(T,m){tt.convertElementToNewTagName(m,"span")})},Io={marginTop:10,marginRight:10,marginBottom:10,marginLeft:10,zoom:1,orientation:"Portrait",pageSize:"A4",pageWidth:-1,pageHeiht:-1,title:"",background:!0,pageOffset:0,toc:!0,tocHeaderText:"",tocDisableDottedLine:!1,tocLevelIndentation:-1,tocCustomStyle:"",outline:!0,outlineDepth:4,footerCenter:"[page]/[toPage]",footerLeft:"",footerRight:"",footerFontName:"Arial",footerFontSize:10,footerLine:!1,footerSpacing:0,headerCenter:"[section]",headerLeft:"",headerRight:"",headerFontName:"Arial",headerFontSize:10,headerLine:!0,headerSpacing:3,password:"",cover:!0,coverTitle:"",coverTitleFont:"bold 2em/1.2 serif",coverTitleFontColor:"#000000",coverSubTitle:"",coverSubTitleFont:"1.5em/1.1 sans-serif",coverSubTitleFontColor:"#000000",coverAuthor:"",coverAuthorFont:"0.8em/1 serif",coverAuthorFontColor:"#bbbbbb",coverImagePath:"",coverImageMD5:"",watermarker:!0,watermarkerLetters:"",watermarkerLettersFont:"bold 2em/1 serif",watermarkerLettersFontColor:"#000",watermarkerPosition:"mc",watermarkerPositionXOffset:0,watermarkerPositionYOffset:0,watermarkerAngle:315,watermarkerOpacity:1,waterImagePath:""},Bo=function(C,T,m,A,P,D,K,R){var l;C=C||{};const M=((l=C.user)==null?void 0:l.token)||"",j=C.authorizationHost||"";P=Object.assign({},Io,P);const ne=$("<div></div>");ne.html(T),Ro(ne);const Z={},Y=K.showProgressInfo||function(){},u=K.isCancel||function(){return!1};if(P.coverImage&&P.coverImageMD5){const h=ze.dataURL2Blob(P.coverImage),o=P.coverImage.split(";")[0];P.coverImage="",h.size>jt.maxFilesize?P.coverImageMD5="":(P.coverImageForMD5Prefix=o,Z[P.coverImageMD5]=h)}let le=0;const be=function(h,o){const f=$(h),v=h.src||"",b=function(){Y(`(1/3) Converting imgs [${le++}/${W.length}] ...`),o()};qo(D)(v,function(Se){if(!Se){h.src="",b();return}if(u()){b();return}if(/svg/i.test(h.dataset.filetype)){Se.indexOf("data:image/svg")===0?(ti(h,Se),b()):ze.urlToDataURL(Se,function(te,ie){ie&&(ti(h,ie),b())});return}const Ie=function(te){if(!te||u()){b();return}return ze.blobToMd5(te,function(ie,ae){return ae&&(Z[ae]=te,h.src="",te.size>jt.maxFilesize?Y("filesize too big, system will ignore it","error",{el:h,size:te.size}):(f.attr("data-export-pdf-md5",ae),f.attr("data-export-pdf",!0))),b()})};if(/webp|gif/i.test(h.dataset.filetype)){Lo(h,Ie);return}ze.urlToBlob(Se,Ie)})},q=function(h,o){if(u())return R("cancel");if(h==null&&(h="0"),o==null&&(o=0),o>10){R("upload fail by max limit");return}const f=1,v={fragment:ne.html(),style:A,access_token:M,authorization_host_string:j,title:m,config:JSON.stringify(P),resourceMD5s:Object.keys(Z),ignoreResource:h,resourceCacheVersion:f},b=JSON.stringify(v),we=new Blob([b]);return h==="0"&&Y(`(2/3) Uploading html and process pdf [${filesize(we.size)}]...`),$.ajax({url:`${jt.host}/pdf-server/vipexportpdffile`,type:"POST",data:v,success:function(Se,Ie,te){if(!Se||u())return R(JSON.stringify(Se));if(Se.uuid)return Y(`(3/3) Downloading Pdf ${filesize(Se.filesize)} ...`),R(null,Se,`${jt.host}/getpdffile?uuid=${Se.uuid}`,Se);if(Se.resourceIds&&Se.resourceIds.length>0){le=0,Y(`(2/3) Uploading imgs [${le}/${Se.resourceIds.length}] ...`);const ie=function(de,me){const Oe=Z[de],Te=function(){Oe&&Y(`(2/3) Uploading imgs [${le++}/${Se.resourceIds.length}] ${filesize(Oe.size)}...`),me()};if(!Oe||u())return Te();const He=new FormData,ft=new File([Oe],de);return He.append("resourcefile",ft),He.append("md5",de),He.append("access_token",M),He.append("authorization_host_string",j),He.append("resource_cache_version",f),$.ajax({url:`${jt.host}/pdf-server/uploadresource`,type:"POST",data:He,processData:!1,contentType:!1,success:function(Ue,vt,dt){return Te()},error:function(Ue,vt){return Te()}})},ae=function(){Y("(3/3) Processing Pdf  ..."),q("1",++o)};return async.mapSeries(Se.resourceIds,ie,ae)}return R(JSON.stringify(Se))},error:function(Se,Ie){return R(Ie)}})},W=ne.find("img").toArray();return Y(`(1/3) Converting imgs [${le}/${W.length}] ...`),async.mapLimit(W,20,be,function(){return q("0",0)})};(function(C){if(typeof Ht=="object"&&typeof xt<"u")xt.exports=C();else if(typeof define=="function"&&define.amd)define([],C);else{var T;typeof window<"u"?T=window:typeof global<"u"?T=global:typeof self<"u"?T=self:T=this,T.PouchDB=C()}})(function(){return function(){function C(T,m,A){function P(R,M){if(!m[R]){if(!T[R]){var j=typeof require=="function"&&require;if(!M&&j)return j(R,!0);if(D)return D(R,!0);var ne=new Error("Cannot find module '"+R+"'");throw ne.code="MODULE_NOT_FOUND",ne}var Z=m[R]={exports:{}};T[R][0].call(Z.exports,function(Y){var u=T[R][1][Y];return P(u||Y)},Z,Z.exports,C,T,m,A)}return m[R].exports}for(var D=typeof require=="function"&&require,K=0;K<A.length;K++)P(A[K]);return P}return C}()({1:[function(C,T,m){T.exports=A;function A(P){return function(){var D=arguments.length;if(D){for(var K=[],R=-1;++R<D;)K[R]=arguments[R];return P.call(this,K)}else return P.call(this,[])}}},{}],2:[function(C,T,m){},{}],3:[function(C,T,m){var A=Object.create||we,P=Object.keys||Se,D=Function.prototype.bind||Ie;function K(){(!this._events||!Object.prototype.hasOwnProperty.call(this,"_events"))&&(this._events=A(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}T.exports=K,K.EventEmitter=K,K.prototype._events=void 0,K.prototype._maxListeners=void 0;var R=10,M;try{var j={};Object.defineProperty&&Object.defineProperty(j,"x",{value:0}),M=j.x===0}catch{M=!1}M?Object.defineProperty(K,"defaultMaxListeners",{enumerable:!0,get:function(){return R},set:function(te){if(typeof te!="number"||te<0||te!==te)throw new TypeError('"defaultMaxListeners" must be a positive number');R=te}}):K.defaultMaxListeners=R,K.prototype.setMaxListeners=function(ie){if(typeof ie!="number"||ie<0||isNaN(ie))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=ie,this};function ne(te){return te._maxListeners===void 0?K.defaultMaxListeners:te._maxListeners}K.prototype.getMaxListeners=function(){return ne(this)};function Z(te,ie,ae){if(ie)te.call(ae);else for(var de=te.length,me=v(te,de),Oe=0;Oe<de;++Oe)me[Oe].call(ae)}function Y(te,ie,ae,de){if(ie)te.call(ae,de);else for(var me=te.length,Oe=v(te,me),Te=0;Te<me;++Te)Oe[Te].call(ae,de)}function u(te,ie,ae,de,me){if(ie)te.call(ae,de,me);else for(var Oe=te.length,Te=v(te,Oe),He=0;He<Oe;++He)Te[He].call(ae,de,me)}function le(te,ie,ae,de,me,Oe){if(ie)te.call(ae,de,me,Oe);else for(var Te=te.length,He=v(te,Te),ft=0;ft<Te;++ft)He[ft].call(ae,de,me,Oe)}function be(te,ie,ae,de){if(ie)te.apply(ae,de);else for(var me=te.length,Oe=v(te,me),Te=0;Te<me;++Te)Oe[Te].apply(ae,de)}K.prototype.emit=function(ie){var ae,de,me,Oe,Te,He,ft=ie==="error";if(He=this._events,He)ft=ft&&He.error==null;else if(!ft)return!1;if(ft){if(arguments.length>1&&(ae=arguments[1]),ae instanceof Error)throw ae;var Ue=new Error('Unhandled "error" event. ('+ae+")");throw Ue.context=ae,Ue}if(de=He[ie],!de)return!1;var vt=typeof de=="function";switch(me=arguments.length,me){case 1:Z(de,vt,this);break;case 2:Y(de,vt,this,arguments[1]);break;case 3:u(de,vt,this,arguments[1],arguments[2]);break;case 4:le(de,vt,this,arguments[1],arguments[2],arguments[3]);break;default:for(Oe=new Array(me-1),Te=1;Te<me;Te++)Oe[Te-1]=arguments[Te];be(de,vt,this,Oe)}return!0};function q(te,ie,ae,de){var me,Oe,Te;if(typeof ae!="function")throw new TypeError('"listener" argument must be a function');if(Oe=te._events,Oe?(Oe.newListener&&(te.emit("newListener",ie,ae.listener?ae.listener:ae),Oe=te._events),Te=Oe[ie]):(Oe=te._events=A(null),te._eventsCount=0),!Te)Te=Oe[ie]=ae,++te._eventsCount;else if(typeof Te=="function"?Te=Oe[ie]=de?[ae,Te]:[Te,ae]:de?Te.unshift(ae):Te.push(ae),!Te.warned&&(me=ne(te),me&&me>0&&Te.length>me)){Te.warned=!0;var He=new Error("Possible EventEmitter memory leak detected. "+Te.length+' "'+String(ie)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');He.name="MaxListenersExceededWarning",He.emitter=te,He.type=ie,He.count=Te.length}return te}K.prototype.addListener=function(ie,ae){return q(this,ie,ae,!1)},K.prototype.on=K.prototype.addListener,K.prototype.prependListener=function(ie,ae){return q(this,ie,ae,!0)};function W(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var te=new Array(arguments.length),ie=0;ie<te.length;++ie)te[ie]=arguments[ie];this.listener.apply(this.target,te)}}function l(te,ie,ae){var de={fired:!1,wrapFn:void 0,target:te,type:ie,listener:ae},me=D.call(W,de);return me.listener=ae,de.wrapFn=me,me}K.prototype.once=function(ie,ae){if(typeof ae!="function")throw new TypeError('"listener" argument must be a function');return this.on(ie,l(this,ie,ae)),this},K.prototype.prependOnceListener=function(ie,ae){if(typeof ae!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(ie,l(this,ie,ae)),this},K.prototype.removeListener=function(ie,ae){var de,me,Oe,Te,He;if(typeof ae!="function")throw new TypeError('"listener" argument must be a function');if(me=this._events,!me)return this;if(de=me[ie],!de)return this;if(de===ae||de.listener===ae)--this._eventsCount===0?this._events=A(null):(delete me[ie],me.removeListener&&this.emit("removeListener",ie,de.listener||ae));else if(typeof de!="function"){for(Oe=-1,Te=de.length-1;Te>=0;Te--)if(de[Te]===ae||de[Te].listener===ae){He=de[Te].listener,Oe=Te;break}if(Oe<0)return this;Oe===0?de.shift():f(de,Oe),de.length===1&&(me[ie]=de[0]),me.removeListener&&this.emit("removeListener",ie,He||ae)}return this},K.prototype.removeAllListeners=function(ie){var ae,de,me;if(de=this._events,!de)return this;if(!de.removeListener)return arguments.length===0?(this._events=A(null),this._eventsCount=0):de[ie]&&(--this._eventsCount===0?this._events=A(null):delete de[ie]),this;if(arguments.length===0){var Oe=P(de),Te;for(me=0;me<Oe.length;++me)Te=Oe[me],Te!=="removeListener"&&this.removeAllListeners(Te);return this.removeAllListeners("removeListener"),this._events=A(null),this._eventsCount=0,this}if(ae=de[ie],typeof ae=="function")this.removeListener(ie,ae);else if(ae)for(me=ae.length-1;me>=0;me--)this.removeListener(ie,ae[me]);return this};function h(te,ie,ae){var de=te._events;if(!de)return[];var me=de[ie];return me?typeof me=="function"?ae?[me.listener||me]:[me]:ae?b(me):v(me,me.length):[]}K.prototype.listeners=function(ie){return h(this,ie,!0)},K.prototype.rawListeners=function(ie){return h(this,ie,!1)},K.listenerCount=function(te,ie){return typeof te.listenerCount=="function"?te.listenerCount(ie):o.call(te,ie)},K.prototype.listenerCount=o;function o(te){var ie=this._events;if(ie){var ae=ie[te];if(typeof ae=="function")return 1;if(ae)return ae.length}return 0}K.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function f(te,ie){for(var ae=ie,de=ae+1,me=te.length;de<me;ae+=1,de+=1)te[ae]=te[de];te.pop()}function v(te,ie){for(var ae=new Array(ie),de=0;de<ie;++de)ae[de]=te[de];return ae}function b(te){for(var ie=new Array(te.length),ae=0;ae<ie.length;++ae)ie[ae]=te[ae].listener||te[ae];return ie}function we(te){var ie=function(){};return ie.prototype=te,new ie}function Se(te){for(var ie in te)Object.prototype.hasOwnProperty.call(te,ie);return ie}function Ie(te){var ie=this;return function(){return ie.apply(te,arguments)}}},{}],4:[function(C,T,m){var A=[C(2),C(7),C(6),C(5),C(8),C(9)],P,D,K=-1,R=[],M=!1;function j(){!P||!D||(P=!1,D.length?R=D.concat(R):K=-1,R.length&&ne())}function ne(){if(!P){M=!1,P=!0;for(var q=R.length,W=setTimeout(j);q;){for(D=R,R=[];D&&++K<q;)D[K].run();K=-1,q=R.length}D=null,K=-1,P=!1,clearTimeout(W)}}for(var Z,Y=-1,u=A.length;++Y<u;)if(A[Y]&&A[Y].test&&A[Y].test()){Z=A[Y].install(ne);break}function le(q,W){this.fun=q,this.array=W}le.prototype.run=function(){var q=this.fun,W=this.array;switch(W.length){case 0:return q();case 1:return q(W[0]);case 2:return q(W[0],W[1]);case 3:return q(W[0],W[1],W[2]);default:return q.apply(null,W)}},T.exports=be;function be(q){var W=new Array(arguments.length-1);if(arguments.length>1)for(var l=1;l<arguments.length;l++)W[l-1]=arguments[l];R.push(new le(q,W)),!M&&!P&&(M=!0,Z())}},{2:2,5:5,6:6,7:7,8:8,9:9}],5:[function(C,T,m){(function(A){(function(){m.test=function(){return A.setImmediate?!1:typeof A.MessageChannel<"u"},m.install=function(P){var D=new A.MessageChannel;return D.port1.onmessage=P,function(){D.port2.postMessage(0)}}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],6:[function(C,T,m){(function(A){(function(){var P=A.MutationObserver||A.WebKitMutationObserver;m.test=function(){return P},m.install=function(D){var K=0,R=new P(D),M=A.document.createTextNode("");return R.observe(M,{characterData:!0}),function(){M.data=K=++K%2}}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],7:[function(C,T,m){(function(A){(function(){m.test=function(){return typeof A.queueMicrotask=="function"},m.install=function(P){return function(){A.queueMicrotask(P)}}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],8:[function(C,T,m){(function(A){(function(){m.test=function(){return"document"in A&&"onreadystatechange"in A.document.createElement("script")},m.install=function(P){return function(){var D=A.document.createElement("script");return D.onreadystatechange=function(){P(),D.onreadystatechange=null,D.parentNode.removeChild(D),D=null},A.document.documentElement.appendChild(D),P}}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],9:[function(C,T,m){m.test=function(){return!0},m.install=function(A){return function(){setTimeout(A,0)}}},{}],10:[function(C,T,m){typeof Object.create=="function"?T.exports=function(P,D){D&&(P.super_=D,P.prototype=Object.create(D.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}))}:T.exports=function(P,D){if(D){P.super_=D;var K=function(){};K.prototype=D.prototype,P.prototype=new K,P.prototype.constructor=P}}},{}],11:[function(C,T,m){var A=T.exports={},P,D;function K(){throw new Error("setTimeout has not been defined")}function R(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?P=setTimeout:P=K}catch{P=K}try{typeof clearTimeout=="function"?D=clearTimeout:D=R}catch{D=R}})();function M(l){if(P===setTimeout)return setTimeout(l,0);if((P===K||!P)&&setTimeout)return P=setTimeout,setTimeout(l,0);try{return P(l,0)}catch{try{return P.call(null,l,0)}catch{return P.call(this,l,0)}}}function j(l){if(D===clearTimeout)return clearTimeout(l);if((D===R||!D)&&clearTimeout)return D=clearTimeout,clearTimeout(l);try{return D(l)}catch{try{return D.call(null,l)}catch{return D.call(this,l)}}}var ne=[],Z=!1,Y,u=-1;function le(){!Z||!Y||(Z=!1,Y.length?ne=Y.concat(ne):u=-1,ne.length&&be())}function be(){if(!Z){var l=M(le);Z=!0;for(var h=ne.length;h;){for(Y=ne,ne=[];++u<h;)Y&&Y[u].run();u=-1,h=ne.length}Y=null,Z=!1,j(l)}}A.nextTick=function(l){var h=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)h[o-1]=arguments[o];ne.push(new q(l,h)),ne.length===1&&!Z&&M(be)};function q(l,h){this.fun=l,this.array=h}q.prototype.run=function(){this.fun.apply(null,this.array)},A.title="browser",A.browser=!0,A.env={},A.argv=[],A.version="",A.versions={};function W(){}A.on=W,A.addListener=W,A.once=W,A.off=W,A.removeListener=W,A.removeAllListeners=W,A.emit=W,A.prependListener=W,A.prependOnceListener=W,A.listeners=function(l){return[]},A.binding=function(l){throw new Error("process.binding is not supported")},A.cwd=function(){return"/"},A.chdir=function(l){throw new Error("process.chdir is not supported")},A.umask=function(){return 0}},{}],12:[function(C,T,m){(function(A){if(typeof m=="object")T.exports=A();else{var P;try{P=window}catch{P=self}P.SparkMD5=A()}})(function(A){var P=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function D(l,h){var o=l[0],f=l[1],v=l[2],b=l[3];o+=(f&v|~f&b)+h[0]-680876936|0,o=(o<<7|o>>>25)+f|0,b+=(o&f|~o&v)+h[1]-389564586|0,b=(b<<12|b>>>20)+o|0,v+=(b&o|~b&f)+h[2]+606105819|0,v=(v<<17|v>>>15)+b|0,f+=(v&b|~v&o)+h[3]-1044525330|0,f=(f<<22|f>>>10)+v|0,o+=(f&v|~f&b)+h[4]-176418897|0,o=(o<<7|o>>>25)+f|0,b+=(o&f|~o&v)+h[5]+1200080426|0,b=(b<<12|b>>>20)+o|0,v+=(b&o|~b&f)+h[6]-1473231341|0,v=(v<<17|v>>>15)+b|0,f+=(v&b|~v&o)+h[7]-45705983|0,f=(f<<22|f>>>10)+v|0,o+=(f&v|~f&b)+h[8]+1770035416|0,o=(o<<7|o>>>25)+f|0,b+=(o&f|~o&v)+h[9]-1958414417|0,b=(b<<12|b>>>20)+o|0,v+=(b&o|~b&f)+h[10]-42063|0,v=(v<<17|v>>>15)+b|0,f+=(v&b|~v&o)+h[11]-1990404162|0,f=(f<<22|f>>>10)+v|0,o+=(f&v|~f&b)+h[12]+1804603682|0,o=(o<<7|o>>>25)+f|0,b+=(o&f|~o&v)+h[13]-40341101|0,b=(b<<12|b>>>20)+o|0,v+=(b&o|~b&f)+h[14]-1502002290|0,v=(v<<17|v>>>15)+b|0,f+=(v&b|~v&o)+h[15]+1236535329|0,f=(f<<22|f>>>10)+v|0,o+=(f&b|v&~b)+h[1]-165796510|0,o=(o<<5|o>>>27)+f|0,b+=(o&v|f&~v)+h[6]-1069501632|0,b=(b<<9|b>>>23)+o|0,v+=(b&f|o&~f)+h[11]+643717713|0,v=(v<<14|v>>>18)+b|0,f+=(v&o|b&~o)+h[0]-373897302|0,f=(f<<20|f>>>12)+v|0,o+=(f&b|v&~b)+h[5]-701558691|0,o=(o<<5|o>>>27)+f|0,b+=(o&v|f&~v)+h[10]+38016083|0,b=(b<<9|b>>>23)+o|0,v+=(b&f|o&~f)+h[15]-660478335|0,v=(v<<14|v>>>18)+b|0,f+=(v&o|b&~o)+h[4]-405537848|0,f=(f<<20|f>>>12)+v|0,o+=(f&b|v&~b)+h[9]+568446438|0,o=(o<<5|o>>>27)+f|0,b+=(o&v|f&~v)+h[14]-1019803690|0,b=(b<<9|b>>>23)+o|0,v+=(b&f|o&~f)+h[3]-187363961|0,v=(v<<14|v>>>18)+b|0,f+=(v&o|b&~o)+h[8]+1163531501|0,f=(f<<20|f>>>12)+v|0,o+=(f&b|v&~b)+h[13]-1444681467|0,o=(o<<5|o>>>27)+f|0,b+=(o&v|f&~v)+h[2]-51403784|0,b=(b<<9|b>>>23)+o|0,v+=(b&f|o&~f)+h[7]+1735328473|0,v=(v<<14|v>>>18)+b|0,f+=(v&o|b&~o)+h[12]-1926607734|0,f=(f<<20|f>>>12)+v|0,o+=(f^v^b)+h[5]-378558|0,o=(o<<4|o>>>28)+f|0,b+=(o^f^v)+h[8]-2022574463|0,b=(b<<11|b>>>21)+o|0,v+=(b^o^f)+h[11]+1839030562|0,v=(v<<16|v>>>16)+b|0,f+=(v^b^o)+h[14]-35309556|0,f=(f<<23|f>>>9)+v|0,o+=(f^v^b)+h[1]-1530992060|0,o=(o<<4|o>>>28)+f|0,b+=(o^f^v)+h[4]+1272893353|0,b=(b<<11|b>>>21)+o|0,v+=(b^o^f)+h[7]-155497632|0,v=(v<<16|v>>>16)+b|0,f+=(v^b^o)+h[10]-1094730640|0,f=(f<<23|f>>>9)+v|0,o+=(f^v^b)+h[13]+681279174|0,o=(o<<4|o>>>28)+f|0,b+=(o^f^v)+h[0]-358537222|0,b=(b<<11|b>>>21)+o|0,v+=(b^o^f)+h[3]-722521979|0,v=(v<<16|v>>>16)+b|0,f+=(v^b^o)+h[6]+76029189|0,f=(f<<23|f>>>9)+v|0,o+=(f^v^b)+h[9]-640364487|0,o=(o<<4|o>>>28)+f|0,b+=(o^f^v)+h[12]-421815835|0,b=(b<<11|b>>>21)+o|0,v+=(b^o^f)+h[15]+530742520|0,v=(v<<16|v>>>16)+b|0,f+=(v^b^o)+h[2]-995338651|0,f=(f<<23|f>>>9)+v|0,o+=(v^(f|~b))+h[0]-198630844|0,o=(o<<6|o>>>26)+f|0,b+=(f^(o|~v))+h[7]+1126891415|0,b=(b<<10|b>>>22)+o|0,v+=(o^(b|~f))+h[14]-1416354905|0,v=(v<<15|v>>>17)+b|0,f+=(b^(v|~o))+h[5]-57434055|0,f=(f<<21|f>>>11)+v|0,o+=(v^(f|~b))+h[12]+1700485571|0,o=(o<<6|o>>>26)+f|0,b+=(f^(o|~v))+h[3]-1894986606|0,b=(b<<10|b>>>22)+o|0,v+=(o^(b|~f))+h[10]-1051523|0,v=(v<<15|v>>>17)+b|0,f+=(b^(v|~o))+h[1]-2054922799|0,f=(f<<21|f>>>11)+v|0,o+=(v^(f|~b))+h[8]+1873313359|0,o=(o<<6|o>>>26)+f|0,b+=(f^(o|~v))+h[15]-30611744|0,b=(b<<10|b>>>22)+o|0,v+=(o^(b|~f))+h[6]-1560198380|0,v=(v<<15|v>>>17)+b|0,f+=(b^(v|~o))+h[13]+1309151649|0,f=(f<<21|f>>>11)+v|0,o+=(v^(f|~b))+h[4]-145523070|0,o=(o<<6|o>>>26)+f|0,b+=(f^(o|~v))+h[11]-1120210379|0,b=(b<<10|b>>>22)+o|0,v+=(o^(b|~f))+h[2]+718787259|0,v=(v<<15|v>>>17)+b|0,f+=(b^(v|~o))+h[9]-343485551|0,f=(f<<21|f>>>11)+v|0,l[0]=o+l[0]|0,l[1]=f+l[1]|0,l[2]=v+l[2]|0,l[3]=b+l[3]|0}function K(l){var h=[],o;for(o=0;o<64;o+=4)h[o>>2]=l.charCodeAt(o)+(l.charCodeAt(o+1)<<8)+(l.charCodeAt(o+2)<<16)+(l.charCodeAt(o+3)<<24);return h}function R(l){var h=[],o;for(o=0;o<64;o+=4)h[o>>2]=l[o]+(l[o+1]<<8)+(l[o+2]<<16)+(l[o+3]<<24);return h}function M(l){var h=l.length,o=[1732584193,-271733879,-1732584194,271733878],f,v,b,we,Se,Ie;for(f=64;f<=h;f+=64)D(o,K(l.substring(f-64,f)));for(l=l.substring(f-64),v=l.length,b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=0;f<v;f+=1)b[f>>2]|=l.charCodeAt(f)<<(f%4<<3);if(b[f>>2]|=128<<(f%4<<3),f>55)for(D(o,b),f=0;f<16;f+=1)b[f]=0;return we=h*8,we=we.toString(16).match(/(.*?)(.{0,8})$/),Se=parseInt(we[2],16),Ie=parseInt(we[1],16)||0,b[14]=Se,b[15]=Ie,D(o,b),o}function j(l){var h=l.length,o=[1732584193,-271733879,-1732584194,271733878],f,v,b,we,Se,Ie;for(f=64;f<=h;f+=64)D(o,R(l.subarray(f-64,f)));for(l=f-64<h?l.subarray(f-64):new Uint8Array(0),v=l.length,b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=0;f<v;f+=1)b[f>>2]|=l[f]<<(f%4<<3);if(b[f>>2]|=128<<(f%4<<3),f>55)for(D(o,b),f=0;f<16;f+=1)b[f]=0;return we=h*8,we=we.toString(16).match(/(.*?)(.{0,8})$/),Se=parseInt(we[2],16),Ie=parseInt(we[1],16)||0,b[14]=Se,b[15]=Ie,D(o,b),o}function ne(l){var h="",o;for(o=0;o<4;o+=1)h+=P[l>>o*8+4&15]+P[l>>o*8&15];return h}function Z(l){var h;for(h=0;h<l.length;h+=1)l[h]=ne(l[h]);return l.join("")}Z(M("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function l(h,o){return h=h|0||0,h<0?Math.max(h+o,0):Math.min(h,o)}ArrayBuffer.prototype.slice=function(h,o){var f=this.byteLength,v=l(h,f),b=f,we,Se,Ie,te;return o!==A&&(b=l(o,f)),v>b?new ArrayBuffer(0):(we=b-v,Se=new ArrayBuffer(we),Ie=new Uint8Array(Se),te=new Uint8Array(this,v,we),Ie.set(te),Se)}}();function Y(l){return/[\u0080-\uFFFF]/.test(l)&&(l=unescape(encodeURIComponent(l))),l}function u(l,h){var o=l.length,f=new ArrayBuffer(o),v=new Uint8Array(f),b;for(b=0;b<o;b+=1)v[b]=l.charCodeAt(b);return h?v:f}function le(l){return String.fromCharCode.apply(null,new Uint8Array(l))}function be(l,h,o){var f=new Uint8Array(l.byteLength+h.byteLength);return f.set(new Uint8Array(l)),f.set(new Uint8Array(h),l.byteLength),o?f:f.buffer}function q(l){var h=[],o=l.length,f;for(f=0;f<o-1;f+=2)h.push(parseInt(l.substr(f,2),16));return String.fromCharCode.apply(String,h)}function W(){this.reset()}return W.prototype.append=function(l){return this.appendBinary(Y(l)),this},W.prototype.appendBinary=function(l){this._buff+=l,this._length+=l.length;var h=this._buff.length,o;for(o=64;o<=h;o+=64)D(this._hash,K(this._buff.substring(o-64,o)));return this._buff=this._buff.substring(o-64),this},W.prototype.end=function(l){var h=this._buff,o=h.length,f,v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b;for(f=0;f<o;f+=1)v[f>>2]|=h.charCodeAt(f)<<(f%4<<3);return this._finish(v,o),b=Z(this._hash),l&&(b=q(b)),this.reset(),b},W.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},W.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},W.prototype.setState=function(l){return this._buff=l.buff,this._length=l.length,this._hash=l.hash,this},W.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},W.prototype._finish=function(l,h){var o=h,f,v,b;if(l[o>>2]|=128<<(o%4<<3),o>55)for(D(this._hash,l),o=0;o<16;o+=1)l[o]=0;f=this._length*8,f=f.toString(16).match(/(.*?)(.{0,8})$/),v=parseInt(f[2],16),b=parseInt(f[1],16)||0,l[14]=v,l[15]=b,D(this._hash,l)},W.hash=function(l,h){return W.hashBinary(Y(l),h)},W.hashBinary=function(l,h){var o=M(l),f=Z(o);return h?q(f):f},W.ArrayBuffer=function(){this.reset()},W.ArrayBuffer.prototype.append=function(l){var h=be(this._buff.buffer,l,!0),o=h.length,f;for(this._length+=l.byteLength,f=64;f<=o;f+=64)D(this._hash,R(h.subarray(f-64,f)));return this._buff=f-64<o?new Uint8Array(h.buffer.slice(f-64)):new Uint8Array(0),this},W.ArrayBuffer.prototype.end=function(l){var h=this._buff,o=h.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],v,b;for(v=0;v<o;v+=1)f[v>>2]|=h[v]<<(v%4<<3);return this._finish(f,o),b=Z(this._hash),l&&(b=q(b)),this.reset(),b},W.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},W.ArrayBuffer.prototype.getState=function(){var l=W.prototype.getState.call(this);return l.buff=le(l.buff),l},W.ArrayBuffer.prototype.setState=function(l){return l.buff=u(l.buff,!0),W.prototype.setState.call(this,l)},W.ArrayBuffer.prototype.destroy=W.prototype.destroy,W.ArrayBuffer.prototype._finish=W.prototype._finish,W.ArrayBuffer.hash=function(l,h){var o=j(new Uint8Array(l)),f=Z(o);return h?q(f):f},W})},{}],13:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),Object.defineProperty(m,"v1",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(m,"v3",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(m,"v4",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(m,"v5",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(m,"NIL",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(m,"version",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(m,"validate",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(m,"stringify",{enumerable:!0,get:function(){return ne.default}}),Object.defineProperty(m,"parse",{enumerable:!0,get:function(){return Z.default}});var A=Y(C(21)),P=Y(C(22)),D=Y(C(24)),K=Y(C(25)),R=Y(C(15)),M=Y(C(27)),j=Y(C(26)),ne=Y(C(20)),Z=Y(C(16));function Y(u){return u&&u.__esModule?u:{default:u}}},{15:15,16:16,20:20,21:21,22:22,24:24,25:25,26:26,27:27}],14:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;function A(q){if(typeof q=="string"){const W=unescape(encodeURIComponent(q));q=new Uint8Array(W.length);for(let l=0;l<W.length;++l)q[l]=W.charCodeAt(l)}return P(K(R(q),q.length*8))}function P(q){const W=[],l=q.length*32,h="0123456789abcdef";for(let o=0;o<l;o+=8){const f=q[o>>5]>>>o%32&255,v=parseInt(h.charAt(f>>>4&15)+h.charAt(f&15),16);W.push(v)}return W}function D(q){return(q+64>>>9<<4)+14+1}function K(q,W){q[W>>5]|=128<<W%32,q[D(W)-1]=W;let l=1732584193,h=-271733879,o=-1732584194,f=271733878;for(let v=0;v<q.length;v+=16){const b=l,we=h,Se=o,Ie=f;l=Z(l,h,o,f,q[v],7,-680876936),f=Z(f,l,h,o,q[v+1],12,-389564586),o=Z(o,f,l,h,q[v+2],17,606105819),h=Z(h,o,f,l,q[v+3],22,-1044525330),l=Z(l,h,o,f,q[v+4],7,-176418897),f=Z(f,l,h,o,q[v+5],12,1200080426),o=Z(o,f,l,h,q[v+6],17,-1473231341),h=Z(h,o,f,l,q[v+7],22,-45705983),l=Z(l,h,o,f,q[v+8],7,1770035416),f=Z(f,l,h,o,q[v+9],12,-1958414417),o=Z(o,f,l,h,q[v+10],17,-42063),h=Z(h,o,f,l,q[v+11],22,-1990404162),l=Z(l,h,o,f,q[v+12],7,1804603682),f=Z(f,l,h,o,q[v+13],12,-40341101),o=Z(o,f,l,h,q[v+14],17,-1502002290),h=Z(h,o,f,l,q[v+15],22,1236535329),l=Y(l,h,o,f,q[v+1],5,-165796510),f=Y(f,l,h,o,q[v+6],9,-1069501632),o=Y(o,f,l,h,q[v+11],14,643717713),h=Y(h,o,f,l,q[v],20,-373897302),l=Y(l,h,o,f,q[v+5],5,-701558691),f=Y(f,l,h,o,q[v+10],9,38016083),o=Y(o,f,l,h,q[v+15],14,-660478335),h=Y(h,o,f,l,q[v+4],20,-405537848),l=Y(l,h,o,f,q[v+9],5,568446438),f=Y(f,l,h,o,q[v+14],9,-1019803690),o=Y(o,f,l,h,q[v+3],14,-187363961),h=Y(h,o,f,l,q[v+8],20,1163531501),l=Y(l,h,o,f,q[v+13],5,-1444681467),f=Y(f,l,h,o,q[v+2],9,-51403784),o=Y(o,f,l,h,q[v+7],14,1735328473),h=Y(h,o,f,l,q[v+12],20,-1926607734),l=u(l,h,o,f,q[v+5],4,-378558),f=u(f,l,h,o,q[v+8],11,-2022574463),o=u(o,f,l,h,q[v+11],16,1839030562),h=u(h,o,f,l,q[v+14],23,-35309556),l=u(l,h,o,f,q[v+1],4,-1530992060),f=u(f,l,h,o,q[v+4],11,1272893353),o=u(o,f,l,h,q[v+7],16,-155497632),h=u(h,o,f,l,q[v+10],23,-1094730640),l=u(l,h,o,f,q[v+13],4,681279174),f=u(f,l,h,o,q[v],11,-358537222),o=u(o,f,l,h,q[v+3],16,-722521979),h=u(h,o,f,l,q[v+6],23,76029189),l=u(l,h,o,f,q[v+9],4,-640364487),f=u(f,l,h,o,q[v+12],11,-421815835),o=u(o,f,l,h,q[v+15],16,530742520),h=u(h,o,f,l,q[v+2],23,-995338651),l=le(l,h,o,f,q[v],6,-198630844),f=le(f,l,h,o,q[v+7],10,1126891415),o=le(o,f,l,h,q[v+14],15,-1416354905),h=le(h,o,f,l,q[v+5],21,-57434055),l=le(l,h,o,f,q[v+12],6,1700485571),f=le(f,l,h,o,q[v+3],10,-1894986606),o=le(o,f,l,h,q[v+10],15,-1051523),h=le(h,o,f,l,q[v+1],21,-2054922799),l=le(l,h,o,f,q[v+8],6,1873313359),f=le(f,l,h,o,q[v+15],10,-30611744),o=le(o,f,l,h,q[v+6],15,-1560198380),h=le(h,o,f,l,q[v+13],21,1309151649),l=le(l,h,o,f,q[v+4],6,-145523070),f=le(f,l,h,o,q[v+11],10,-1120210379),o=le(o,f,l,h,q[v+2],15,718787259),h=le(h,o,f,l,q[v+9],21,-343485551),l=M(l,b),h=M(h,we),o=M(o,Se),f=M(f,Ie)}return[l,h,o,f]}function R(q){if(q.length===0)return[];const W=q.length*8,l=new Uint32Array(D(W));for(let h=0;h<W;h+=8)l[h>>5]|=(q[h/8]&255)<<h%32;return l}function M(q,W){const l=(q&65535)+(W&65535);return(q>>16)+(W>>16)+(l>>16)<<16|l&65535}function j(q,W){return q<<W|q>>>32-W}function ne(q,W,l,h,o,f){return M(j(M(M(W,q),M(h,f)),o),l)}function Z(q,W,l,h,o,f,v){return ne(W&l|~W&h,q,W,o,f,v)}function Y(q,W,l,h,o,f,v){return ne(W&h|l&~h,q,W,o,f,v)}function u(q,W,l,h,o,f,v){return ne(W^l^h,q,W,o,f,v)}function le(q,W,l,h,o,f,v){return ne(l^(W|~h),q,W,o,f,v)}var be=A;m.default=be},{}],15:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A="00000000-0000-0000-0000-000000000000";m.default=A},{}],16:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=P(C(26));function P(R){return R&&R.__esModule?R:{default:R}}function D(R){if(!(0,A.default)(R))throw TypeError("Invalid UUID");let M;const j=new Uint8Array(16);return j[0]=(M=parseInt(R.slice(0,8),16))>>>24,j[1]=M>>>16&255,j[2]=M>>>8&255,j[3]=M&255,j[4]=(M=parseInt(R.slice(9,13),16))>>>8,j[5]=M&255,j[6]=(M=parseInt(R.slice(14,18),16))>>>8,j[7]=M&255,j[8]=(M=parseInt(R.slice(19,23),16))>>>8,j[9]=M&255,j[10]=(M=parseInt(R.slice(24,36),16))/1099511627776&255,j[11]=M/4294967296&255,j[12]=M>>>24&255,j[13]=M>>>16&255,j[14]=M>>>8&255,j[15]=M&255,j}var K=D;m.default=K},{26:26}],17:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;m.default=A},{}],18:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=D;let A;const P=new Uint8Array(16);function D(){if(!A&&(A=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!A))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A(P)}},{}],19:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;function A(R,M,j,ne){switch(R){case 0:return M&j^~M&ne;case 1:return M^j^ne;case 2:return M&j^M&ne^j&ne;case 3:return M^j^ne}}function P(R,M){return R<<M|R>>>32-M}function D(R){const M=[1518500249,1859775393,2400959708,3395469782],j=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof R=="string"){const u=unescape(encodeURIComponent(R));R=[];for(let le=0;le<u.length;++le)R.push(u.charCodeAt(le))}else Array.isArray(R)||(R=Array.prototype.slice.call(R));R.push(128);const ne=R.length/4+2,Z=Math.ceil(ne/16),Y=new Array(Z);for(let u=0;u<Z;++u){const le=new Uint32Array(16);for(let be=0;be<16;++be)le[be]=R[u*64+be*4]<<24|R[u*64+be*4+1]<<16|R[u*64+be*4+2]<<8|R[u*64+be*4+3];Y[u]=le}Y[Z-1][14]=(R.length-1)*8/Math.pow(2,32),Y[Z-1][14]=Math.floor(Y[Z-1][14]),Y[Z-1][15]=(R.length-1)*8&4294967295;for(let u=0;u<Z;++u){const le=new Uint32Array(80);for(let o=0;o<16;++o)le[o]=Y[u][o];for(let o=16;o<80;++o)le[o]=P(le[o-3]^le[o-8]^le[o-14]^le[o-16],1);let be=j[0],q=j[1],W=j[2],l=j[3],h=j[4];for(let o=0;o<80;++o){const f=Math.floor(o/20),v=P(be,5)+A(f,q,W,l)+h+M[f]+le[o]>>>0;h=l,l=W,W=P(q,30)>>>0,q=be,be=v}j[0]=j[0]+be>>>0,j[1]=j[1]+q>>>0,j[2]=j[2]+W>>>0,j[3]=j[3]+l>>>0,j[4]=j[4]+h>>>0}return[j[0]>>24&255,j[0]>>16&255,j[0]>>8&255,j[0]&255,j[1]>>24&255,j[1]>>16&255,j[1]>>8&255,j[1]&255,j[2]>>24&255,j[2]>>16&255,j[2]>>8&255,j[2]&255,j[3]>>24&255,j[3]>>16&255,j[3]>>8&255,j[3]&255,j[4]>>24&255,j[4]>>16&255,j[4]>>8&255,j[4]&255]}var K=D;m.default=K},{}],20:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=P(C(26));function P(M){return M&&M.__esModule?M:{default:M}}const D=[];for(let M=0;M<256;++M)D.push((M+256).toString(16).substr(1));function K(M,j=0){const ne=(D[M[j+0]]+D[M[j+1]]+D[M[j+2]]+D[M[j+3]]+"-"+D[M[j+4]]+D[M[j+5]]+"-"+D[M[j+6]]+D[M[j+7]]+"-"+D[M[j+8]]+D[M[j+9]]+"-"+D[M[j+10]]+D[M[j+11]]+D[M[j+12]]+D[M[j+13]]+D[M[j+14]]+D[M[j+15]]).toLowerCase();if(!(0,A.default)(ne))throw TypeError("Stringified UUID is invalid");return ne}var R=K;m.default=R},{26:26}],21:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=D(C(18)),P=D(C(20));function D(Y){return Y&&Y.__esModule?Y:{default:Y}}let K,R,M=0,j=0;function ne(Y,u,le){let be=u&&le||0;const q=u||new Array(16);Y=Y||{};let W=Y.node||K,l=Y.clockseq!==void 0?Y.clockseq:R;if(W==null||l==null){const we=Y.random||(Y.rng||A.default)();W==null&&(W=K=[we[0]|1,we[1],we[2],we[3],we[4],we[5]]),l==null&&(l=R=(we[6]<<8|we[7])&16383)}let h=Y.msecs!==void 0?Y.msecs:Date.now(),o=Y.nsecs!==void 0?Y.nsecs:j+1;const f=h-M+(o-j)/1e4;if(f<0&&Y.clockseq===void 0&&(l=l+1&16383),(f<0||h>M)&&Y.nsecs===void 0&&(o=0),o>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");M=h,j=o,R=l,h+=122192928e5;const v=((h&268435455)*1e4+o)%4294967296;q[be++]=v>>>24&255,q[be++]=v>>>16&255,q[be++]=v>>>8&255,q[be++]=v&255;const b=h/4294967296*1e4&268435455;q[be++]=b>>>8&255,q[be++]=b&255,q[be++]=b>>>24&15|16,q[be++]=b>>>16&255,q[be++]=l>>>8|128,q[be++]=l&255;for(let we=0;we<6;++we)q[be+we]=W[we];return u||(0,P.default)(q)}var Z=ne;m.default=Z},{18:18,20:20}],22:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=D(C(23)),P=D(C(14));function D(M){return M&&M.__esModule?M:{default:M}}var R=(0,A.default)("v3",48,P.default);m.default=R},{14:14,23:23}],23:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=j,m.URL=m.DNS=void 0;var A=D(C(20)),P=D(C(16));function D(ne){return ne&&ne.__esModule?ne:{default:ne}}function K(ne){ne=unescape(encodeURIComponent(ne));const Z=[];for(let Y=0;Y<ne.length;++Y)Z.push(ne.charCodeAt(Y));return Z}const R="6ba7b810-9dad-11d1-80b4-00c04fd430c8";m.DNS=R;const M="6ba7b811-9dad-11d1-80b4-00c04fd430c8";m.URL=M;function j(ne,Z,Y){function u(le,be,q,W){if(typeof le=="string"&&(le=K(le)),typeof be=="string"&&(be=(0,P.default)(be)),be.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+le.length);if(l.set(be),l.set(le,be.length),l=Y(l),l[6]=l[6]&15|Z,l[8]=l[8]&63|128,q){W=W||0;for(let h=0;h<16;++h)q[W+h]=l[h];return q}return(0,A.default)(l)}try{u.name=ne}catch{}return u.DNS=R,u.URL=M,u}},{16:16,20:20}],24:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=D(C(18)),P=D(C(20));function D(M){return M&&M.__esModule?M:{default:M}}function K(M,j,ne){M=M||{};const Z=M.random||(M.rng||A.default)();if(Z[6]=Z[6]&15|64,Z[8]=Z[8]&63|128,j){ne=ne||0;for(let Y=0;Y<16;++Y)j[ne+Y]=Z[Y];return j}return(0,P.default)(Z)}var R=K;m.default=R},{18:18,20:20}],25:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=D(C(23)),P=D(C(19));function D(M){return M&&M.__esModule?M:{default:M}}var R=(0,A.default)("v5",80,P.default);m.default=R},{19:19,23:23}],26:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=P(C(17));function P(R){return R&&R.__esModule?R:{default:R}}function D(R){return typeof R=="string"&&A.default.test(R)}var K=D;m.default=K},{17:17}],27:[function(C,T,m){Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var A=P(C(26));function P(R){return R&&R.__esModule?R:{default:R}}function D(R){if(!(0,A.default)(R))throw TypeError("Invalid UUID");return parseInt(R.substr(14,1),16)}var K=D;m.default=K},{26:26}],28:[function(C,T,m){m.stringify=function(D){var K=[];K.push({obj:D});for(var R="",M,j,ne,Z,Y,u,le,be,q,W,l;M=K.pop();)if(j=M.obj,ne=M.prefix||"",Z=M.val||"",R+=ne,Z)R+=Z;else if(typeof j!="object")R+=typeof j>"u"?null:JSON.stringify(j);else if(j===null)R+="null";else if(Array.isArray(j)){for(K.push({val:"]"}),Y=j.length-1;Y>=0;Y--)u=Y===0?"":",",K.push({obj:j[Y],prefix:u});K.push({val:"["})}else{le=[];for(be in j)j.hasOwnProperty(be)&&le.push(be);for(K.push({val:"}"}),Y=le.length-1;Y>=0;Y--)q=le[Y],W=j[q],l=Y>0?",":"",l+=JSON.stringify(q)+":",K.push({obj:W,prefix:l});K.push({val:"{"})}return R};function A(P,D,K){var R=K[K.length-1];P===R.element&&(K.pop(),R=K[K.length-1]);var M=R.element,j=R.index;if(Array.isArray(M))M.push(P);else if(j===D.length-2){var ne=D.pop();M[ne]=P}else D.push(P)}m.parse=function(P){for(var D=[],K=[],R=0,M,j,ne,Z,Y,u,le,be,q;;){if(M=P[R++],M==="}"||M==="]"||typeof M>"u"){if(D.length===1)return D.pop();A(D.pop(),D,K);continue}switch(M){case" ":case"	":case`
`:case":":case",":break;case"n":R+=3,A(null,D,K);break;case"t":R+=3,A(!0,D,K);break;case"f":R+=4,A(!1,D,K);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(j="",R--;;)if(ne=P[R++],/[\d\.\-e\+]/.test(ne))j+=ne;else{R--;break}A(parseFloat(j),D,K);break;case'"':for(Z="",Y=void 0,u=0;le=P[R++],le!=='"'||Y==="\\"&&u%2===1;)Z+=le,Y=le,Y==="\\"?u++:u=0;A(JSON.parse('"'+Z+'"'),D,K);break;case"[":be={element:[],index:D.length},D.push(be.element),K.push(be);break;case"{":q={element:{},index:D.length},D.push(q.element),K.push(q);break;default:throw new Error("unexpectedly reached end of input: "+M)}}}},{}],29:[function(C,T,m){(function(A){(function(){function P(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var D=P(C(4)),K=C(13),R=P(C(12)),M=P(C(28)),j=P(C(1)),ne=P(C(10)),Z=P(C(3));function Y(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer||typeof Blob<"u"&&e instanceof Blob}function u(e){if(typeof e.slice=="function")return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}function le(e){if(e instanceof ArrayBuffer)return u(e);var t=e.size,n=e.type;return typeof e.slice=="function"?e.slice(0,t,n):e.webkitSlice(0,t,n)}var be=Function.prototype.toString,q=be.call(Object);function W(e){var t=Object.getPrototypeOf(e);if(t===null)return!0;var n=t.constructor;return typeof n=="function"&&n instanceof n&&be.call(n)==q}function l(e){var t,n,r;if(!e||typeof e!="object")return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=l(e[n]);return t}if(e instanceof Date&&isFinite(e))return e.toISOString();if(Y(e))return le(e);if(!W(e))return e;t={};for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=l(e[n]);typeof i<"u"&&(t[n]=i)}return t}function h(e){var t=!1;return j(function(n){if(t)throw new Error("once called more than once");t=!0,e.apply(this,n)})}function o(e){return j(function(t){t=l(t);var n=this,r=typeof t[t.length-1]=="function"?t.pop():!1,i=new Promise(function(s,d){var p;try{var w=h(function(F,J){F?d(F):s(J)});t.push(w),p=e.apply(n,t),p&&typeof p.then=="function"&&s(p)}catch(F){d(F)}});return r&&i.then(function(s){r(null,s)},r),i})}function f(e,t,n){if(e.constructor.listeners("debug").length){for(var r=["api",e.name,t],i=0;i<n.length-1;i++)r.push(n[i]);e.constructor.emit("debug",r);var s=n[n.length-1];n[n.length-1]=function(d,p){var w=["api",e.name,t];w=w.concat(d?["error",d]:["success",p]),e.constructor.emit("debug",w),s(d,p)}}}function v(e,t){return o(j(function(n){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var r=this;return f(r,e,n),this.taskqueue.isReady?t.apply(this,n):new Promise(function(i,s){r.taskqueue.addTask(function(d){d?s(d):i(r[e].apply(r,n))})})}))}function b(e,t){for(var n={},r=0,i=t.length;r<i;r++){var s=t[r];s in e&&(n[s]=e[s])}return n}var we=6;function Se(e){return e}function Ie(e){return[{ok:e}]}function te(e,t,n){var r=t.docs,i=new Map;r.forEach(function(L){i.has(L.id)?i.get(L.id).push(L):i.set(L.id,[L])});var s=i.size,d=0,p=new Array(s);function w(){var L=[];p.forEach(function(z){z.docs.forEach(function(G){L.push({id:z.id,docs:[G]})})}),n(null,{results:L})}function F(){++d===s&&w()}function J(L,z,G){p[L]={id:z,docs:G},F()}var g=[];i.forEach(function(L,z){g.push(z)});var k=0;function N(){if(!(k>=g.length)){var L=Math.min(k+we,g.length),z=g.slice(k,L);y(z,k),k+=z.length}}function y(L,z){L.forEach(function(G,Q){var H=z+Q,ee=i.get(G),re=b(ee[0],["atts_since","attachments"]);re.open_revs=ee.map(function(oe){return oe.rev}),re.open_revs=re.open_revs.filter(Se);var he=Se;re.open_revs.length===0&&(delete re.open_revs,he=Ie),["revs","attachments","binary","ajax","latest"].forEach(function(oe){oe in t&&(re[oe]=t[oe])}),e.get(G,re,function(oe,ye){var Ce;oe?Ce=[{error:oe}]:Ce=he(ye),J(H,G,Ce),N()})})}N()}var ie;try{localStorage.setItem("_pouch_check_localstorage",1),ie=!!localStorage.getItem("_pouch_check_localstorage")}catch{ie=!1}function ae(){return ie}ne(me,Z);function de(e){ae()&&addEventListener("storage",function(t){e.emit(t.key)})}function me(){Z.call(this),this._listeners={},de(this)}me.prototype.addListener=function(e,t,n,r){if(this._listeners[t])return;var i=this,s=!1;function d(){if(!i._listeners[t])return;if(s){s="waiting";return}s=!0;var p=b(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);function w(){s=!1}n.changes(p).on("change",function(F){F.seq>r.since&&!r.cancelled&&(r.since=F.seq,r.onChange(F))}).on("complete",function(){s==="waiting"&&D(d),s=!1}).on("error",w)}this._listeners[t]=d,this.on(e,d)},me.prototype.removeListener=function(e,t){t in this._listeners&&(Z.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},me.prototype.notifyLocalWindows=function(e){ae()&&(localStorage[e]=localStorage[e]==="a"?"b":"a")},me.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};function Oe(e){if(typeof console<"u"&&typeof console[e]=="function")var t=Array.prototype.slice.call(arguments,1)}function Te(e,t){var n=6e5;e=parseInt(e,10)||0,t=parseInt(t,10),t!==t||t<=e?t=(e||1)<<1:t=t+1,t>n&&(e=n>>1,t=n);var r=Math.random(),i=t-e;return~~(i*r+e)}function He(e){var t=0;return e||(t=2e3),Te(e,t)}function ft(e,t){Oe("info","The above "+e+" is totally normal. "+t)}ne(Ue,Error);function Ue(e,t,n){Error.call(this,n),this.status=e,this.name=t,this.message=n,this.error=!0}Ue.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})},new Ue(401,"unauthorized","Name or password is incorrect.");var vt=new Ue(400,"bad_request","Missing JSON list of 'docs'"),dt=new Ue(404,"not_found","missing"),St=new Ue(409,"conflict","Document update conflict"),en=new Ue(400,"bad_request","_id field must contain a string"),tn=new Ue(412,"missing_id","_id is required for puts"),pn=new Ue(400,"bad_request","Only reserved document ids may start with underscore.");new Ue(412,"precondition_failed","Database not open");var Nt=new Ue(500,"unknown_error","Database encountered an unknown error"),nn=new Ue(500,"badarg","Some query argument is invalid");new Ue(400,"invalid_request","Request was invalid");var yn=new Ue(400,"query_parse_error","Some query parameter is invalid"),rn=new Ue(500,"doc_validation","Bad special document member"),Et=new Ue(400,"bad_request","Something wrong with the request"),a=new Ue(400,"bad_request","Document must be a JSON object");new Ue(404,"not_found","Database not found");var c=new Ue(500,"indexed_db_went_bad","unknown");new Ue(500,"web_sql_went_bad","unknown"),new Ue(500,"levelDB_went_went_bad","unknown"),new Ue(403,"forbidden","Forbidden by design doc validate_doc_update function");var S=new Ue(400,"bad_request","Invalid rev format");new Ue(412,"file_exists","The database could not be created, the file already exists.");var O=new Ue(412,"missing_stub","A pre-existing attachment stub wasn't found");new Ue(413,"invalid_url","Provided URL is invalid");function E(e,t){function n(r){for(var i=Object.getOwnPropertyNames(e),s=0,d=i.length;s<d;s++)typeof e[i[s]]!="function"&&(this[i[s]]=e[i[s]]);r!==void 0&&(this.reason=r)}return n.prototype=Ue.prototype,new n(t)}function x(e){if(typeof e!="object"){var t=e;e=Nt,e.data=t}return"error"in e&&e.error==="conflict"&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function V(e,t,n){try{return!e(t,n)}catch(i){var r="Filter function threw: "+i.toString();return E(Et,r)}}function ue(e){var t={},n=e.filter&&typeof e.filter=="function";return t.query=e.query_params,function(i){i.doc||(i.doc={});var s=n&&V(e.filter,i.doc,t);if(typeof s=="object")return s;if(s)return!1;if(!e.include_docs)delete i.doc;else if(!e.attachments)for(var d in i.doc._attachments)i.doc._attachments.hasOwnProperty(d)&&(i.doc._attachments[d].stub=!0);return!0}}function Ae(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t}function Me(e){var t;if(e?typeof e!="string"?t=E(en):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=E(pn)):t=E(tn),t)throw t}function Ge(e){return typeof e._remote=="boolean"?e._remote:typeof e.type=="function"?(Oe("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),e.type()==="http"):!1}function gt(e,t){return"listenerCount"in e?e.listenerCount(t):Z.listenerCount(e,t)}function Mt(e){if(!e)return null;var t=e.split("/");return t.length===2?t:t.length===1?[e,e]:null}function Kt(e){var t=Mt(e);return t?t.join("/"):null}var rr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ir="queryKey",ri=/(?:^|&)([^&=]*)=?([^&]*)/g,ii=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function ar(e){for(var t=ii.exec(e),n={},r=14;r--;){var i=rr[r],s=t[r]||"",d=["user","password"].indexOf(i)!==-1;n[i]=d?decodeURIComponent(s):s}return n[ir]={},n[rr[12]].replace(ri,function(p,w,F){w&&(n[ir][w]=F)}),n}function _n(e,t){var n=[],r=[];for(var i in t)t.hasOwnProperty(i)&&(n.push(i),r.push(t[i]));return n.push(e),Function.apply(null,n).apply(null,r)}function an(e,t,n){return e.get(t).catch(function(r){if(r.status!==404)throw r;return{}}).then(function(r){var i=r._rev,s=n(r);return s?(s._id=t,s._rev=i,ai(e,s,n)):{updated:!1,rev:i}})}function ai(e,t,n){return e.put(t).then(function(r){return{updated:!0,rev:r.rev}},function(r){if(r.status!==409)throw r;return an(e,t._id,n)})}var wn=function(e){return atob(e)},Gt=function(e){return btoa(e)};function bn(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(s){if(s.name!=="TypeError")throw s;for(var n=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,r=new n,i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(t.type)}}function oi(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function An(e,t){return bn([oi(e)],{type:t})}function Sn(e,t){return An(wn(e),t)}function ui(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=0;i<r;i++)t+=String.fromCharCode(n[i]);return t}function or(e,t){var n=new FileReader,r=typeof n.readAsBinaryString=="function";n.onloadend=function(i){var s=i.target.result||"";if(r)return t(s);t(ui(s))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function ur(e,t){or(e,function(n){t(n)})}function On(e,t){ur(e,function(n){t(Gt(n))})}function si(e,t){var n=new FileReader;n.onloadend=function(r){var i=r.target.result||new ArrayBuffer(0);t(i)},n.readAsArrayBuffer(e)}var fi=self.setImmediate||self.setTimeout,ci=32768;function li(e){return Gt(e)}function di(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.slice(t,n)}function hi(e,t,n,r,i){(n>0||r<t.size)&&(t=di(t,n,r)),si(t,function(s){e.append(s),i()})}function vi(e,t,n,r,i){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t),i()}function Tn(e,t){var n=typeof e=="string",r=n?e.length:e.size,i=Math.min(ci,r),s=Math.ceil(r/i),d=0,p=n?new R:new R.ArrayBuffer,w=n?vi:hi;function F(){fi(g)}function J(){var k=p.end(!0),N=li(k);t(N),p.destroy()}function g(){var k=d*i,N=k+i;d++,d<s?w(p,e,k,N,F):w(p,e,k,N,J)}g()}function En(e){return R.hash(e)}function sr(e,t){if(!t)return K.v4().replace(/-/g,"").toLowerCase();var n=Object.assign({},e);return delete n._rev_tree,En(JSON.stringify(n))}var on=K.v4;function Ct(e){for(var t,n,r,i=e.rev_tree.slice(),s;s=i.pop();){var d=s.ids,p=d[2],w=s.pos;if(p.length){for(var F=0,J=p.length;F<J;F++)i.push({pos:w+1,ids:p[F]});continue}var g=!!d[1].deleted,k=d[0];(!t||(r!==g?r:n!==w?n<w:t<k))&&(t=k,n=w,r=g)}return n+"-"+t}function Dt(e,t){for(var n=e.slice(),r;r=n.pop();)for(var i=r.pos,s=r.ids,d=s[2],p=t(d.length===0,i,s[0],r.ctx,s[1]),w=0,F=d.length;w<F;w++)n.push({pos:i+1,ids:d[w],ctx:p})}function gi(e,t){return e.pos-t.pos}function Cn(e){var t=[];Dt(e,function(i,s,d,p,w){i&&t.push({rev:s+"-"+d,pos:s,opts:w})}),t.sort(gi).reverse();for(var n=0,r=t.length;n<r;n++)delete t[n].pos;return t}function Dn(e){for(var t=Ct(e),n=Cn(e.rev_tree),r=[],i=0,s=n.length;i<s;i++){var d=n[i];d.rev!==t&&!d.opts.deleted&&r.push(d.rev)}return r}function mi(e){var t=[];return Dt(e.rev_tree,function(n,r,i,s,d){d.status==="available"&&!n&&(t.push(r+"-"+i),d.status="missing")}),t}function fr(e){for(var t=[],n=e.slice(),r;r=n.pop();){var i=r.pos,s=r.ids,d=s[0],p=s[1],w=s[2],F=w.length===0,J=r.history?r.history.slice():[];J.push({id:d,opts:p}),F&&t.push({pos:i+1-J.length,ids:J});for(var g=0,k=w.length;g<k;g++)n.push({pos:i+1,ids:w[g],history:J})}return t.reverse()}function pi(e,t){return e.pos-t.pos}function yi(e,t,n){for(var r=0,i=e.length,s;r<i;)s=r+i>>>1,n(e[s],t)<0?r=s+1:i=s;return r}function _i(e,t,n){var r=yi(e,t,n);e.splice(r,0,t)}function cr(e,t){for(var n,r,i=t,s=e.length;i<s;i++){var d=e[i],p=[d.id,d.opts,[]];r?(r[2].push(p),r=p):n=r=p}return n}function wi(e,t){return e[0]<t[0]?-1:1}function lr(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var i=n.pop(),s=i.tree1,d=i.tree2;(s[1].status||d[1].status)&&(s[1].status=s[1].status==="available"||d[1].status==="available"?"available":"missing");for(var p=0;p<d[2].length;p++){if(!s[2][0]){r="new_leaf",s[2][0]=d[2][p];continue}for(var w=!1,F=0;F<s[2].length;F++)s[2][F][0]===d[2][p][0]&&(n.push({tree1:s[2][F],tree2:d[2][p]}),w=!0);w||(r="new_branch",_i(s[2],d[2][p],wi))}}return{conflicts:r,tree:e}}function dr(e,t,n){var r=[],i=!1,s=!1,d;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var p=0,w=e.length;p<w;p++){var F=e[p];if(F.pos===t.pos&&F.ids[0]===t.ids[0])d=lr(F.ids,t.ids),r.push({pos:F.pos,ids:d.tree}),i=i||d.conflicts,s=!0;else if(n!==!0){var J=F.pos<t.pos?F:t,g=F.pos<t.pos?t:F,k=g.pos-J.pos,N=[],y=[];for(y.push({ids:J.ids,diff:k,parent:null,parentIdx:null});y.length>0;){var L=y.pop();if(L.diff===0){L.ids[0]===g.ids[0]&&N.push(L);continue}for(var z=L.ids[2],G=0,Q=z.length;G<Q;G++)y.push({ids:z[G],diff:L.diff-1,parent:L.ids,parentIdx:G})}var H=N[0];H?(d=lr(H.ids,g.ids),H.parent[2][H.parentIdx]=d.tree,r.push({pos:J.pos,ids:J.ids}),i=i||d.conflicts,s=!0):r.push(F)}else r.push(F)}return s||r.push(t),r.sort(pi),{tree:r,conflicts:i||"internal_node"}}function bi(e,t){for(var n=fr(e),r,i,s=0,d=n.length;s<d;s++){var p=n[s],w=p.ids,F;if(w.length>t){r||(r={});var J=w.length-t;F={pos:p.pos+J,ids:cr(w,J)};for(var g=0;g<J;g++){var k=p.pos+g+"-"+w[g].id;r[k]=!0}}else F={pos:p.pos,ids:cr(w,0)};i?i=dr(i,F,!0).tree:i=[F]}return r&&Dt(i,function(N,y,L){delete r[y+"-"+L]}),{tree:i,revs:r?Object.keys(r):[]}}function hr(e,t,n){var r=dr(e,t),i=bi(r.tree,n);return{tree:i.tree,stemmedRevs:i.revs,conflicts:r.conflicts}}function Ai(e,t){for(var n=e.slice(),r=t.split("-"),i=parseInt(r[0],10),s=r[1],d;d=n.pop();){if(d.pos===i&&d.ids[0]===s)return!0;for(var p=d.ids[2],w=0,F=p.length;w<F;w++)n.push({pos:d.pos+1,ids:p[w]})}return!1}function Si(e){return e.ids}function Ot(e,t){t||(t=Ct(e));for(var n=t.substring(t.indexOf("-")+1),r=e.rev_tree.map(Si),i;i=r.pop();){if(i[0]===n)return!!i[1].deleted;r=r.concat(i[2])}}function Pt(e){return/^_local/.test(e)}function Oi(e,t){for(var n=t.rev_tree.slice(),r;r=n.pop();){var i=r.pos,s=r.ids,d=s[0],p=s[1],w=s[2],F=w.length===0,J=r.history?r.history.slice():[];if(J.push({id:d,pos:i,opts:p}),F)for(var g=0,k=J.length;g<k;g++){var N=J[g],y=N.pos+"-"+N.id;if(y===e)return i+"-"+d}for(var L=0,z=w.length;L<z;L++)n.push({pos:i+1,ids:w[L],history:J})}throw new Error("Unable to resolve latest revision for id "+t.id+", rev "+e)}ne(Jt,Z);function Ti(e,t,n,r){try{e.emit("change",t,n,r)}catch(i){Oe("error",'Error in .on("change", function):',i)}}function Jt(e,t,n){Z.call(this);var r=this;this.db=e,t=t?l(t):{};var i=t.complete=h(function(p,w){p?gt(r,"error")>0&&r.emit("error",p):r.emit("complete",w),r.removeAllListeners(),e.removeListener("destroyed",s)});n&&(r.on("complete",function(p){n(null,p)}),r.on("error",n));function s(){r.cancel()}e.once("destroyed",s),t.onChange=function(p,w,F){r.isCancelled||Ti(r,p,w,F)};var d=new Promise(function(p,w){t.complete=function(F,J){F?w(F):p(J)}});r.once("cancel",function(){e.removeListener("destroyed",s),t.complete(null,{status:"cancelled"})}),this.then=d.then.bind(d),this.catch=d.catch.bind(d),this.then(function(p){i(null,p)},i),e.taskqueue.isReady?r.validateChanges(t):e.taskqueue.addTask(function(p){p?t.complete(p):r.isCancelled?r.emit("cancel"):r.validateChanges(t)})}Jt.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")};function Ei(e,t,n){var r=[{rev:e._rev}];n.style==="all_docs"&&(r=Cn(t.rev_tree).map(function(s){return{rev:s.rev}}));var i={id:t.id,changes:r,doc:e};return Ot(t,e._rev)&&(i.deleted=!0),n.conflicts&&(i.doc._conflicts=Dn(t),i.doc._conflicts.length||delete i.doc._conflicts),i}Jt.prototype.validateChanges=function(e){var t=e.complete,n=this;ke._changesFilterPlugin?ke._changesFilterPlugin.validate(e,function(r){if(r)return t(r);n.doChanges(e)}):n.doChanges(e)},Jt.prototype.doChanges=function(e){var t=this,n=e.complete;if(e=l(e),"live"in e&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=Ei,e.since==="latest"&&(e.since="now"),e.since||(e.since=0),e.since==="now"){this.db.info().then(function(s){if(t.isCancelled){n(null,{status:"cancelled"});return}e.since=s.update_seq,t.doChanges(e)},n);return}if(ke._changesFilterPlugin){if(ke._changesFilterPlugin.normalize(e),ke._changesFilterPlugin.shouldFilter(this,e))return ke._changesFilterPlugin.filter(this,e)}else["doc_ids","filter","selector","view"].forEach(function(s){s in e&&Oe("warn",'The "'+s+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in e||(e.descending=!1),e.limit=e.limit===0?1:e.limit,e.complete=n;var r=this.db._changes(e);if(r&&typeof r.cancel=="function"){var i=t.cancel;t.cancel=j(function(s){r.cancel(),i.apply(this,s)})}};function vr(e,t){return e<t?-1:e>t?1:0}function Pn(e,t){return function(n,r){n||r[0]&&r[0].error?(n=n||r[0],n.docId=t,e(n)):e(null,r.length?r[0]:r)}}function Ci(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),i=0;i<r.length;i++){var s=r[i];n._attachments[s]=b(n._attachments[s],["data","digest","content_type","length","revpos","stub"])}}}function Di(e,t){var n=vr(e._id,t._id);if(n!==0)return n;var r=e._revisions?e._revisions.start:0,i=t._revisions?t._revisions.start:0;return vr(r,i)}function Pi(e){var t={},n=[];return Dt(e,function(r,i,s,d){var p=i+"-"+s;return r&&(t[p]=0),d!==void 0&&n.push({from:d,to:p}),p}),n.reverse(),n.forEach(function(r){t[r.from]===void 0?t[r.from]=1+t[r.to]:t[r.from]=Math.min(t[r.from],1+t[r.to])}),t}function qi(e){var t="limit"in e?e.keys.slice(e.skip,e.limit+e.skip):e.skip>0?e.keys.slice(e.skip):e.keys;e.keys=t,e.skip=0,delete e.limit,e.descending&&(t.reverse(),e.descending=!1)}function gr(e){var t=e._compactionQueue[0],n=t.opts,r=t.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(i){i&&i.last_seq&&(n.last_seq=i.last_seq),e._compact(n,function(s,d){s?r(s):r(null,d),D(function(){e._compactionQueue.shift(),e._compactionQueue.length&&gr(e)})})})}function Li(e){return e.charAt(0)==="_"?e+" is not a valid attachment name, attachment names cannot start with '_'":!1}ne(Je,Z);function Je(){Z.call(this);for(var e in Je.prototype)typeof this[e]=="function"&&(this[e]=this[e].bind(this))}Je.prototype.post=v("post",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),typeof e!="object"||Array.isArray(e))return n(E(a));this.bulkDocs({docs:[e]},t,Pn(n,e._id))}),Je.prototype.put=v("put",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),typeof e!="object"||Array.isArray(e))return n(E(a));if(Me(e._id),Pt(e._id)&&typeof this._putLocal=="function")return e._deleted?this._removeLocal(e,n):this._putLocal(e,n);var r=this;t.force&&e._rev?(i(),s(function(d){var p=d?null:{ok:!0,id:e._id,rev:e._rev};n(d,p)})):s(n);function i(){var d=e._rev.split("-"),p=d[1],w=parseInt(d[0],10),F=w+1,J=sr();e._revisions={start:F,ids:[J,p]},e._rev=F+"-"+J,t.new_edits=!1}function s(d){typeof r._put=="function"&&t.new_edits!==!1?r._put(e,t,d):r.bulkDocs({docs:[e]},t,Pn(d,e._id))}}),Je.prototype.putAttachment=v("putAttachment",function(e,t,n,r,i){var s=this;typeof i=="function"&&(i=r,r=n,n=null),typeof i>"u"&&(i=r,r=n,n=null),i||Oe("warn","Attachment",t,"on document",e,"is missing content_type");function d(p){var w="_rev"in p?parseInt(p._rev,10):0;return p._attachments=p._attachments||{},p._attachments[t]={content_type:i,data:r,revpos:++w},s.put(p)}return s.get(e).then(function(p){if(p._rev!==n)throw E(St);return d(p)},function(p){if(p.reason===dt.message)return d({_id:e});throw p})}),Je.prototype.removeAttachment=v("removeAttachment",function(e,t,n,r){var i=this;i.get(e,function(s,d){if(s){r(s);return}if(d._rev!==n){r(E(St));return}if(!d._attachments)return r();delete d._attachments[t],Object.keys(d._attachments).length===0&&delete d._attachments,i.put(d,r)})}),Je.prototype.remove=v("remove",function(e,t,n,r){var i;typeof t=="string"?(i={_id:e,_rev:t},typeof n=="function"&&(r=n,n={})):(i=e,typeof t=="function"?(r=t,n={}):(r=n,n=t)),n=n||{},n.was_delete=!0;var s={_id:i._id,_rev:i._rev||n.rev};if(s._deleted=!0,Pt(s._id)&&typeof this._removeLocal=="function")return this._removeLocal(i,r);this.bulkDocs({docs:[s]},n,Pn(r,s._id))}),Je.prototype.revsDiff=v("revsDiff",function(e,t,n){typeof t=="function"&&(n=t,t={});var r=Object.keys(e);if(!r.length)return n(null,{});var i=0,s=new Map;function d(w,F){s.has(w)||s.set(w,{missing:[]}),s.get(w).missing.push(F)}function p(w,F){var J=e[w].slice(0);Dt(F,function(g,k,N,y,L){var z=k+"-"+N,G=J.indexOf(z);G!==-1&&(J.splice(G,1),L.status!=="available"&&d(w,z))}),J.forEach(function(g){d(w,g)})}r.map(function(w){this._getRevisionTree(w,function(F,J){if(F&&F.status===404&&F.message==="missing")s.set(w,{missing:e[w]});else{if(F)return n(F);p(w,J)}if(++i===r.length){var g={};return s.forEach(function(k,N){g[N]=k}),n(null,g)}})},this)}),Je.prototype.bulkGet=v("bulkGet",function(e,t){te(this,e,t)}),Je.prototype.compactDocument=v("compactDocument",function(e,t,n){var r=this;this._getRevisionTree(e,function(i,s){if(i)return n(i);var d=Pi(s),p=[],w=[];Object.keys(d).forEach(function(F){d[F]>t&&p.push(F)}),Dt(s,function(F,J,g,k,N){var y=J+"-"+g;N.status==="available"&&p.indexOf(y)!==-1&&w.push(y)}),r._doCompaction(e,w,n)})}),Je.prototype.compact=v("compact",function(e,t){typeof e=="function"&&(t=e,e={});var n=this;e=e||{},n._compactionQueue=n._compactionQueue||[],n._compactionQueue.push({opts:e,callback:t}),n._compactionQueue.length===1&&gr(n)}),Je.prototype._compact=function(e,t){var n=this,r={return_docs:!1,last_seq:e.last_seq||0},i=[];function s(p){i.push(n.compactDocument(p.id,0))}function d(p){var w=p.last_seq;Promise.all(i).then(function(){return an(n,"_local/compaction",function(J){return!J.last_seq||J.last_seq<w?(J.last_seq=w,J):!1})}).then(function(){t(null,{ok:!0})}).catch(t)}n.changes(r).on("change",s).on("complete",d).on("error",t)},Je.prototype.get=v("get",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),typeof e!="string")return n(E(en));if(Pt(e)&&typeof this._getLocal=="function")return this._getLocal(e,n);var r=[],i=this;function s(){var w=[],F=r.length;if(!F)return n(null,w);r.forEach(function(J){i.get(e,{rev:J,revs:t.revs,latest:t.latest,attachments:t.attachments,binary:t.binary},function(g,k){if(g)w.push({missing:J});else{for(var N,y=0,L=w.length;y<L;y++)if(w[y].ok&&w[y].ok._rev===k._rev){N=!0;break}N||w.push({ok:k})}F--,F||n(null,w)})})}if(t.open_revs){if(t.open_revs==="all")this._getRevisionTree(e,function(w,F){if(w)return n(w);r=Cn(F).map(function(J){return J.rev}),s()});else if(Array.isArray(t.open_revs)){r=t.open_revs;for(var d=0;d<r.length;d++){var p=r[d];if(!(typeof p=="string"&&/^\d+-/.test(p)))return n(E(S))}s()}else return n(E(Nt,"function_clause"));return}return this._get(e,t,function(w,F){if(w)return w.docId=e,n(w);var J=F.doc,g=F.metadata,k=F.ctx;if(t.conflicts){var N=Dn(g);N.length&&(J._conflicts=N)}if(Ot(g,J._rev)&&(J._deleted=!0),t.revs||t.revs_info){for(var y=J._rev.split("-"),L=parseInt(y[0],10),z=y[1],G=fr(g.rev_tree),Q=null,H=0;H<G.length;H++){var ee=G[H],re=ee.ids.map(function(Ne){return Ne.id}).indexOf(z),he=re===L-1;(he||!Q&&re!==-1)&&(Q=ee)}if(!Q)return w=new Error("invalid rev tree"),w.docId=e,n(w);var oe=Q.ids.map(function(Ne){return Ne.id}).indexOf(J._rev.split("-")[1])+1,ye=Q.ids.length-oe;if(Q.ids.splice(oe,ye),Q.ids.reverse(),t.revs&&(J._revisions={start:Q.pos+Q.ids.length-1,ids:Q.ids.map(function(Ne){return Ne.id})}),t.revs_info){var Ce=Q.pos+Q.ids.length;J._revs_info=Q.ids.map(function(Ne){return Ce--,{rev:Ce+"-"+Ne.id,status:Ne.opts.status}})}}if(t.attachments&&J._attachments){var ge=J._attachments,De=Object.keys(ge).length;if(De===0)return n(null,J);Object.keys(ge).forEach(function(Ne){this._getAttachment(J._id,Ne,ge[Ne],{rev:J._rev,binary:t.binary,ctx:k},function(Pe,Re){var qe=J._attachments[Ne];qe.data=Re,delete qe.stub,delete qe.length,--De||n(null,J)})},i)}else{if(J._attachments)for(var xe in J._attachments)J._attachments.hasOwnProperty(xe)&&(J._attachments[xe].stub=!0);n(null,J)}})}),Je.prototype.getAttachment=v("getAttachment",function(e,t,n,r){var i=this;n instanceof Function&&(r=n,n={}),this._get(e,n,function(s,d){if(s)return r(s);if(d.doc._attachments&&d.doc._attachments[t])n.ctx=d.ctx,n.hasOwnProperty("binary")||(n.binary=!0),i._getAttachment(e,t,d.doc._attachments[t],n,r);else return r(E(dt))})}),Je.prototype.allDocs=v("allDocs",function(e,t){if(typeof e=="function"&&(t=e,e={}),e.skip=typeof e.skip<"u"?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(r){return r in e})[0];if(n){t(E(yn,"Query parameter `"+n+"` is not compatible with multi-get"));return}if(!Ge(this)&&(qi(e),e.keys.length===0))return this._allDocs({limit:0},t)}return this._allDocs(e,t)}),Je.prototype.changes=function(e,t){return typeof e=="function"&&(t=e,e={}),e=e||{},e.return_docs="return_docs"in e?e.return_docs:!e.live,new Jt(this,e,t)},Je.prototype.close=v("close",function(e){return this._closed=!0,this.emit("closed"),this._close(e)}),Je.prototype.info=v("info",function(e){var t=this;this._info(function(n,r){if(n)return e(n);r.db_name=r.db_name||t.name,r.auto_compaction=!!(t.auto_compaction&&!Ge(t)),r.adapter=t.adapter,e(null,r)})}),Je.prototype.id=v("id",function(e){return this._id(e)}),Je.prototype.type=function(){return typeof this._type=="function"?this._type():this.adapter},Je.prototype.bulkDocs=v("bulkDocs",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(E(vt));for(var r=0;r<e.docs.length;++r)if(typeof e.docs[r]!="object"||Array.isArray(e.docs[r]))return n(E(a));var i;if(e.docs.forEach(function(p){p._attachments&&Object.keys(p._attachments).forEach(function(w){i=i||Li(w),p._attachments[w].content_type||Oe("warn","Attachment",w,"on document",p._id,"is missing content_type")})}),i)return n(E(Et,i));"new_edits"in t||("new_edits"in e?t.new_edits=e.new_edits:t.new_edits=!0);var s=this;!t.new_edits&&!Ge(s)&&e.docs.sort(Di),Ci(e.docs);var d=e.docs.map(function(p){return p._id});return this._bulkDocs(e,t,function(p,w){if(p)return n(p);if(t.new_edits||(w=w.filter(function(g){return g.error})),!Ge(s))for(var F=0,J=w.length;F<J;F++)w[F].id=w[F].id||d[F];n(null,w)})}),Je.prototype.registerDependentDatabase=v("registerDependentDatabase",function(e,t){var n=new this.constructor(e,this.__opts);function r(i){return i.dependentDbs=i.dependentDbs||{},i.dependentDbs[e]?!1:(i.dependentDbs[e]=!0,i)}an(this,"_local/_pouch_dependentDbs",r).then(function(){t(null,{db:n})}).catch(t)}),Je.prototype.destroy=v("destroy",function(e,t){typeof e=="function"&&(t=e,e={});var n=this,r="use_prefix"in n?n.use_prefix:!0;function i(){n._destroy(e,function(s,d){if(s)return t(s);n._destroyed=!0,n.emit("destroyed"),t(null,d||{ok:!0})})}if(Ge(n))return i();n.get("_local/_pouch_dependentDbs",function(s,d){if(s)return s.status!==404?t(s):i();var p=d.dependentDbs,w=n.constructor,F=Object.keys(p).map(function(J){var g=r?J.replace(new RegExp("^"+w.prefix),""):J;return new w(g,n.__opts).destroy()});Promise.all(F).then(i,t)})});function Wt(){this.isReady=!1,this.failed=!1,this.queue=[]}Wt.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},Wt.prototype.fail=function(e){this.failed=e,this.execute()},Wt.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},Wt.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()};function Ri(e,t){var n=e.match(/([a-z-]*):\/\/(.*)/);if(n)return{name:/https?/.test(n[1])?n[1]+"://"+n[2]:n[2],adapter:n[1]};var r=ke.adapters,i=ke.preferredAdapters,s=ke.prefix,d=t.adapter;if(!d)for(var p=0;p<i.length;++p){if(d=i[p],d==="idb"&&"websql"in r&&ae()&&localStorage["_pouch__websqldb_"+s+e]){Oe("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}var w=r[d],F=w&&"use_prefix"in w?w.use_prefix:!0;return{name:F?s+e:e,adapter:d}}function Ii(e){function t(r){e.removeListener("closed",n),r||e.constructor.emit("destroyed",e.name)}function n(){e.removeListener("destroyed",t),e.constructor.emit("unref",e)}e.once("destroyed",t),e.once("closed",n),e.constructor.emit("ref",e)}ne(ke,Je);function ke(e,t){if(!(this instanceof ke))return new ke(e,t);var n=this;if(t=t||{},e&&typeof e=="object"&&(t=e,e=t.name,delete t.name),t.deterministic_revs===void 0&&(t.deterministic_revs=!0),this.__opts=t=l(t),n.auto_compaction=t.auto_compaction,n.prefix=ke.prefix,typeof e!="string")throw new Error("Missing/invalid DB name");var r=(t.prefix||"")+e,i=Ri(r,t);if(t.name=i.name,t.adapter=t.adapter||i.adapter,n.name=e,n._adapter=t.adapter,ke.emit("debug",["adapter","Picked adapter: ",t.adapter]),!ke.adapters[t.adapter]||!ke.adapters[t.adapter].valid())throw new Error("Invalid Adapter: "+t.adapter);Je.call(n),n.taskqueue=new Wt,n.adapter=t.adapter,ke.adapters[t.adapter].call(n,t,function(s){if(s)return n.taskqueue.fail(s);Ii(n),n.emit("created",n),ke.emit("created",n.name),n.taskqueue.ready(n)})}var Bi=typeof AbortController<"u"?AbortController:function(){return{abort:function(){}}},mr=fetch,Ut=Headers;ke.adapters={},ke.preferredAdapters=[],ke.prefix="_pouch_";var pr=new Z;function ki(e){Object.keys(Z.prototype).forEach(function(n){typeof Z.prototype[n]=="function"&&(e[n]=pr[n].bind(pr))});var t=e._destructionListeners=new Map;e.on("ref",function(r){t.has(r.name)||t.set(r.name,[]),t.get(r.name).push(r)}),e.on("unref",function(r){if(t.has(r.name)){var i=t.get(r.name),s=i.indexOf(r);s<0||(i.splice(s,1),i.length>1?t.set(r.name,i):t.delete(r.name))}}),e.on("destroyed",function(r){if(t.has(r)){var i=t.get(r);t.delete(r),i.forEach(function(s){s.emit("destroyed",!0)})}})}ki(ke),ke.adapter=function(e,t,n){t.valid()&&(ke.adapters[e]=t,n&&ke.preferredAdapters.push(e))},ke.plugin=function(e){if(typeof e=="function")e(ke);else{if(typeof e!="object"||Object.keys(e).length===0)throw new Error('Invalid plugin: got "'+e+'", expected an object or a function');Object.keys(e).forEach(function(t){ke.prototype[t]=e[t]})}return this.__defaults&&(ke.__defaults=Object.assign({},this.__defaults)),ke},ke.defaults=function(e){function t(n,r){if(!(this instanceof t))return new t(n,r);r=r||{},n&&typeof n=="object"&&(r=n,n=r.name,delete r.name),r=Object.assign({},t.__defaults,r),ke.call(this,n,r)}return ne(t,ke),t.preferredAdapters=ke.preferredAdapters.slice(),Object.keys(ke).forEach(function(n){n in t||(t[n]=ke[n])}),t.__defaults=Object.assign({},this.__defaults,e),t},ke.fetch=function(e,t){return mr(e,t)};var xi="7.0.0-prerelease";function qn(e,t){for(var n=e,r=0,i=t.length;r<i;r++){var s=t[r];if(n=n[s],!n)break}return n}function Ni(e,t){return e<t?-1:e>t?1:0}function Ln(e){for(var t=[],n="",r=0,i=e.length;r<i;r++){var s=e[r];r>0&&e[r-1]==="\\"&&(s==="$"||s===".")?n=n.substring(0,n.length-1)+s:s==="."?(t.push(n),n=""):n+=s}return t.push(n),t}var Mi=["$or","$nor","$not"];function yr(e){return Mi.indexOf(e)>-1}function _r(e){return Object.keys(e)[0]}function Ui(e){return e[_r(e)]}function Qt(e){var t={},n={$or:!0,$nor:!0};return e.forEach(function(r){Object.keys(r).forEach(function(i){var s=r[i];if(typeof s!="object"&&(s={$eq:s}),yr(i))if(s instanceof Array){if(n[i]){n[i]=!1,t[i]=s;return}var d=[];t[i].forEach(function(w){Object.keys(s).forEach(function(F){var J=s[F],g=Math.max(Object.keys(w).length,Object.keys(J).length),k=Qt([w,J]);Object.keys(k).length<=g||d.push(k)})}),t[i]=d}else t[i]=Qt([s]);else{var p=t[i]=t[i]||{};Object.keys(s).forEach(function(w){var F=s[w];if(w==="$gt"||w==="$gte")return Fi(w,F,p);if(w==="$lt"||w==="$lte")return $i(w,F,p);if(w==="$ne")return ji(F,p);if(w==="$eq")return Hi(F,p);if(w==="$regex")return zi(F,p);p[w]=F})}})}),t}function Fi(e,t,n){typeof n.$eq<"u"||(typeof n.$gte<"u"?e==="$gte"?t>n.$gte&&(n.$gte=t):t>=n.$gte&&(delete n.$gte,n.$gt=t):typeof n.$gt<"u"?e==="$gte"?t>n.$gt&&(delete n.$gt,n.$gte=t):t>n.$gt&&(n.$gt=t):n[e]=t)}function $i(e,t,n){typeof n.$eq<"u"||(typeof n.$lte<"u"?e==="$lte"?t<n.$lte&&(n.$lte=t):t<=n.$lte&&(delete n.$lte,n.$lt=t):typeof n.$lt<"u"?e==="$lte"?t<n.$lt&&(delete n.$lt,n.$lte=t):t<n.$lt&&(n.$lt=t):n[e]=t)}function ji(e,t){"$ne"in t?t.$ne.push(e):t.$ne=[e]}function Hi(e,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=e}function zi(e,t){"$regex"in t?t.$regex.push(e):t.$regex=[e]}function wr(e){for(var t in e){if(Array.isArray(e))for(var n in e)e[n].$and&&(e[n]=Qt(e[n].$and));var r=e[t];typeof r=="object"&&wr(r)}return e}function br(e,t){for(var n in e){n==="$and"&&(t=!0);var r=e[n];typeof r=="object"&&(t=br(r,t))}return t}function Ki(e){var t=l(e),n=!1;br(t,!1)&&(t=wr(t),"$and"in t&&(t=Qt(t.$and)),n=!0),["$or","$nor"].forEach(function(p){p in t&&t[p].forEach(function(w){for(var F=Object.keys(w),J=0;J<F.length;J++){var g=F[J],k=w[g];(typeof k!="object"||k===null)&&(w[g]={$eq:k})}})}),"$not"in t&&(t.$not=Qt([t.$not]));for(var r=Object.keys(t),i=0;i<r.length;i++){var s=r[i],d=t[s];typeof d!="object"||d===null?d={$eq:d}:n||("$ne"in d&&(d.$ne=[d.$ne]),"$regex"in d&&(d.$regex=[d.$regex])),t[s]=d}return t}function Gi(e,t,n){for(var r="",i=n-e.length;r.length<i;)r+=t;return r}function Ji(e,t,n){var r=Gi(e,t,n);return r+e}var Ar=-324,Rn=3,In="";function Ve(e,t){if(e===t)return 0;e=qt(e),t=qt(t);var n=Bn(e),r=Bn(t);if(n-r!==0)return n-r;switch(typeof e){case"number":return e-t;case"boolean":return e<t?-1:1;case"string":return Zi(e,t)}return Array.isArray(e)?Yi(e,t):Vi(e,t)}function qt(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var r=0;r<n;r++)e[r]=qt(t[r])}else{if(e instanceof Date)return e.toJSON();if(e!==null){e={};for(var i in t)if(t.hasOwnProperty(i)){var s=t[i];typeof s<"u"&&(e[i]=qt(s))}}}}return e}function Wi(e){if(e!==null)switch(typeof e){case"boolean":return e?1:0;case"number":return ea(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(e),n=t?e:Object.keys(e),r=-1,i=n.length,s="";if(t)for(;++r<i;)s+=mt(n[r]);else for(;++r<i;){var d=n[r];s+=mt(d)+mt(e[d])}return s}return""}function mt(e){var t="\0";return e=qt(e),Bn(e)+In+Wi(e)+t}function Qi(e,t){var n=t,r,i=e[t]==="1";if(i)r=0,t++;else{var s=e[t]==="0";t++;var d="",p=e.substring(t,t+Rn),w=parseInt(p,10)+Ar;for(s&&(w=-w),t+=Rn;;){var F=e[t];if(F==="\0")break;d+=F,t++}d=d.split("."),d.length===1?r=parseInt(d,10):r=parseFloat(d[0]+"."+d[1]),s&&(r=r-10),w!==0&&(r=parseFloat(r+"e"+w))}return{num:r,length:t-n}}function Xi(e,t){var n=e.pop();if(t.length){var r=t[t.length-1];n===r.element&&(t.pop(),r=t[t.length-1]);var i=r.element,s=r.index;if(Array.isArray(i))i.push(n);else if(s===e.length-2){var d=e.pop();i[d]=n}else e.push(n)}}function Sr(e){for(var t=[],n=[],r=0;;){var i=e[r++];if(i==="\0"){if(t.length===1)return t.pop();Xi(t,n);continue}switch(i){case"1":t.push(null);break;case"2":t.push(e[r]==="1"),r++;break;case"3":var s=Qi(e,r);t.push(s.num),r+=s.length;break;case"4":for(var d="";;){var p=e[r];if(p==="\0")break;d+=p,r++}d=d.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(d);break;case"5":var w={element:[],index:t.length};t.push(w.element),n.push(w);break;case"6":var F={element:{},index:t.length};t.push(F.element),n.push(F);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}}}function Yi(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=Ve(e[r],t[r]);if(i!==0)return i}return e.length===t.length?0:e.length>t.length?1:-1}function Zi(e,t){return e===t?0:e>t?1:-1}function Vi(e,t){for(var n=Object.keys(e),r=Object.keys(t),i=Math.min(n.length,r.length),s=0;s<i;s++){var d=Ve(n[s],r[s]);if(d!==0||(d=Ve(e[n[s]],t[r[s]]),d!==0))return d}return n.length===r.length?0:n.length>r.length?1:-1}function Bn(e){var t=["boolean","number","string","object"],n=t.indexOf(typeof e);if(~n)return e===null?1:Array.isArray(e)?5:n<3?n+2:n+3;if(Array.isArray(e))return 5}function ea(e){if(e===0)return"1";var t=e.toExponential().split(/e\+?/),n=parseInt(t[1],10),r=e<0,i=r?"0":"2",s=(r?-n:n)-Ar,d=Ji(s.toString(),"0",Rn);i+=In+d;var p=Math.abs(parseFloat(t[0]));r&&(p=10-p);var w=p.toFixed(20);return w=w.replace(/\.?0+$/,""),i+=In+w,i}function ta(e){function t(n){return e.map(function(r){var i=_r(r),s=Ln(i),d=qn(n,s);return d})}return function(n,r){var i=t(n.doc),s=t(r.doc),d=Ve(i,s);return d!==0?d:Ni(n.doc._id,r.doc._id)}}function na(e,t,n){if(e=e.filter(function(d){return Ft(d.doc,t.selector,n)}),t.sort){var r=ta(t.sort);e=e.sort(r),typeof t.sort[0]!="string"&&Ui(t.sort[0])==="desc"&&(e=e.reverse())}if("limit"in t||"skip"in t){var i=t.skip||0,s=("limit"in t?t.limit:e.length)+i;e=e.slice(i,s)}return e}function Ft(e,t,n){return n.every(function(r){var i=t[r],s=Ln(r),d=qn(e,s);return yr(r)?ra(r,i,e):un(i,e,s,d)})}function un(e,t,n,r){return e?typeof e=="object"?Object.keys(e).every(function(i){var s=e[i];if(i.indexOf("$")===0)return Or(i,t,s,n,r);var d=Ln(i);if(r===void 0&&typeof s!="object"&&d.length>0)return!1;var p=qn(r,d);return typeof s=="object"?un(s,t,n,p):Or("$eq",t,s,d,p)}):e===r:!0}function ra(e,t,n){return e==="$or"?t.some(function(r){return Ft(n,r,Object.keys(r))}):e==="$not"?!Ft(n,t,Object.keys(t)):!t.find(function(r){return Ft(n,r,Object.keys(r))})}function Or(e,t,n,r,i){if(!Er[e])throw new Error('unknown operator "'+e+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return Er[e](t,n,r,i)}function Xt(e){return typeof e<"u"&&e!==null}function Lt(e){return typeof e<"u"}function ia(e,t){if(typeof e!="number"||parseInt(e,10)!==e)return!1;var n=t[0],r=t[1];return e%n===r}function Tr(e,t){return t.some(function(n){return e instanceof Array?e.some(function(r){return Ve(n,r)===0}):Ve(n,e)===0})}function aa(e,t){return t.every(function(n){return e.some(function(r){return Ve(n,r)===0})})}function oa(e,t){return e.length===t}function ua(e,t){var n=new RegExp(t);return n.test(e)}function sa(e,t){switch(t){case"null":return e===null;case"boolean":return typeof e=="boolean";case"number":return typeof e=="number";case"string":return typeof e=="string";case"array":return e instanceof Array;case"object":return{}.toString.call(e)==="[object Object]"}}var Er={$elemMatch:function(e,t,n,r){return!Array.isArray(r)||r.length===0?!1:typeof r[0]=="object"?r.some(function(i){return Ft(i,t,Object.keys(t))}):r.some(function(i){return un(t,e,n,i)})},$allMatch:function(e,t,n,r){return!Array.isArray(r)||r.length===0?!1:typeof r[0]=="object"?r.every(function(i){return Ft(i,t,Object.keys(t))}):r.every(function(i){return un(t,e,n,i)})},$eq:function(e,t,n,r){return Lt(r)&&Ve(r,t)===0},$gte:function(e,t,n,r){return Lt(r)&&Ve(r,t)>=0},$gt:function(e,t,n,r){return Lt(r)&&Ve(r,t)>0},$lte:function(e,t,n,r){return Lt(r)&&Ve(r,t)<=0},$lt:function(e,t,n,r){return Lt(r)&&Ve(r,t)<0},$exists:function(e,t,n,r){return t?Lt(r):!Lt(r)},$mod:function(e,t,n,r){return Xt(r)&&ia(r,t)},$ne:function(e,t,n,r){return t.every(function(i){return Ve(r,i)!==0})},$in:function(e,t,n,r){return Xt(r)&&Tr(r,t)},$nin:function(e,t,n,r){return Xt(r)&&!Tr(r,t)},$size:function(e,t,n,r){return Xt(r)&&Array.isArray(r)&&oa(r,t)},$all:function(e,t,n,r){return Array.isArray(r)&&aa(r,t)},$regex:function(e,t,n,r){return Xt(r)&&typeof r=="string"&&t.every(function(i){return ua(r,i)})},$type:function(e,t,n,r){return sa(r,t)}};function fa(e,t){if(typeof t!="object")throw new Error("Selector error: expected a JSON object");t=Ki(t);var n={doc:e},r=na([n],{selector:t},Object.keys(t));return r&&r.length===1}function ca(e){return _n(`"use strict";
return `+e+";",{})}function la(e){var t=["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+e+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join(`
`);return _n(t,{})}function da(e,t){if(e.selector&&e.filter&&e.filter!=="_selector"){var n=typeof e.filter=="string"?e.filter:"function";return t(new Error('selector invalid for filter "'+n+'"'))}t()}function ha(e){e.view&&!e.filter&&(e.filter="_view"),e.selector&&!e.filter&&(e.filter="_selector"),e.filter&&typeof e.filter=="string"&&(e.filter==="_view"?e.view=Kt(e.view):e.filter=Kt(e.filter))}function va(e,t){return t.filter&&typeof t.filter=="string"&&!t.doc_ids&&!Ge(e.db)}function ga(e,t){var n=t.complete;if(t.filter==="_view"){if(!t.view||typeof t.view!="string"){var r=E(Et,"`view` filter parameter not found or invalid.");return n(r)}var i=Mt(t.view);e.db.get("_design/"+i[0],function(d,p){if(e.isCancelled)return n(null,{status:"cancelled"});if(d)return n(x(d));var w=p&&p.views&&p.views[i[1]]&&p.views[i[1]].map;if(!w)return n(E(dt,p.views?"missing json key: "+i[1]:"missing json key: views"));t.filter=la(w),e.doChanges(t)})}else if(t.selector)t.filter=function(d){return fa(d,t.selector)},e.doChanges(t);else{var s=Mt(t.filter);e.db.get("_design/"+s[0],function(d,p){if(e.isCancelled)return n(null,{status:"cancelled"});if(d)return n(x(d));var w=p&&p.filters&&p.filters[s[1]];if(!w)return n(E(dt,p&&p.filters?"missing json key: "+s[1]:"missing json key: filters"));t.filter=ca(w),e.doChanges(t)})}}function ma(e){e._changesFilterPlugin={validate:da,normalize:ha,shouldFilter:va,filter:ga}}ke.plugin(ma),ke.version=xi;function Cr(e){return e.reduce(function(t,n){return t[n]=!0,t},{})}var pa=Cr(["_id","_rev","_access","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),ya=Cr(["_access","_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function Dr(e){if(!/^\d+-/.test(e))return E(S);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function _a(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,i=[r[0],t,[]],s=1,d=r.length;s<d;s++)i=[r[s],{status:"missing"},[i]];return[{pos:n,ids:i}]}function Pr(e,t,n){n||(n={deterministic_revs:!0});var r,i,s,d={status:"available"};if(e._deleted&&(d.deleted=!0),t)if(e._id||(e._id=on()),i=sr(e,n.deterministic_revs),e._rev){if(s=Dr(e._rev),s.error)return s;e._rev_tree=[{pos:s.prefix,ids:[s.id,{status:"missing"},[[i,d,[]]]]}],r=s.prefix+1}else e._rev_tree=[{pos:1,ids:[i,d,[]]}],r=1;else if(e._revisions&&(e._rev_tree=_a(e._revisions,d),r=e._revisions.start,i=e._revisions.ids[0]),!e._rev_tree){if(s=Dr(e._rev),s.error)return s;r=s.prefix,i=s.id,e._rev_tree=[{pos:r,ids:[i,d,[]]}]}Me(e._id),e._rev=r+"-"+i;var p={metadata:{},data:{}};for(var w in e)if(Object.prototype.hasOwnProperty.call(e,w)){var F=w[0]==="_";if(F&&!pa[w]){var J=E(rn,w);throw J.message=rn.message+": "+w,J}else F&&!ya[w]?p.metadata[w.slice(1)]=e[w]:p.data[w]=e[w]}return p}function wa(e){try{return wn(e)}catch{var t=E(nn,"Attachment is not a valid base64 string");return{error:t}}}function ba(e,t,n){var r=wa(e.data);if(r.error)return n(r.error);e.length=r.length,t==="blob"?e.data=An(r,e.content_type):t==="base64"?e.data=Gt(r):e.data=r,Tn(r,function(i){e.digest="md5-"+i,n()})}function Aa(e,t,n){Tn(e.data,function(r){e.digest="md5-"+r,e.length=e.data.size||e.data.length||0,t==="binary"?ur(e.data,function(i){e.data=i,n()}):t==="base64"?On(e.data,function(i){e.data=i,n()}):n()})}function Sa(e,t,n){if(e.stub)return n();typeof e.data=="string"?ba(e,t,n):Aa(e,t,n)}function Oa(e,t,n){if(!e.length)return n();var r=0,i;e.forEach(function(d){var p=d.data&&d.data._attachments?Object.keys(d.data._attachments):[],w=0;if(!p.length)return s();function F(g){i=g,w++,w===p.length&&s()}for(var J in d.data._attachments)d.data._attachments.hasOwnProperty(J)&&Sa(d.data._attachments[J],t,F)});function s(){r++,e.length===r&&(i?n(i):n())}}function Ta(e,t,n,r,i,s,d,p){if(Ai(t.rev_tree,n.metadata.rev)&&!p)return r[i]=n,s();var w=t.winningRev||Ct(t),F="deleted"in t?t.deleted:Ot(t,w),J="deleted"in n.metadata?n.metadata.deleted:Ot(n.metadata),g=/^1-/.test(n.metadata.rev);if(F&&!J&&p&&g){var k=n.data;k._rev=w,k._id=n.metadata.id,n=Pr(k,p)}var N=hr(t.rev_tree,n.metadata.rev_tree[0],e),y=p&&(F&&J&&N.conflicts!=="new_leaf"||!F&&N.conflicts!=="new_leaf"||F&&!J&&N.conflicts==="new_branch");if(y){var L=E(St);return r[i]=L,s()}var z=n.metadata.rev;n.metadata.rev_tree=N.tree,n.stemmedRevs=N.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var G=Ct(n.metadata),Q=Ot(n.metadata,G),H=F===Q?0:F<Q?-1:1,ee;z===G?ee=Q:ee=Ot(n.metadata,z),d(n,G,Q,ee,!0,H,i,s)}function Ea(e){return e.metadata.rev_tree[0].ids[1].status==="missing"}function Ca(e,t,n,r,i,s,d,p,w){e=e||1e3;function F(L,z,G){var Q=Ct(L.metadata),H=Ot(L.metadata,Q);if("was_delete"in p&&H)return s[z]=E(dt,"deleted"),G();var ee=J&&Ea(L);if(ee){var re=E(St);return s[z]=re,G()}var he=H?0:1;d(L,Q,H,H,!1,he,z,G)}var J=p.new_edits,g=new Map,k=0,N=t.length;function y(){++k===N&&w&&w()}t.forEach(function(L,z){if(L._id&&Pt(L._id)){var G=L._deleted?"_removeLocal":"_putLocal";n[G](L,{ctx:i},function(H,ee){s[z]=H||ee,y()});return}var Q=L.metadata.id;g.has(Q)?(N--,g.get(Q).push([L,z])):g.set(Q,[[L,z]])}),g.forEach(function(L,z){var G=0;function Q(){++G<L.length?H():y()}function H(){var ee=L[G],re=ee[0],he=ee[1];if(r.has(z))Ta(e,r.get(z),re,s,he,Q,d,J);else{var oe=hr([],re.metadata.rev_tree[0],e);re.metadata.rev_tree=oe.tree,re.stemmedRevs=oe.stemmedRevs||[],F(re,he,Q)}}H()})}var Da=5,nt="document-store",ut="by-sequence",pt="attach-store",Rt="attach-seq-store",ct="meta-store",wt="local-store",kn="detect-blob-support";function Pa(e){try{return JSON.parse(e)}catch{return M.parse(e)}}function qa(e){try{return JSON.stringify(e)}catch{return M.stringify(e)}}function bt(e){return function(t){var n="unknown_error";t.target&&t.target.error&&(n=t.target.error.name||t.target.error.message),e(E(c,n,t.type))}}function xn(e,t,n){return{data:qa(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}}function It(e){if(!e)return null;var t=Pa(e.data);return t.winningRev=e.winningRev,t.deleted=e.deletedOrLocal==="1",t.seq=e.seq,t}function sn(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function qr(e,t,n,r){n?r(e?typeof e!="string"?e:Sn(e,t):bn([""],{type:t})):e?typeof e!="string"?or(e,function(i){r(Gt(i))}):r(e):r("")}function Lr(e,t,n,r){var i=Object.keys(e._attachments||{});if(!i.length)return r&&r();var s=0;function d(){++s===i.length&&r&&r()}function p(w,F){var J=w._attachments[F],g=J.digest,k=n.objectStore(pt).get(g);k.onsuccess=function(N){J.body=N.target.result.body,d()}}i.forEach(function(w){t.attachments&&t.include_docs?p(e,w):(e._attachments[w].stub=!0,d())})}function Nn(e,t){return Promise.all(e.map(function(n){if(n.doc&&n.doc._attachments){var r=Object.keys(n.doc._attachments);return Promise.all(r.map(function(i){var s=n.doc._attachments[i];if("body"in s){var d=s.body,p=s.content_type;return new Promise(function(w){qr(d,p,t,function(F){n.doc._attachments[i]=Object.assign(b(s,["digest","content_type"]),{data:F}),w()})})}}))}}))}function Rr(e,t,n){var r=[],i=n.objectStore(ut),s=n.objectStore(pt),d=n.objectStore(Rt),p=e.length;function w(){p--,p||F()}function F(){r.length&&r.forEach(function(J){var g=d.index("digestSeq").count(IDBKeyRange.bound(J+"::",J+"::￿",!1,!1));g.onsuccess=function(k){var N=k.target.result;N||s.delete(J)}})}e.forEach(function(J){var g=i.index("_doc_id_rev"),k=t+"::"+J;g.getKey(k).onsuccess=function(N){var y=N.target.result;if(typeof y!="number")return w();i.delete(y);var L=d.index("seq").openCursor(IDBKeyRange.only(y));L.onsuccess=function(z){var G=z.target.result;if(G){var Q=G.value.digestSeq.split("::")[0];r.push(Q),d.delete(G.primaryKey),G.continue()}else w()}}})}function _t(e,t,n){try{return{txn:e.transaction(t,n)}}catch(r){return{error:r}}}var Yt=new me;function La(e,t,n,r,i,s){for(var d=t.docs,p,w,F,J,g,k,N,y,L=0,z=d.length;L<z;L++){var G=d[L];G._id&&Pt(G._id)||(G=d[L]=Pr(G,n.new_edits,e),G.error&&!N&&(N=G))}if(N)return s(N);var Q=!1,H=0,ee=new Array(d.length),re=new Map,he=!1,oe=r._meta.blobSupport?"blob":"base64";Oa(d,oe,function(B){if(B)return s(B);ye()});function ye(){var B=[nt,ut,pt,wt,Rt,ct],U=_t(i,B,"readwrite");if(U.error)return s(U.error);p=U.txn,p.onabort=bt(s),p.ontimeout=bt(s),p.oncomplete=Ne,w=p.objectStore(nt),F=p.objectStore(ut),J=p.objectStore(pt),g=p.objectStore(Rt),k=p.objectStore(ct),k.get(ct).onsuccess=function(I){y=I.target.result,De()},Re(function(I){if(I)return he=!0,s(I);xe()})}function Ce(){Q=!0,De()}function ge(){Ca(e.revs_limit,d,r,re,p,ee,qe,n,Ce)}function De(){!y||!Q||(y.docCount+=H,y.docCount<0&&(y.docCount=0),k.put(y))}function xe(){if(!d.length)return;var B=0;function U(){++B===d.length&&ge()}function I(fe){var pe=It(fe.target.result);pe&&re.set(pe.id,pe),U()}for(var X=0,se=d.length;X<se;X++){var ce=d[X];if(ce._id&&Pt(ce._id)){U();continue}var ve=w.get(ce.metadata.id);ve.onsuccess=I}}function Ne(){he||(Yt.notify(r._meta.name),s(null,ee))}function Pe(B,U){var I=J.get(B);I.onsuccess=function(X){if(X.target.result)U();else{var se=E(O,"unknown stub attachment with digest "+B);se.status=412,U(se)}}}function Re(B){var U=[];if(d.forEach(function(ce){ce.data&&ce.data._attachments&&Object.keys(ce.data._attachments).forEach(function(ve){var fe=ce.data._attachments[ve];fe.stub&&U.push(fe.digest)})}),!U.length)return B();var I=0,X;function se(){++I===U.length&&B(X)}U.forEach(function(ce){Pe(ce,function(ve){ve&&!X&&(X=ve),se()})})}function qe(B,U,I,X,se,ce,ve,fe){B.metadata.winningRev=U,B.metadata.deleted=I;var pe=B.data;pe._id=B.metadata.id,pe._rev=B.metadata.rev,X&&(pe._deleted=!0),H+=ce,De();var Ee=pe._attachments&&Object.keys(pe._attachments).length;if(Ee)return We(B,U,I,se,ve,fe);je(B,U,I,se,ve,fe)}function je(B,U,I,X,se,ce){var ve=B.data,fe=B.metadata;ve._doc_id_rev=fe.id+"::"+fe.rev,delete ve._id,delete ve._rev;function pe(Be){var Ke=B.stemmedRevs||[];X&&r.auto_compaction&&(Ke=Ke.concat(mi(B.metadata))),Ke&&Ke.length&&Rr(Ke,B.metadata.id,p),fe.seq=Be.target.result;var it=xn(fe,U,I),Qe=w.put(it);Qe.onsuccess=$e}function Ee(Be){Be.preventDefault(),Be.stopPropagation();var Ke=F.index("_doc_id_rev"),it=Ke.getKey(ve._doc_id_rev);it.onsuccess=function(Qe){var at=F.put(ve,Qe.target.result);at.onsuccess=pe}}function $e(){ee[se]={ok:!0,id:fe.id,rev:fe.rev},re.set(B.metadata.id,B.metadata),et(B,fe.seq,ce)}var _e=F.put(ve);_e.onsuccess=pe,_e.onerror=Ee}function We(B,U,I,X,se,ce){var ve=B.data,fe=0,pe=Object.keys(ve._attachments);function Ee(){fe===pe.length&&je(B,U,I,X,se,ce)}function $e(){fe++,Ee()}pe.forEach(function(_e){var Be=B.data._attachments[_e];if(Be.stub)fe++,Ee();else{var Ke=Be.data;delete Be.data,Be.revpos=parseInt(U,10);var it=Be.digest;st(it,Ke,$e)}})}function et(B,U,I){var X=0,se=Object.keys(B.data._attachments||{});if(!se.length)return I();function ce(){++X===se.length&&I()}function ve(pe){var Ee=B.data._attachments[pe].digest,$e=g.put({seq:U,digestSeq:Ee+"::"+U});$e.onsuccess=ce,$e.onerror=function(_e){_e.preventDefault(),_e.stopPropagation(),ce()}}for(var fe=0;fe<se.length;fe++)ve(se[fe])}function st(B,U,I){var X=J.count(B);X.onsuccess=function(se){var ce=se.target.result;if(ce)return I();var ve={digest:B,body:U},fe=J.put(ve);fe.onsuccess=I}}}function Ir(e,t,n,r,i){r===-1&&(r=1e3);var s=typeof e.getAll=="function"&&typeof e.getAllKeys=="function"&&r>1&&!n,d,p,w;function F(N){p=N.target.result,d&&i(d,p,w)}function J(N){d=N.target.result,p&&i(d,p,w)}function g(){if(!d.length)return i();var N=d[d.length-1],y;if(t&&t.upper)try{y=IDBKeyRange.bound(N,t.upper,!0,t.upperOpen)}catch(L){if(L.name==="DataError"&&L.code===0)return i()}else y=IDBKeyRange.lowerBound(N,!0);t=y,d=null,p=null,e.getAll(t,r).onsuccess=F,e.getAllKeys(t,r).onsuccess=J}function k(N){var y=N.target.result;if(!y)return i();i([y.key],[y.value],y)}s?(w={continue:g},e.getAll(t,r).onsuccess=F,e.getAllKeys(t,r).onsuccess=J):n?e.openCursor(t,"prev").onsuccess=k:e.openCursor(t).onsuccess=k}function Ra(e,t,n){if(typeof e.getAll=="function"){e.getAll(t).onsuccess=n;return}var r=[];function i(s){var d=s.target.result;d?(r.push(d.value),d.continue()):n({target:{result:r}})}e.openCursor(t).onsuccess=i}function Ia(e,t,n){var r=new Array(e.length),i=0;e.forEach(function(s,d){t.get(s).onsuccess=function(p){p.target.result?r[d]=p.target.result:r[d]={key:s,error:"not_found"},i++,i===e.length&&n(e,r,{})}})}function Ba(e,t,n,r,i){try{if(e&&t)return i?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return i?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return i?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(s){return{error:s}}return null}function ka(e,t,n){var r="startkey"in e?e.startkey:!1,i="endkey"in e?e.endkey:!1,s="key"in e?e.key:!1,d="keys"in e?e.keys:!1,p=e.skip||0,w=typeof e.limit=="number"?e.limit:-1,F=e.inclusive_end!==!1,J,g;if(!d&&(J=Ba(r,i,F,s,e.descending),g=J&&J.error,g&&!(g.name==="DataError"&&g.code===0)))return n(E(c,g.name,g.message));var k=[nt,ut,ct];e.attachments&&k.push(pt);var N=_t(t,k,"readonly");if(N.error)return n(N.error);var y=N.txn;y.oncomplete=Ne,y.onabort=bt(n);var L=y.objectStore(nt),z=y.objectStore(ut),G=y.objectStore(ct),Q=z.index("_doc_id_rev"),H=[],ee,re;G.get(ct).onsuccess=function(Pe){ee=Pe.target.result.docCount},e.update_seq&&he(z,function(Pe){Pe.target.result&&Pe.target.result.length>0&&(re=Pe.target.result[0])});function he(Pe,Re){function qe(je){var We=je.target.result,et=void 0;return We&&We.key&&(et=We.key),Re({target:{result:[et]}})}Pe.openCursor(null,"prev").onsuccess=qe}function oe(Pe,Re,qe){var je=Pe.id+"::"+qe;Q.get(je).onsuccess=function(et){if(Re.doc=sn(et.target.result)||{},e.conflicts){var st=Dn(Pe);st.length&&(Re.doc._conflicts=st)}Lr(Re.doc,e,y)}}function ye(Pe,Re){var qe={id:Re.id,key:Re.id,value:{rev:Pe}},je=Re.deleted;je?d&&(H.push(qe),qe.value.deleted=!0,qe.doc=null):p--<=0&&(H.push(qe),e.include_docs&&oe(Re,qe,Pe))}function Ce(Pe){for(var Re=0,qe=Pe.length;Re<qe&&H.length!==w;Re++){var je=Pe[Re];if(je.error&&d){H.push(je);continue}var We=It(je),et=We.winningRev;ye(et,We)}}function ge(Pe,Re,qe){qe&&(Ce(Re),H.length<w&&qe.continue())}function De(Pe){var Re=Pe.target.result;e.descending&&(Re=Re.reverse()),Ce(Re)}function xe(){var Pe={total_rows:ee,offset:e.skip,rows:H};e.update_seq&&re!==void 0&&(Pe.update_seq=re),n(null,Pe)}function Ne(){e.attachments?Nn(H,e.binary).then(xe):xe()}if(!(g||w===0)){if(d)return Ia(e.keys,L,ge);if(w===-1)return Ra(L,J,De);Ir(L,J,e.descending,w+p,ge)}}function xa(e){return new Promise(function(t){var n=bn([""]),r=e.objectStore(kn).put(n,"key");r.onsuccess=function(){var i=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);t(s||!i||parseInt(i[1],10)>=43)},r.onerror=e.onabort=function(i){i.preventDefault(),i.stopPropagation(),t(!1)}}).catch(function(){return!1})}var Mn=!1,Un=[];function Na(e,t,n,r){try{e(t,n)}catch(i){r.emit("error",i)}}function Br(){Mn||!Un.length||(Mn=!0,Un.shift()())}function Ma(e,t,n){Un.push(function(){e(function(s,d){Na(t,s,d,n),Mn=!1,D(function(){Br()})})}),Br()}function Ua(e,t,n,r){if(e=l(e),e.continuous){var i=n+":"+on();return Yt.addListener(n,i,t,e),Yt.notify(n),{cancel:function(){Yt.removeListener(n,i)}}}var s=e.doc_ids&&new Set(e.doc_ids);e.since=e.since||0;var d=e.since,p="limit"in e?e.limit:-1;p===0&&(p=1);var w=[],F=0,J=ue(e),g=new Map,k,N,y,L;function z(ye,Ce,ge){if(!ge||!ye.length)return;var De=new Array(ye.length),xe=new Array(ye.length);function Ne(qe,je){var We=e.processChange(je,qe,e);d=We.seq=qe.seq;var et=J(We);return typeof et=="object"?Promise.reject(et):et?(F++,e.return_docs&&w.push(We),e.attachments&&e.include_docs?new Promise(function(st){Lr(je,e,k,function(){Nn([We],e.binary).then(function(){st(We)})})}):Promise.resolve(We)):Promise.resolve()}function Pe(){for(var qe=[],je=0,We=De.length;je<We&&F!==p;je++){var et=De[je];if(et){var st=xe[je];qe.push(Ne(st,et))}}Promise.all(qe).then(function(B){for(var U=0,I=B.length;U<I;U++)B[U]&&e.onChange(B[U])}).catch(e.complete),F!==p&&ge.continue()}var Re=0;Ce.forEach(function(qe,je){var We=sn(qe),et=ye[je];Q(We,et,function(st,B){xe[je]=st,De[je]=B,++Re===ye.length&&Pe()})})}function G(ye,Ce,ge,De){if(ge.seq!==Ce)return De();if(ge.winningRev===ye._rev)return De(ge,ye);var xe=ye._id+"::"+ge.winningRev,Ne=L.get(xe);Ne.onsuccess=function(Pe){De(ge,sn(Pe.target.result))}}function Q(ye,Ce,ge){if(s&&!s.has(ye._id))return ge();var De=g.get(ye._id);if(De)return G(ye,Ce,De,ge);y.get(ye._id).onsuccess=function(xe){De=It(xe.target.result),g.set(ye._id,De),G(ye,Ce,De,ge)}}function H(){e.complete(null,{results:w,last_seq:d})}function ee(){!e.continuous&&e.attachments?Nn(w).then(H):H()}var re=[nt,ut];e.attachments&&re.push(pt);var he=_t(r,re,"readonly");if(he.error)return e.complete(he.error);k=he.txn,k.onabort=bt(e.complete),k.oncomplete=ee,N=k.objectStore(ut),y=k.objectStore(nt),L=N.index("_doc_id_rev");var oe=e.since&&!e.descending?IDBKeyRange.lowerBound(e.since,!0):null;Ir(N,oe,e.descending,p,z)}var $t=new Map,Fn,$n=new Map;function kr(e,t){var n=this;Ma(function(r){Fa(n,e,r)},t,n.constructor)}function Fa(e,t,n){var r=t.name,i=null;e._meta=null;function s(y){var L=y.createObjectStore(nt,{keyPath:"id"});y.createObjectStore(ut,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),y.createObjectStore(pt,{keyPath:"digest"}),y.createObjectStore(ct,{keyPath:"id",autoIncrement:!1}),y.createObjectStore(kn),L.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),y.createObjectStore(wt,{keyPath:"_id"});var z=y.createObjectStore(Rt,{autoIncrement:!0});z.createIndex("seq","seq"),z.createIndex("digestSeq","digestSeq",{unique:!0})}function d(y,L){var z=y.objectStore(nt);z.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),z.openCursor().onsuccess=function(G){var Q=G.target.result;if(Q){var H=Q.value,ee=Ot(H);H.deletedOrLocal=ee?"1":"0",z.put(H),Q.continue()}else L()}}function p(y){y.createObjectStore(wt,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function w(y,L){var z=y.objectStore(wt),G=y.objectStore(nt),Q=y.objectStore(ut),H=G.openCursor();H.onsuccess=function(ee){var re=ee.target.result;if(re){var he=re.value,oe=he.id,ye=Pt(oe),Ce=Ct(he);if(ye){var ge=oe+"::"+Ce,De=oe+"::",xe=oe+"::~",Ne=Q.index("_doc_id_rev"),Pe=IDBKeyRange.bound(De,xe,!1,!1),Re=Ne.openCursor(Pe);Re.onsuccess=function(qe){if(Re=qe.target.result,!Re)G.delete(re.primaryKey),re.continue();else{var je=Re.value;je._doc_id_rev===ge&&z.put(je),Q.delete(Re.primaryKey),Re.continue()}}}else re.continue()}else L&&L()}}function F(y){var L=y.createObjectStore(Rt,{autoIncrement:!0});L.createIndex("seq","seq"),L.createIndex("digestSeq","digestSeq",{unique:!0})}function J(y,L){var z=y.objectStore(ut),G=y.objectStore(pt),Q=y.objectStore(Rt),H=G.count();H.onsuccess=function(ee){var re=ee.target.result;if(!re)return L();z.openCursor().onsuccess=function(he){var oe=he.target.result;if(!oe)return L();for(var ye=oe.value,Ce=oe.primaryKey,ge=Object.keys(ye._attachments||{}),De={},xe=0;xe<ge.length;xe++){var Ne=ye._attachments[ge[xe]];De[Ne.digest]=!0}var Pe=Object.keys(De);for(xe=0;xe<Pe.length;xe++){var Re=Pe[xe];Q.put({seq:Ce,digestSeq:Re+"::"+Ce})}oe.continue()}}}function g(y){function L(H){return H.data?It(H):(H.deleted=H.deletedOrLocal==="1",H)}var z=y.objectStore(ut),G=y.objectStore(nt),Q=G.openCursor();Q.onsuccess=function(H){var ee=H.target.result;if(!ee)return;var re=L(ee.value);re.winningRev=re.winningRev||Ct(re);function he(){var ye=re.id+"::",Ce=re.id+"::￿",ge=z.index("_doc_id_rev").openCursor(IDBKeyRange.bound(ye,Ce)),De=0;ge.onsuccess=function(xe){var Ne=xe.target.result;if(!Ne)return re.seq=De,oe();var Pe=Ne.primaryKey;Pe>De&&(De=Pe),Ne.continue()}}function oe(){var ye=xn(re,re.winningRev,re.deleted),Ce=G.put(ye);Ce.onsuccess=function(){ee.continue()}}if(re.seq)return oe();he()}}e._remote=!1,e.type=function(){return"idb"},e._id=o(function(y){y(null,e._meta.instanceId)}),e._bulkDocs=function(L,z,G){La(t,L,z,e,i,G)},e._get=function(L,z,G){var Q,H,ee,re=z.ctx;if(!re){var he=_t(i,[nt,ut,pt],"readonly");if(he.error)return G(he.error);re=he.txn}function oe(){G(ee,{doc:Q,metadata:H,ctx:re})}re.objectStore(nt).get(L).onsuccess=function(ye){if(H=It(ye.target.result),!H)return ee=E(dt,"missing"),oe();var Ce;if(z.rev)Ce=z.latest?Oi(z.rev,H):z.rev;else{Ce=H.winningRev;var ge=Ot(H);if(ge)return ee=E(dt,"deleted"),oe()}var De=re.objectStore(ut),xe=H.id+"::"+Ce;De.index("_doc_id_rev").get(xe).onsuccess=function(Ne){if(Q=Ne.target.result,Q&&(Q=sn(Q)),!Q)return ee=E(dt,"missing"),oe();oe()}}},e._getAttachment=function(y,L,z,G,Q){var H;if(G.ctx)H=G.ctx;else{var ee=_t(i,[nt,ut,pt],"readonly");if(ee.error)return Q(ee.error);H=ee.txn}var re=z.digest,he=z.content_type;H.objectStore(pt).get(re).onsuccess=function(oe){var ye=oe.target.result.body;qr(ye,he,G.binary,function(Ce){Q(null,Ce)})}},e._info=function(L){var z,G,Q=_t(i,[ct,ut],"readonly");if(Q.error)return L(Q.error);var H=Q.txn;H.objectStore(ct).get(ct).onsuccess=function(ee){G=ee.target.result.docCount},H.objectStore(ut).openCursor(null,"prev").onsuccess=function(ee){var re=ee.target.result;z=re?re.key:0},H.oncomplete=function(){L(null,{doc_count:G,update_seq:z,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(L,z){ka(L,i,z)},e._changes=function(L){return Ua(L,e,r,i)},e._close=function(y){i.close(),$t.delete(r),y()},e._getRevisionTree=function(y,L){var z=_t(i,[nt],"readonly");if(z.error)return L(z.error);var G=z.txn,Q=G.objectStore(nt).get(y);Q.onsuccess=function(H){var ee=It(H.target.result);ee?L(null,ee.rev_tree):L(E(dt))}},e._doCompaction=function(y,L,z){var G=[nt,ut,pt,Rt],Q=_t(i,G,"readwrite");if(Q.error)return z(Q.error);var H=Q.txn,ee=H.objectStore(nt);ee.get(y).onsuccess=function(re){var he=It(re.target.result);Dt(he.rev_tree,function(Ce,ge,De,xe,Ne){var Pe=ge+"-"+De;L.indexOf(Pe)!==-1&&(Ne.status="missing")}),Rr(L,y,H);var oe=he.winningRev,ye=he.deleted;H.objectStore(nt).put(xn(he,oe,ye))},H.onabort=bt(z),H.oncomplete=function(){z()}},e._getLocal=function(y,L){var z=_t(i,[wt],"readonly");if(z.error)return L(z.error);var G=z.txn,Q=G.objectStore(wt).get(y);Q.onerror=bt(L),Q.onsuccess=function(H){var ee=H.target.result;ee?(delete ee._doc_id_rev,L(null,ee)):L(E(dt))}},e._putLocal=function(y,L,z){typeof L=="function"&&(z=L,L={}),delete y._revisions;var G=y._rev,Q=y._id;G?y._rev="0-"+(parseInt(G.split("-")[1],10)+1):y._rev="0-1";var H=L.ctx,ee;if(!H){var re=_t(i,[wt],"readwrite");if(re.error)return z(re.error);H=re.txn,H.onerror=bt(z),H.oncomplete=function(){ee&&z(null,ee)}}var he=H.objectStore(wt),oe;G?(oe=he.get(Q),oe.onsuccess=function(ye){var Ce=ye.target.result;if(!Ce||Ce._rev!==G)z(E(St));else{var ge=he.put(y);ge.onsuccess=function(){ee={ok:!0,id:y._id,rev:y._rev},L.ctx&&z(null,ee)}}}):(oe=he.add(y),oe.onerror=function(ye){z(E(St)),ye.preventDefault(),ye.stopPropagation()},oe.onsuccess=function(){ee={ok:!0,id:y._id,rev:y._rev},L.ctx&&z(null,ee)})},e._removeLocal=function(y,L,z){typeof L=="function"&&(z=L,L={});var G=L.ctx;if(!G){var Q=_t(i,[wt],"readwrite");if(Q.error)return z(Q.error);G=Q.txn,G.oncomplete=function(){H&&z(null,H)}}var H,ee=y._id,re=G.objectStore(wt),he=re.get(ee);he.onerror=bt(z),he.onsuccess=function(oe){var ye=oe.target.result;!ye||ye._rev!==y._rev?z(E(dt)):(re.delete(ee),H={ok:!0,id:ee,rev:"0-0"},L.ctx&&z(null,H))}},e._destroy=function(y,L){Yt.removeAllListeners(r);var z=$n.get(r);z&&z.result&&(z.result.close(),$t.delete(r));var G=indexedDB.deleteDatabase(r);G.onsuccess=function(){$n.delete(r),ae()&&r in localStorage&&delete localStorage[r],L(null,{ok:!0})},G.onerror=bt(L)};var k=$t.get(r);if(k)return i=k.idb,e._meta=k.global,D(function(){n(null,e)});var N=indexedDB.open(r,Da);$n.set(r,N),N.onupgradeneeded=function(y){var L=y.target.result;if(y.oldVersion<1)return s(L);var z=y.currentTarget.transaction;y.oldVersion<3&&p(L),y.oldVersion<4&&F(L);var G=[d,w,J,g],Q=y.oldVersion;function H(){var ee=G[Q-1];Q++,ee&&ee(z,H)}H()},N.onsuccess=function(y){i=y.target.result,i.onversionchange=function(){i.close(),$t.delete(r)},i.onabort=function(he){Oe("error","Database has a global failure",he.target.error),i.close(),$t.delete(r)};var L=i.transaction([ct,kn,nt],"readwrite"),z=!1,G,Q,H;function ee(){typeof Q>"u"||!z||(e._meta={name:r,instanceId:H,blobSupport:Q},$t.set(r,{idb:i,global:e._meta}),n(null,e))}function re(){var he=r+"_id",oe=!1;he in G?H=G[he]:(G[he]=H=on(),oe=!0),"docCount"in G||(G.docCount=0,oe=!0),G.docCount,oe&&L.objectStore(ct).put(G)}L.objectStore(ct).get(ct).onsuccess=function(he){G=he.target.result||{id:ct},re()},Fn||(Fn=xa(L)),Fn.then(function(he){Q=he,ee()}),L.oncomplete=function(){z=!0,ee()},L.onabort=bt(n)},N.onerror=function(y){var L=y.target.error&&y.target.error.message;L?L.indexOf("stored database is a higher version")!==-1&&(L=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):L="Failed to open indexedDB, are you in private browsing mode?",Oe("error",L),n(E(c,L))}}kr.valid=function(){try{return typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}};function $a(e){e.adapter("idb",kr,!0)}function ja(e,t){return new Promise(function(n,r){var i=0,s=0,d=0,p=e.length,w;function F(){i++,e[s++]().then(g,k)}function J(){++d===p?w?r(w):n():N()}function g(){i--,J()}function k(y){i--,w=w||y,J()}function N(){for(;i<t&&s<p;)F()}N()})}var Ha=25,za=50,fn=5e3,Ka=1e4,jn={};function Hn(e){var t=e.doc||e.ok,n=t&&t._attachments;n&&Object.keys(n).forEach(function(r){var i=n[r];i.data=Sn(i.data,i.content_type)})}function Bt(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function xr(e){return!e._attachments||!Object.keys(e._attachments)?Promise.resolve():Promise.all(Object.keys(e._attachments).map(function(t){var n=e._attachments[t];if(n.data&&typeof n.data!="string")return new Promise(function(r){On(n.data,r)}).then(function(r){n.data=r})}))}function Ga(e){if(!e.prefix)return!1;var t=ar(e.prefix).protocol;return t==="http"||t==="https"}function Ja(e,t){if(Ga(t)){var n=t.name.substr(t.prefix.length),r=t.prefix.replace(/\/?$/,"/");e=r+encodeURIComponent(n)}var i=ar(e);(i.user||i.password)&&(i.auth={username:i.user,password:i.password});var s=i.path.replace(/(^\/|\/$)/g,"").split("/");return i.db=s.pop(),i.db.indexOf("%")===-1&&(i.db=encodeURIComponent(i.db)),i.path=s.join("/"),i}function rt(e,t){return cn(e,e.db+"/"+t)}function cn(e,t){var n=e.path?"/":"";return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+n+t}function ln(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}function Wa(e){var t=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",n=t.indexOf("msie")!==-1,r=t.indexOf("trident")!==-1,i=t.indexOf("edge")!==-1,s=!("method"in e)||e.method==="GET";return(n||r||i)&&s}function zn(e,t){var n=this,r=Ja(e.name,e),i=rt(r,"");e=l(e);var s=function(g,k){if(k=k||{},k.headers=k.headers||new Ut,e.auth||r.auth){var N=e.auth||r.auth,y=N.username+":"+N.password,L=Gt(unescape(encodeURIComponent(y)));k.headers.set("Authorization","Basic "+L)}var z=e.headers||{};Object.keys(z).forEach(function(Q){k.headers.append(Q,z[Q])}),Wa(k)&&(g+=(g.indexOf("?")===-1?"?":"&")+"_nonce="+Date.now());var G=e.fetch||mr;return G(g,k)};function d(g,k){return v(g,j(function(N){F().then(function(){return k.apply(this,N)}).catch(function(y){var L=N.pop();L(y)})})).bind(n)}function p(g,k,N){var y={};return k=k||{},k.headers=k.headers||new Ut,k.headers.get("Content-Type")||k.headers.set("Content-Type","application/json"),k.headers.get("Accept")||k.headers.set("Accept","application/json"),s(g,k).then(function(L){return y.ok=L.ok,y.status=L.status,L.json()}).then(function(L){if(y.data=L,!y.ok){y.data.status=y.status;var z=x(y.data);if(N)return N(z);throw z}if(Array.isArray(y.data)&&(y.data=y.data.map(function(G){return G.error||G.missing?x(G):G})),N)N(null,y.data);else return y})}var w;function F(){return e.skip_setup?Promise.resolve():w||(w=p(i).catch(function(g){return g&&g.status&&g.status===404?(ft(404,"PouchDB is just detecting if the remote exists."),p(i,{method:"PUT"})):Promise.reject(g)}).catch(function(g){return g&&g.status&&g.status===412?!0:Promise.reject(g)}),w.catch(function(){w=null}),w)}D(function(){t(null,n)}),n._remote=!0,n.type=function(){return"http"},n.id=d("id",function(g){s(cn(r,"")).then(function(k){return k.json()}).catch(function(){return{}}).then(function(k){var N=k&&k.uuid?k.uuid+r.db:rt(r,"");g(null,N)})}),n.compact=d("compact",function(g,k){typeof g=="function"&&(k=g,g={}),g=l(g),p(rt(r,"_compact"),{method:"POST"}).then(function(){function N(){n.info(function(y,L){L&&!L.compact_running?k(null,{ok:!0}):setTimeout(N,g.interval||200)})}N()})}),n.bulkGet=v("bulkGet",function(g,k){var N=this;function y(Q){var H={};g.revs&&(H.revs=!0),g.attachments&&(H.attachments=!0),g.latest&&(H.latest=!0),p(rt(r,"_bulk_get"+ln(H)),{method:"POST",body:JSON.stringify({docs:g.docs})}).then(function(ee){g.attachments&&g.binary&&ee.data.results.forEach(function(re){re.docs.forEach(Hn)}),Q(null,ee.data)}).catch(Q)}function L(){var Q=za,H=Math.ceil(g.docs.length/Q),ee=0,re=new Array(H);function he(Ce){return function(ge,De){re[Ce]=De.results,++ee===H&&k(null,{results:Ae(re)})}}for(var oe=0;oe<H;oe++){var ye=b(g,["revs","attachments","binary","latest"]);ye.docs=g.docs.slice(oe*Q,Math.min(g.docs.length,(oe+1)*Q)),te(N,ye,he(oe))}}var z=cn(r,""),G=jn[z];typeof G!="boolean"?y(function(Q,H){Q?(jn[z]=!1,ft(Q.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),L()):(jn[z]=!0,k(null,H))}):G?y(k):L()}),n._info=function(g){F().then(function(){return s(rt(r,""))}).then(function(k){return k.json()}).then(function(k){k.host=rt(r,""),g(null,k)}).catch(g)},n.fetch=function(g,k){return F().then(function(){var N=g.substring(0,1)==="/"?cn(r,g.substring(1)):rt(r,g);return s(N,k)})},n.get=d("get",function(g,k,N){typeof k=="function"&&(N=k,k={}),k=l(k);var y={};k.revs&&(y.revs=!0),k.revs_info&&(y.revs_info=!0),k.latest&&(y.latest=!0),k.open_revs&&(k.open_revs!=="all"&&(k.open_revs=JSON.stringify(k.open_revs)),y.open_revs=k.open_revs),k.rev&&(y.rev=k.rev),k.conflicts&&(y.conflicts=k.conflicts),k.update_seq&&(y.update_seq=k.update_seq),g=Bt(g);function L(Q){var H=Q._attachments,ee=H&&Object.keys(H);if(!H||!ee.length)return;function re(oe){var ye=H[oe],Ce=Bt(Q._id)+"/"+J(oe)+"?rev="+Q._rev;return s(rt(r,Ce)).then(function(ge){return"buffer"in ge?ge.buffer():ge.blob()}).then(function(ge){if(k.binary){var De=Object.getOwnPropertyDescriptor(ge.__proto__,"type");return(!De||De.set)&&(ge.type=ye.content_type),ge}return new Promise(function(xe){On(ge,xe)})}).then(function(ge){delete ye.stub,delete ye.length,ye.data=ge})}var he=ee.map(function(oe){return function(){return re(oe)}});return ja(he,5)}function z(Q){return Array.isArray(Q)?Promise.all(Q.map(function(H){if(H.ok)return L(H.ok)})):L(Q)}var G=rt(r,g+ln(y));p(G).then(function(Q){return Promise.resolve().then(function(){if(k.attachments)return z(Q.data)}).then(function(){N(null,Q.data)})}).catch(function(Q){Q.docId=g,N(Q)})}),n.remove=d("remove",function(g,k,N,y){var L;typeof k=="string"?(L={_id:g,_rev:k},typeof N=="function"&&(y=N,N={})):(L=g,typeof k=="function"?(y=k,N={}):(y=N,N=k));var z=L._rev||N.rev,G=rt(r,Bt(L._id))+"?rev="+z;p(G,{method:"DELETE"},y).catch(y)});function J(g){return g.split("/").map(encodeURIComponent).join("/")}n.getAttachment=d("getAttachment",function(g,k,N,y){typeof N=="function"&&(y=N,N={});var L=N.rev?"?rev="+N.rev:"",z=rt(r,Bt(g))+"/"+J(k)+L,G;s(z,{method:"GET"}).then(function(Q){if(G=Q.headers.get("content-type"),Q.ok)return typeof A<"u"&&!A.browser&&typeof Q.buffer=="function"?Q.buffer():Q.blob();throw Q}).then(function(Q){typeof A<"u"&&!A.browser&&(Q.type=G),y(null,Q)}).catch(function(Q){y(Q)})}),n.removeAttachment=d("removeAttachment",function(g,k,N,y){var L=rt(r,Bt(g)+"/"+J(k))+"?rev="+N;p(L,{method:"DELETE"},y).catch(y)}),n.putAttachment=d("putAttachment",function(g,k,N,y,L,z){typeof L=="function"&&(z=L,L=y,y=N,N=null);var G=Bt(g)+"/"+J(k),Q=rt(r,G);if(N&&(Q+="?rev="+N),typeof y=="string"){var H;try{H=wn(y)}catch{return z(E(nn,"Attachment is not a valid base64 string"))}y=H?An(H,L):""}p(Q,{headers:new Ut({"Content-Type":L}),method:"PUT",body:y},z).catch(z)}),n._bulkDocs=function(g,k,N){g.new_edits=k.new_edits,F().then(function(){return Promise.all(g.docs.map(xr))}).then(function(){return p(rt(r,"_bulk_docs"),{method:"POST",body:JSON.stringify(g)},N)}).catch(N)},n._put=function(g,k,N){F().then(function(){return xr(g)}).then(function(){return p(rt(r,Bt(g._id)),{method:"PUT",body:JSON.stringify(g)})}).then(function(y){N(null,y.data)}).catch(function(y){y.docId=g&&g._id,N(y)})},n.allDocs=d("allDocs",function(g,k){typeof g=="function"&&(k=g,g={}),g=l(g);var N={},y,L="GET";g.conflicts&&(N.conflicts=!0),g.update_seq&&(N.update_seq=!0),g.descending&&(N.descending=!0),g.include_docs&&(N.include_docs=!0),g.attachments&&(N.attachments=!0),g.key&&(N.key=JSON.stringify(g.key)),g.start_key&&(g.startkey=g.start_key),g.startkey&&(N.startkey=JSON.stringify(g.startkey)),g.end_key&&(g.endkey=g.end_key),g.endkey&&(N.endkey=JSON.stringify(g.endkey)),typeof g.inclusive_end<"u"&&(N.inclusive_end=!!g.inclusive_end),typeof g.limit<"u"&&(N.limit=g.limit),typeof g.skip<"u"&&(N.skip=g.skip);var z=ln(N);typeof g.keys<"u"&&(L="POST",y={keys:g.keys}),p(rt(r,"_all_docs"+z),{method:L,body:JSON.stringify(y)}).then(function(G){g.include_docs&&g.attachments&&g.binary&&G.data.rows.forEach(Hn),k(null,G.data)}).catch(k)}),n._changes=function(g){var k="batch_size"in g?g.batch_size:Ha;g=l(g),g.continuous&&!("heartbeat"in g)&&(g.heartbeat=Ka);var N="timeout"in g?g.timeout:30*1e3;"timeout"in g&&g.timeout&&N-g.timeout<fn&&(N=g.timeout+fn),"heartbeat"in g&&g.heartbeat&&N-g.heartbeat<fn&&(N=g.heartbeat+fn);var y={};"timeout"in g&&g.timeout&&(y.timeout=g.timeout);var L=typeof g.limit<"u"?g.limit:!1,z=L;if(g.style&&(y.style=g.style),(g.include_docs||g.filter&&typeof g.filter=="function")&&(y.include_docs=!0),g.attachments&&(y.attachments=!0),g.continuous&&(y.feed="longpoll"),g.seq_interval&&(y.seq_interval=g.seq_interval),g.conflicts&&(y.conflicts=!0),g.descending&&(y.descending=!0),g.update_seq&&(y.update_seq=!0),"heartbeat"in g&&g.heartbeat&&(y.heartbeat=g.heartbeat),g.filter&&typeof g.filter=="string"&&(y.filter=g.filter),g.view&&typeof g.view=="string"&&(y.filter="_view",y.view=g.view),g.query_params&&typeof g.query_params=="object")for(var G in g.query_params)g.query_params.hasOwnProperty(G)&&(y[G]=g.query_params[G]);var Q="GET",H;g.doc_ids?(y.filter="_doc_ids",Q="POST",H={doc_ids:g.doc_ids}):g.selector&&(y.filter="_selector",Q="POST",H={selector:g.selector});var ee=new Bi,re,he=function(Ce,ge){if(!g.aborted){y.since=Ce,typeof y.since=="object"&&(y.since=JSON.stringify(y.since)),g.descending?L&&(y.limit=z):y.limit=!L||z>k?k:z;var De=rt(r,"_changes"+ln(y)),xe={signal:ee.signal,method:Q,body:JSON.stringify(H)};re=Ce,!g.aborted&&F().then(function(){return p(De,xe,ge)}).catch(ge)}},oe={results:[]},ye=function(Ce,ge){if(!g.aborted){var De=0;if(ge&&ge.results){De=ge.results.length,oe.last_seq=ge.last_seq;var xe=null,Ne=null;typeof ge.pending=="number"&&(xe=ge.pending),(typeof oe.last_seq=="string"||typeof oe.last_seq=="number")&&(Ne=oe.last_seq);var Pe={};Pe.query=g.query_params,ge.results=ge.results.filter(function(qe){z--;var je=ue(g)(qe);return je&&(g.include_docs&&g.attachments&&g.binary&&Hn(qe),g.return_docs&&oe.results.push(qe),g.onChange(qe,xe,Ne)),je})}else if(Ce){g.aborted=!0,g.complete(Ce);return}ge&&ge.last_seq&&(re=ge.last_seq);var Re=L&&z<=0||ge&&De<k||g.descending;g.continuous&&!(L&&z<=0)||!Re?D(function(){he(re,ye)}):g.complete(null,oe)}};return he(g.since||0,ye),{cancel:function(){g.aborted=!0,ee.abort()}}},n.revsDiff=d("revsDiff",function(g,k,N){typeof k=="function"&&(N=k,k={}),p(rt(r,"_revs_diff"),{method:"POST",body:JSON.stringify(g)},N).catch(N)}),n._close=function(g){g()},n._destroy=function(g,k){p(rt(r,""),{method:"DELETE"}).then(function(N){k(null,N)}).catch(function(N){N.status===404?k(null,{ok:!0}):k(N)})}}zn.valid=function(){return!0};function Qa(e){e.adapter("http",zn,!1),e.adapter("https",zn,!1)}function kt(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,kt)}catch{}}ne(kt,Error);function dn(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,dn)}catch{}}ne(dn,Error);function hn(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,hn)}catch{}}ne(hn,Error);function Nr(e,t){return t&&e.then(function(n){D(function(){t(null,n)})},function(n){D(function(){t(n)})}),e}function Xa(e){return j(function(t){var n=t.pop(),r=e.apply(this,t);return typeof n=="function"&&Nr(r,n),r})}function Ya(e,t){return e.then(function(n){return t().then(function(){return n})},function(n){return t().then(function(){throw n})})}function Kn(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}}function Mr(e){var t=new Set(e),n=new Array(t.size),r=-1;return t.forEach(function(i){n[++r]=i}),n}function Gn(e){var t=new Array(e.size),n=-1;return e.forEach(function(r,i){t[++n]=i}),t}function Ur(e){var t="builtin "+e+" function requires map values to be numbers or number arrays";return new hn(t)}function Jn(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];if(typeof i!="number")if(Array.isArray(i)){t=typeof t=="number"?[t]:t;for(var s=0,d=i.length;s<d;s++){var p=i[s];if(typeof p!="number")throw Ur("_sum");typeof t[s]>"u"?t.push(p):t[s]+=p}}else throw Ur("_sum");else typeof t=="number"?t+=i:t[0]+=i}return t}var Za=Oe.bind(null,"log"),Va=Array.isArray,eo=JSON.parse;function Wn(e,t){return _n("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:Jn,log:Za,isArray:Va,toJSON:eo})}function Zt(){this.promise=new Promise(function(e){e()})}Zt.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},Zt.prototype.finish=function(){return this.promise};function Fr(e){if(!e)return"undefined";switch(typeof e){case"function":return e.toString();case"string":return e.toString();default:return JSON.stringify(e)}}function to(e,t){return Fr(e)+Fr(t)+"undefined"}function $r(e,t,n,r,i,s,d){var p=to(n,r),w;if(!s&&(w=e._cachedViews=e._cachedViews||{},w[p]))return w[p];var F=e.info().then(function(J){var g=J.db_name+"-mrview-"+(s?"temp":En(p));function k(N){N.views=N.views||{};var y=t;y.indexOf("/")===-1&&(y=t+"/"+t);var L=N.views[y]=N.views[y]||{};if(!L[g])return L[g]=!0,N}return an(e,"_local/"+d,k).then(function(){return e.registerDependentDatabase(g).then(function(N){return e.registerDependentDatabase(g+"_keys").then(function(y){var L=N.db;L.auto_compaction=!0,y.db.auto_compaction=!0;var z={name:g,db:L,keyDb:y.db,sourceDB:e,adapter:e.adapter,mapFun:n,indexCheckFun:i,reduceFun:r};return z.db.get("_local/lastSeq").catch(function(G){if(G.status!==404)throw G}).then(function(G){return z.seq=G?G.seq:0,w&&z.db.once("destroyed",function(){delete w[p]}),z})})})})});return w&&(w[p]=F),F}var jr={},Hr=new Zt,no=25;function Qn(e){return e.indexOf("/")===-1?[e,e]:e.split("/")}function zr(e){return e.length===1&&/^1-/.test(e[0].rev)}function Xn(e,t){try{e.emit("error",t)}catch{Oe("error",`The user's map/reduce function threw an uncaught error.
You can debug this error by doing:
myDatabase.on('error', function (err) { debugger; });
Please double-check your map/reduce function.`),Oe("error",t)}}function ro(e,t,n,r,i){i||(i=r,r=null);function s(B,U,I){try{return U(I)}catch(X){return Xn(B,X),""}}function d(B,U,I){try{U(I)}catch(X){Xn(B,X)}}function p(B,U,I,X,se){try{return{output:U(I,X,se)}}catch(ce){return Xn(B,ce),{error:ce}}}function w(B,U){var I=Ve(B.key,U.key);return I!==0?I:Ve(B.value,U.value)}function F(B,U,I){return I=I||0,typeof U=="number"?B.slice(I,U+I):I>0?B.slice(I):B}function J(B){var U=B.value,I=U&&typeof U=="object"&&U._id||B.id;return I}function g(B){B.rows.forEach(function(U){var I=U.doc&&U.doc._attachments;I&&Object.keys(I).forEach(function(X){var se=I[X];I[X].data=Sn(se.data,se.content_type)})})}function k(B){return function(U){return B.include_docs&&B.attachments&&B.binary&&g(U),U}}function N(B,U,I,X){var se=U[B];typeof se<"u"&&(X&&(se=encodeURIComponent(JSON.stringify(se))),I.push(B+"="+se))}function y(B){if(typeof B<"u"){var U=Number(B);return!isNaN(U)&&U===parseInt(B,10)?U:B}}function L(B){return B.group_level=y(B.group_level),B.limit=y(B.limit),B.skip=y(B.skip),B}function z(B){if(B){if(typeof B!="number")return new kt('Invalid value for integer: "'+B+'"');if(B<0)return new kt('Invalid value for positive integer: "'+B+'"')}}function G(B,U){var I=B.descending?"endkey":"startkey",X=B.descending?"startkey":"endkey";if(typeof B[I]<"u"&&typeof B[X]<"u"&&Ve(B[I],B[X])>0)throw new kt("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(U.reduce&&B.reduce!==!1){if(B.include_docs)throw new kt("{include_docs:true} is invalid for reduce");if(B.keys&&B.keys.length>1&&!B.group&&!B.group_level)throw new kt("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(se){var ce=z(B[se]);if(ce)throw ce})}function Q(B,U,I){var X=[],se,ce="GET",ve,fe;if(N("reduce",I,X),N("include_docs",I,X),N("attachments",I,X),N("limit",I,X),N("descending",I,X),N("group",I,X),N("group_level",I,X),N("skip",I,X),N("stale",I,X),N("conflicts",I,X),N("startkey",I,X,!0),N("start_key",I,X,!0),N("endkey",I,X,!0),N("end_key",I,X,!0),N("inclusive_end",I,X),N("key",I,X,!0),N("update_seq",I,X),X=X.join("&"),X=X===""?"":"?"+X,typeof I.keys<"u"){var pe=2e3,Ee="keys="+encodeURIComponent(JSON.stringify(I.keys));Ee.length+X.length+1<=pe?X+=(X[0]==="?"?"&":"?")+Ee:(ce="POST",typeof U=="string"?se={keys:I.keys}:U.keys=I.keys)}if(typeof U=="string"){var $e=Qn(U);return B.fetch("_design/"+$e[0]+"/_view/"+$e[1]+X,{headers:new Ut({"Content-Type":"application/json"}),method:ce,body:JSON.stringify(se)}).then(function(_e){return ve=_e.ok,fe=_e.status,_e.json()}).then(function(_e){if(!ve)throw _e.status=fe,x(_e);return _e.rows.forEach(function(Be){if(Be.value&&Be.value.error&&Be.value.error==="builtin_reduce_error")throw new Error(Be.reason)}),_e}).then(k(I))}return se=se||{},Object.keys(U).forEach(function(_e){Array.isArray(U[_e])?se[_e]=U[_e]:se[_e]=U[_e].toString()}),B.fetch("_temp_view"+X,{headers:new Ut({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(se)}).then(function(_e){return ve=_e.ok,fe=_e.status,_e.json()}).then(function(_e){if(!ve)throw _e.status=fe,x(_e);return _e}).then(k(I))}function H(B,U,I){return new Promise(function(X,se){B._query(U,I,function(ce,ve){if(ce)return se(ce);X(ve)})})}function ee(B){return new Promise(function(U,I){B._viewCleanup(function(X,se){if(X)return I(X);U(se)})})}function re(B){return function(U){if(U.status===404)return B;throw U}}function he(B,U,I){var X="_local/doc_"+B,se={_id:X,keys:[]};return zr(I)?Promise.resolve(se):U.db.get(X).catch(re(se))}function oe(B,U,I,X){var se="_local/doc_"+B,ce={_id:se,keys:[]},ve=I.get(B),fe=ve[0],pe=ve[1];function Ee(){return X[B]?Promise.resolve(X[B].metaDoc):zr(pe)?Promise.resolve(ce):U.db.get(se).catch(re(ce))}function $e(Be){return Be.keys.length?U.db.allDocs({keys:Be.keys,include_docs:!0}):Promise.resolve({rows:[]})}function _e(Be,Ke){for(var it=[],Qe=new Set,at=0,ot=Ke.rows.length;at<ot;at++){var lt=Ke.rows[at],Le=lt.doc;if(Le&&(it.push(Le),Qe.add(Le._id),Le._deleted=!fe.has(Le._id),!Le._deleted)){var Fe=fe.get(Le._id);"value"in Fe&&(Le.value=Fe.value),Le.key="a_"+Fe.key,Le.doc_id=Fe.id}}var Xe=Gn(fe);return Xe.forEach(function(Ye){if(!Qe.has(Ye)){var ht={_id:Ye},Ze=fe.get(Ye);"value"in Ze&&(ht.value=Ze.value),ht.key="a_"+Ze.key,ht.doc_id=Ze.id,it.push(ht)}}),Be.keys=Mr(Xe.concat(Be.keys)),it.push(Be),it}return Ee().then(function(Be){return $e(Be).then(function(Ke){return _e(Be,Ke)})})}function ye(B,U){var I=new Set;U.forEach(function(ce){ce.key&&I.add(ce.key)});var X={},se=Array.from(I).map(function(ce){return mt({key:ce})});return B.keyDb.allDocs({keys:se,include_docs:!0}).then(function(ce){ce.rows.forEach(function(ve){ve.doc&&ve.doc.key&&(X[ve.doc.key]=ve.doc)})}).then(function(){U.forEach(function(ve){if(!ve._id.startsWith("_local")&&ve.key){var fe=X[ve.key];fe||(X[ve.key]={_id:mt({key:ve.key}),key:ve.key,doc_ids:[]},fe=X[ve.key]);var pe=new Set(fe.doc_ids||[]);ve._deleted?pe.delete(ve._id):pe.add(ve._id),fe.doc_ids=Array.from(pe)}});var ce=[];return Object.keys(X).forEach(function(ve){ce.push(X[ve])}),B.keyDb.bulkDocs({docs:ce})})}function Ce(B,U,I,X){var se="_local/lastSeq";return B.db.get(se).catch(re({_id:se,seq:0})).then(function(ce){var ve=Gn(U);return Promise.all(ve.map(function(fe){return oe(fe,B,U,X)})).then(function(fe){var pe=Ae(fe);return ye(B,pe).then(function(){return I>=0&&(ce.seq=I,pe.push(ce)),B.db.bulkDocs({docs:pe})})})})}function ge(B){var U=typeof B=="string"?B:B.name,I=jr[U];return I||(I=jr[U]=new Zt),I}function De(B,U){return Kn(ge(B),function(){return xe(B,U)})()}function xe(B,U){var I,X;function se(Le,Fe){var Xe={id:X._id,key:qt(Le)};typeof Fe<"u"&&Fe!==null&&(Xe.value=qt(Fe)),I.push(Xe)}var ce=t(B.mapFun,se),ve=U.indexCheck;r&&(ve=r(B.indexCheckFun)||ve);var fe=U.since||B.seq||0,pe=fe,Ee=0,$e=0;function _e(Le,Fe,Xe){return function(){return Ce(B,Le,Fe,Xe)}}let Be=0,Ke={view:B.name,indexed_docs:Be};B.sourceDB.emit("indexing",Ke);var it=new Zt;function Qe(){var Le={return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:fe,limit:U.changes_batch_size};return U.doc_ids&&(Le.doc_ids=U.doc_ids),B.sourceDB.changes(Le).then(at)}function at(Le){var Fe=Le.results;if(U.showUpdateProgressInfo&&$e&&U.showUpdateProgressInfo(fe,Ee,fe-pe,$e),!!Fe.length){var Xe={};return Promise.all(Fe.map(function(Ye){var ht=Ye;if(ht.doc._id[0]!=="_"){var Ze=ht.doc._id;return he(Ze,B,ht.changes).then(function(yt){return Xe[Ze]={metaDoc:yt},yt})}})).then(function(Ye){var ht=ot(Fe,Xe);it.add(_e(ht,U.doc_ids?-1:fe,Xe)),Be=Be+Fe.length;let Ze={view:B.name,last_seq:Le.last_seq,results_count:Fe.length,indexed_docs:Be};if(B.sourceDB.emit("indexing",Ze),!(Fe.length<U.changes_batch_size))return Qe()})}}function ot(Le,Fe){for(var Xe=new Map,Ye=0,ht=Le.length;Ye<ht;Ye++){var Ze=Le[Ye];if(Ze.doc._id[0]!=="_"){if(I=[],X=Ze.doc,!X._deleted){if(ve){var yt=s(B.sourceDB,ve,X);yt=yt+"_xsj",yt=En(yt);var To=Fe[X._id].metaDoc.md5;if(yt===To){fe=Ze.seq;continue}Fe[X._id].metaDoc.md5=yt}d(B.sourceDB,ce,X)}I.sort(w);var Eo=lt(I);Xe.set(Ze.doc._id,[Eo,Ze.changes])}fe=Ze.seq}return Xe}function lt(Le){for(var Fe=new Map,Xe,Ye=0,ht=Le.length;Ye<ht;Ye++){var Ze=Le[Ye],yt=[Ze.key,Ze.id];Ye>0&&Ve(Ze.key,Xe)===0&&yt.push(Ye),Fe.set(mt(yt),Ze),Xe=Ze.key}return Fe}return B.sourceDB.info().then(function(Le){return Ee=Le.update_seq,$e=Ee-fe,Qe().then(function(){return it.finish()}).then(function(){U.showUpdateProgressInfo&&$e&&U.showUpdateProgressInfo(fe,Ee,fe-pe,$e),U.doc_ids||(B.seq=fe)})})}function Ne(B,U,I){I.group_level===0&&delete I.group_level;var X=I.group||I.group_level,se=I.reduceFun||n(B.reduceFun),ce=[],ve=isNaN(I.group_level)?Number.POSITIVE_INFINITY:I.group_level;U.forEach(function(_e){var Be=ce[ce.length-1],Ke=X?_e.key:null;if(X&&Array.isArray(Ke)&&(Ke=Ke.slice(0,ve)),Be&&Ve(Be.groupKey,Ke)===0){Be.keys.push([_e.key,_e.id]),Be.ids.push(_e.id),Be.values.push(_e.value);return}ce.push({keys:[[_e.key,_e.id]],ids:[_e.id],values:[_e.value],groupKey:Ke})}),U=[];for(var fe=0,pe=ce.length;fe<pe;fe++){var Ee=ce[fe],$e=p(B.sourceDB,se,Ee.keys,Ee.values,!1);if($e.error&&$e.error instanceof hn)throw $e.error;U.push({value:$e.error?null:$e.output,ids:Ee.ids,key:Ee.groupKey})}return{rows:F(U,I.limit,I.skip)}}function Pe(B,U){return Kn(ge(B),function(){return Re(B,U)})()}function Re(B,U){var I=0,X=B.reduceFun&&U.reduce!==!1,se=U.skip||0;typeof U.keys<"u"&&!U.keys.length&&(U.limit=0,delete U.keys);function ce(Qe){Qe.include_docs=!0;var at=Qe.keys.map(function(lt){return mt({key:"a_"+lt})}),ot=[];return B.keyDb.allDocs({keys:at,include_docs:!0}).then(function(lt){lt.rows.forEach(function(Le){Le.doc&&Le.doc.doc_ids&&Le.doc.doc_ids.forEach(function(Fe){ot.push(Fe)})})}).then(function(){return ot.length==0?[]:(Qe.keys=ot,B.db.allDocs(Qe).then(function(lt){return I=lt.total_rows,lt.rows.map(function(Le){if("value"in Le.doc&&typeof Le.doc.value=="object"&&Le.doc.value!==null){var Fe=Object.keys(Le.doc.value).sort(),Xe=["id","key","value"];if(!(Fe<Xe||Fe>Xe))return Le.doc.value}var Ye=Sr(Le.doc._id);return{key:Ye[0],id:Ye[1],value:"value"in Le.doc?Le.doc.value:null}})}))})}function ve(Qe){return Qe.include_docs=!0,B.db.allDocs(Qe).then(function(at){return I=at.total_rows,at.rows.map(function(ot){if("value"in ot.doc&&typeof ot.doc.value=="object"&&ot.doc.value!==null){var lt=Object.keys(ot.doc.value).sort(),Le=["id","key","value"];if(!(lt<Le||lt>Le))return ot.doc.value}var Fe=Sr(ot.doc._id);return{key:Fe[0],id:Fe[1],value:"value"in ot.doc?ot.doc.value:null}})})}function fe(Qe){var at;if(X?at=Ne(B,Qe,U):at={total_rows:I,offset:se,rows:Qe},U.update_seq&&(at.update_seq=B.seq),U.include_docs){var ot=Mr(Qe.map(J));return ot.length?B.sourceDB.allDocs({keys:ot,include_docs:!0,conflicts:U.conflicts,attachments:U.attachments,binary:U.binary}).then(function(lt){var Le=new Map;return lt.rows.forEach(function(Fe){Le.set(Fe.id,Fe.doc)}),Qe.forEach(function(Fe){var Xe=J(Fe),Ye=Le.get(Xe);Ye&&(Fe.doc=Ye)}),at}):at}else return at}if(typeof U.keys<"u"){var pe=U.keys,Ee={keys:pe};return U.update_seq&&(Ee.update_seq=!0),ce(Ee).then(Ae).then(fe)}else{var Ee={descending:U.descending};U.update_seq&&(Ee.update_seq=!0);var $e,_e;if("start_key"in U&&($e=U.start_key),"startkey"in U&&($e=U.startkey),"end_key"in U&&(_e=U.end_key),"endkey"in U&&(_e=U.endkey),typeof $e<"u"&&(Ee.startkey=U.descending?mt([$e,{}]):mt([$e])),typeof _e<"u"){var Be=U.inclusive_end!==!1;U.descending&&(Be=!Be),Ee.endkey=mt(Be?[_e,{}]:[_e])}if(typeof U.key<"u"){var Ke=mt([U.key]),it=mt([U.key,{}]);Ee.descending?(Ee.endkey=Ke,Ee.startkey=it):(Ee.startkey=Ke,Ee.endkey=it)}return X||(typeof U.limit=="number"&&(Ee.limit=U.limit),Ee.skip=se),ve(Ee).then(fe)}}function qe(B){return B.fetch("_view_cleanup",{headers:new Ut({"Content-Type":"application/json"}),method:"POST"}).then(function(U){return U.json()})}function je(B){return B.get("_local/"+e).then(function(U){var I=new Map;Object.keys(U.views).forEach(function(se){var ce=Qn(se),ve="_design/"+ce[0],fe=ce[1],pe=I.get(ve);pe||(pe=new Set,I.set(ve,pe)),pe.add(fe)});var X={keys:Gn(I),include_docs:!0};return B.allDocs(X).then(function(se){var ce={};se.rows.forEach(function(pe){var Ee=pe.key.substring(8);I.get(pe.key).forEach(function($e){var _e=Ee+"/"+$e;U.views[_e]||(_e=$e);var Be=Object.keys(U.views[_e]),Ke=pe.doc&&pe.doc.views&&pe.doc.views[$e];Be.forEach(function(it){ce[it]=ce[it]||Ke})})});var ve=Object.keys(ce).filter(function(pe){return!ce[pe]}),fe=ve.map(function(pe){return Kn(ge(pe),function(){return Promise.all([new B.constructor(pe,B.__opts).destroy(),new B.constructor(pe+"_keys",B.__opts).destroy()])})()});return Promise.all(fe).then(function(){return{ok:!0}})})},re({ok:!0}))}function We(B,U,I){if(typeof B._query=="function")return H(B,U,I);if(Ge(B))return Q(B,U,I);var X={};if(Object.assign(X,I,{changes_batch_size:B.__opts.view_update_changes_batch_size||no}),typeof U!="string")return G(I,U),Hr.add(function(){var pe=$r(B,"temp_view/temp_view",U.map,U.reduce,U.indexCheck,!0,e);return pe.then(function(Ee){return Ya(De(Ee,X).then(function(){return Pe(Ee,I)}),function(){return Promise.all([Ee.keyDb.destroy(),Ee.db.destroy()])})})}),Hr.finish();var se=U,ce=Qn(se),ve=ce[0],fe=ce[1];return B.get("_design/"+ve).then(function(pe){var Ee=pe.views&&pe.views[fe];if(!Ee)throw new dn("ddoc "+pe._id+" has no view named "+fe);i(pe,fe),G(I,Ee);var $e=$r(B,se,Ee.map,Ee.reduce,Ee.indexCheck,!1,e);return $e.then(function(_e){return I.info?{name:_e.name,seq:_e.seq}:I.destroy?Promise.all([_e.keyDb.destroy(),_e.db.destroy()]):I.stale==="ok"||I.stale==="update_after"?(I.stale==="update_after"&&D(function(){De(_e,X)}),Pe(_e,I)):(I.beforeUpdateView&&I.beforeUpdateView(),De(_e,X).then(function(){return I.afterUpdateView&&I.afterUpdateView(),Pe(_e,I)}))})})}function et(B,U,I){var X=this;typeof U=="function"&&(I=U,U={}),U=U?L(U):{},typeof B=="function"&&(B={map:B});var se=Promise.resolve().then(function(){return We(X,B,U)});return Nr(se,I),se}var st=Xa(function(){var B=this;return typeof B._viewCleanup=="function"?ee(B):Ge(B)?qe(B):je(B)});return{query:et,viewCleanup:st}}var Yn={_sum:function(e,t){return Jn(t)},_count:function(e,t){return t.length},_stats:function(e,t){function n(r){for(var i=0,s=0,d=r.length;s<d;s++){var p=r[s];i+=p*p}return i}return{sum:Jn(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:n(t)}}};function io(e){if(/^_sum/.test(e))return Yn._sum;if(/^_count/.test(e))return Yn._count;if(/^_stats/.test(e))return Yn._stats;if(/^_/.test(e))throw new Error(e+" is not a supported reduce function.")}function ao(e,t){if(typeof e=="function"&&e.length===2){var n=e;return function(r){return n(r,t)}}else return Wn(e.toString(),t)}function oo(e){return e?typeof e=="function"?e:Wn(e):null}function uo(e){var t=e.toString(),n=io(t);return n||Wn(t)}function so(e,t){var n=e.views&&e.views[t];if(typeof n.map!="string")throw new dn("ddoc "+e._id+" has no string view named "+t+", instead found object of type: "+typeof n.map)}var fo="mrviews",Kr=ro(fo,ao,uo,oo,so);function co(e,t,n){return Kr.query.call(this,e,t,n)}function lo(e){return Kr.viewCleanup.call(this,e)}var ho={query:co,viewCleanup:lo};function Gr(e){return/^1-/.test(e)}function vo(e,t,n){return!e._attachments||!e._attachments[n]||e._attachments[n].digest!==t._attachments[n].digest}function Ho(e){try{e=JSON.stringify(e)}catch{e=e+""}return e}function Jr(e,t){var n=Object.keys(t._attachments);return Promise.all(n.map(function(r){return e.getAttachment(t._id,r,{rev:t._rev,attachments:!0,binary:!1}).catch(function(i){return Promise.resolve("")})}))}function go(e,t,n){var r=Ge(t)&&!Ge(e),i=Object.keys(n._attachments);return r?e.get(n._id).then(function(s){return Promise.all(i.map(function(d){return vo(s,n,d)?t.getAttachment(n._id,d):e.getAttachment(s._id,d)}))}).catch(function(s){if(s.status!==404)throw s;return Jr(t,n)}):Jr(t,n)}function mo(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n].missing;r.forEach(function(i){t.push({id:n,rev:i})})}),{docs:t,revs:!0,latest:!0}}function po(e,t,n,r){n=l(n);var i=[],s=!0;function d(){var k=mo(n);if(k.docs.length)return e.bulkGet(k).then(function(N){if(r.cancelled)throw new Error("cancelled");return Promise.all(N.results.map(function(y){return Promise.all(y.docs.map(function(L){var z=L.ok;return L.error&&(s=!1),!z||!z._attachments?z:go(t,e,z).then(function(G){var Q=Object.keys(z._attachments),H=!1;return G.forEach(function(ee,re){var he=z._attachments[Q[re]];delete he.stub,delete he.length,he.data=ee,ee||(H=!0)}),H&&r.emit("denied",z),z})}))})).then(function(y){i=i.concat(Ae(y).filter(Boolean))}).catch(function(y){throw r.emit("error",y),y})})}function p(k){return k._attachments&&Object.keys(k._attachments).length>0}function w(k){return k._conflicts&&k._conflicts.length>0}function F(k){return e.allDocs({keys:k,include_docs:!0,conflicts:!0}).then(function(N){if(r.cancelled)throw new Error("cancelled");N.rows.forEach(function(y){y.deleted||!y.doc||!Gr(y.value.rev)||p(y.doc)||w(y.doc)||(y.doc._conflicts&&delete y.doc._conflicts,i.push(y.doc),delete n[y.id])})})}function J(){var k=Object.keys(n).filter(function(N){var y=n[N].missing;return y.length===1&&Gr(y[0])});if(k.length>0)return F(k)}function g(){return{ok:s,docs:i}}return Promise.resolve().then(J).then(d).then(g)}var Wr=1,Qr="pouchdb",yo=5,At=0;function Zn(e,t,n,r,i){return e.get(t).catch(function(s){if(s.status===404)return(e.adapter==="http"||e.adapter==="https")&&ft(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:t,history:[],replicator:Qr,version:Wr};throw s}).then(function(s){if(!i.cancelled&&s.last_seq!==n)return s.history=(s.history||[]).filter(function(d){return d.session_id!==r}),s.history.unshift({last_seq:n,session_id:r}),s.history=s.history.slice(0,yo),s.version=Wr,s.replicator=Qr,s.session_id=r,s.last_seq=n,e.put(s).catch(function(d){if(d.status===409)return Zn(e,t,n,r,i);throw d})})}function Vt(e,t,n,r,i){this.src=e,this.target=t,this.id=n,this.returnValue=r,this.opts=i||{}}Vt.prototype.writeCheckpoint=function(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})},Vt.prototype.updateTarget=function(e,t){return this.opts.writeTargetCheckpoint?Zn(this.target,this.id,e,t,this.returnValue):Promise.resolve(!0)},Vt.prototype.updateSource=function(e,t){if(this.opts.writeSourceCheckpoint){var n=this;return Zn(this.src,this.id,e,t,this.returnValue).catch(function(r){if(Zr(r))return n.opts.writeSourceCheckpoint=!1,!0;throw r})}else return Promise.resolve(!0)};var Xr={undefined:function(e,t){return Ve(e.last_seq,t.last_seq)===0?t.last_seq:0},1:function(e,t){return _o(t,e).last_seq}};Vt.prototype.getCheckpoint=function(){var e=this;return e.opts&&e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?e.src.get(e.id).then(function(t){return t.last_seq||At}).catch(function(t){if(t.status!==404)throw t;return At}):e.target.get(e.id).then(function(t){return e.opts&&e.opts.writeTargetCheckpoint&&!e.opts.writeSourceCheckpoint?t.last_seq||At:e.src.get(e.id).then(function(n){if(t.version!==n.version)return At;var r;return t.version?r=t.version.toString():r="undefined",r in Xr?Xr[r](t,n):At},function(n){if(n.status===404&&t.last_seq)return e.src.put({_id:e.id,last_seq:At}).then(function(){return At},function(r){return Zr(r)?(e.opts.writeSourceCheckpoint=!1,t.last_seq):At});throw n})}).catch(function(t){if(t.status!==404)throw t;return At})};function _o(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:Yr(e.history,t.history)}function Yr(e,t){var n=e[0],r=e.slice(1),i=t[0],s=t.slice(1);if(!n||t.length===0)return{last_seq:At,history:[]};var d=n.session_id;if(Vn(d,t))return{last_seq:n.last_seq,history:e};var p=i.session_id;return Vn(p,r)?{last_seq:i.last_seq,history:s}:Yr(r,s)}function Vn(e,t){var n=t[0],r=t.slice(1);return!e||t.length===0?!1:e===n.session_id?!0:Vn(e,r)}function Zr(e){return typeof e.status=="number"&&Math.floor(e.status/100)===4}var Vr=0;function wo(e,t,n,r){if(e.retry===!1){t.emit("error",n),t.removeAllListeners();return}if(typeof e.back_off_function!="function"&&(e.back_off_function=He),t.emit("requestError",n),t.state==="active"||t.state==="pending"){t.emit("paused",n),t.state="stopped";var i=function(){e.current_back_off=Vr},s=function(){t.removeListener("active",i)};t.once("paused",s),t.once("active",i)}e.current_back_off=e.current_back_off||Vr,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(r,e.current_back_off)}function bo(e){return Object.keys(e).sort(Ve).reduce(function(t,n){return t[n]=e[n],t},{})}function Ao(e,t,n){var r=n.doc_ids?n.doc_ids.sort(Ve):"",i=n.filter?n.filter.toString():"",s="",d="",p="";return n.selector&&(p=JSON.stringify(n.selector)),n.filter&&n.query_params&&(s=JSON.stringify(bo(n.query_params))),n.filter&&n.filter==="_view"&&(d=n.view.toString()),Promise.all([e.id(),t.id()]).then(function(w){var F=w[0]+w[1]+i+d+s+r+p;return new Promise(function(J){Tn(F,J)})}).then(function(w){return w=w.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+w})}function ei(e,t,n,r,i){var s=[],d,p={seq:0,changes:[],docs:[]},w=!1,F=!1,J=!1,g=0,k=n.continuous||n.live||!1,N=n.batch_size||100,y=n.batches_limit||10,L=n.style||"all_docs",z=!1,G=n.doc_ids,Q=n.selector,H,ee,re=[],he=on();i=i||{ok:!0,start_time:new Date().toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var oe={};r.ready(e,t);function ye(){return ee?Promise.resolve():Ao(e,t,n).then(function(I){H=I;var X={};n.checkpoint===!1?X={writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:n.checkpoint==="source"?X={writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:n.checkpoint==="target"?X={writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:X={writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},ee=new Vt(e,t,H,r,X)})}function Ce(){if(re=[],d.docs.length!==0){var I=d.docs,X={timeout:n.timeout};return t.bulkDocs({docs:I,new_edits:!1},X).then(function(se){if(r.cancelled)throw qe(),new Error("cancelled");var ce=Object.create(null);se.forEach(function(fe){fe.error&&(ce[fe.id]=fe)});var ve=Object.keys(ce).length;i.doc_write_failures+=ve,i.docs_written+=I.length-ve,I.forEach(function(fe){var pe=ce[fe._id];if(pe){i.errors.push(pe);var Ee=(pe.name||"").toLowerCase();if(Ee==="unauthorized"||Ee==="forbidden")r.emit("denied",l(pe));else throw pe}else re.push(fe)})},function(se){throw i.doc_write_failures+=I.length,se})}}function ge(){if(d.error)throw new Error("There was a problem getting docs.");i.last_seq=g=d.seq;var I=l(i);return re.length&&(I.docs=re,typeof d.pending=="number"&&(I.pending=d.pending,delete d.pending),(n.since==="now"||n._xsj_since==="now")&&(n._xsj_since="now",n.since=i.last_seq),r.emit("change",I)),w=!0,ee.writeCheckpoint(d.seq,he).then(function(){if(r.emit("checkpoint",{checkpoint:d.seq}),w=!1,r.cancelled)throw qe(),new Error("cancelled");d=void 0,st()}).catch(function(X){throw U(X),X})}function De(){var I={};return d.changes.forEach(function(X){r.emit("checkpoint",{revs_diff:X}),X.id!=="_user/"&&(I[X.id]=X.changes.map(function(se){return se.rev}))}),t.revsDiff(I).then(function(X){if(r.cancelled)throw qe(),new Error("cancelled");d.diffs=X})}function xe(){return po(e,t,d.diffs,r).then(function(I){d.error=!I.ok,I.docs.forEach(function(X){delete d.diffs[X._id],i.docs_read++,d.docs.push(X)})})}function Ne(){if(!(r.cancelled||d)){if(s.length===0){Pe(!0);return}d=s.shift(),r.emit("checkpoint",{start_next_batch:d.seq}),De().then(xe).then(Ce).then(ge).then(Ne).catch(function(I){Re("batch processing terminated with error",I)})}}function Pe(I){if(p.changes.length===0){s.length===0&&!d&&((k&&oe.live||F)&&(r.state="pending",r.emit("paused")),F&&qe());return}(I||F||p.changes.length>=N)&&(s.push(p),p={seq:0,changes:[],docs:[]},(r.state==="pending"||r.state==="stopped")&&(r.state="active",r.emit("active")),Ne())}function Re(I,X){J||(X.message||(X.message=I),i.ok=!1,i.status="aborting",s=[],p={seq:0,changes:[],docs:[]},qe(X))}function qe(I){if(!J&&!(r.cancelled&&(i.status="cancelled",w)))if(i.status=i.status||"complete",i.end_time=new Date().toISOString(),i.last_seq=g,J=!0,I){I=E(I),I.result=i;var X=(I.name||"").toLowerCase();X==="unauthorized"||X==="forbidden"?(r.emit("error",I),r.removeAllListeners()):wo(n,r,I,function(){ei(e,t,n,r)})}else r.emit("complete",i),r.removeAllListeners()}function je(I,X,se){if(r.cancelled)return qe();typeof X=="number"&&(p.pending=X);var ce=ue(n)(I);ce&&(p.seq=I.seq||se,p.changes.push(I),r.emit("checkpoint",{pending_batch:p.seq}),D(function(){Pe(s.length===0&&oe.live)}))}function We(I){if(z=!1,r.cancelled)return qe();if(I.results.length>0)oe.since=I.results[I.results.length-1].seq,st(),Pe(!0);else{var X=function(){k?(oe.live=!0,st()):F=!0,Pe(!0)};!d&&I.results.length===0?(w=!0,ee.writeCheckpoint(I.last_seq,he).then(function(){w=!1,i.last_seq=g=I.last_seq,X()}).catch(U)):X()}}function et(I){if(z=!1,r.cancelled)return qe();Re("changes rejected",I)}function st(){if(!(!z&&!F&&s.length<y))return;z=!0;function I(){se.cancel()}function X(){r.removeListener("cancel",I)}r._changes&&(r.removeListener("cancel",r._abortChanges),r._changes.cancel()),r.once("cancel",I);var se=e.changes(oe).on("change",je);se.then(X,X),se.then(We).catch(et),n.retry&&(r._changes=se,r._abortChanges=I)}function B(){ye().then(function(){if(r.cancelled){qe();return}return ee.getCheckpoint().then(function(I){g=I,oe={since:g,limit:N,batch_size:N,style:L,doc_ids:G,selector:Q,return_docs:!0},n.filter&&(typeof n.filter!="string"?oe.include_docs=!0:oe.filter=n.filter),"heartbeat"in n&&(oe.heartbeat=n.heartbeat),"timeout"in n&&(oe.timeout=n.timeout),n.query_params&&(oe.query_params=n.query_params),n.view&&(oe.view=n.view),st()})}).catch(function(I){Re("getCheckpoint rejected with ",I)})}function U(I){w=!1,Re("writeCheckpoint completed with error",I)}if(r.cancelled){qe();return}r._addedListeners||(r.once("cancel",qe),typeof n.complete=="function"&&(r.once("error",n.complete),r.once("complete",function(I){n.complete(null,I)})),r._addedListeners=!0),typeof n.since>"u"?B():ye().then(function(){return w=!0,ee.writeCheckpoint(n.since,he)}).then(function(){if(w=!1,r.cancelled){qe();return}g=n.since,B()}).catch(U)}ne(vn,Z);function vn(){Z.call(this),this.cancelled=!1,this.state="pending";var e=this,t=new Promise(function(n,r){e.once("complete",n),e.once("error",r)});e.then=function(n,r){return t.then(n,r)},e.catch=function(n){return t.catch(n)},e.catch(function(){})}vn.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},vn.prototype.ready=function(e,t){var n=this;if(n._readyCalled)return;n._readyCalled=!0;function r(){n.cancel()}e.once("destroyed",r),t.once("destroyed",r);function i(){e.removeListener("destroyed",r),t.removeListener("destroyed",r)}n.once("complete",i),n.once("error",i)};function gn(e,t){var n=t.PouchConstructor;return typeof e=="string"?new n(e,t):e}function er(e,t,n,r){if(typeof n=="function"&&(r=n,n={}),typeof n>"u"&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw E(Et,"`doc_ids` filter parameter is not a list.");n.complete=r,n=l(n),n.continuous=n.continuous||n.live,n.retry="retry"in n?n.retry:!1,n.PouchConstructor=n.PouchConstructor||this;var i=new vn,s=gn(e,n),d=gn(t,n);return ei(s,d,n,i),i}ne(tr,Z);function So(e,t,n,r){return typeof n=="function"&&(r=n,n={}),typeof n>"u"&&(n={}),n=l(n),n.PouchConstructor=n.PouchConstructor||this,e=gn(e,n),t=gn(t,n),new tr(e,t,n,r)}function tr(e,t,n,r){var i=this;this.canceled=!1;var s=n.push?Object.assign({},n,n.push):n,d=n.pull?Object.assign({},n,n.pull):n;this.push=er(e,t,s),this.pull=er(t,e,d),this.pushPaused=!0,this.pullPaused=!0;function p(H){i.emit("change",{direction:"pull",change:H})}function w(H){i.emit("change",{direction:"push",change:H})}function F(H){i.emit("denied",{direction:"push",doc:H})}function J(H){i.emit("denied",{direction:"pull",doc:H})}function g(){i.pushPaused=!0,i.pullPaused&&i.emit("paused")}function k(){i.pullPaused=!0,i.pushPaused&&i.emit("paused")}function N(){i.pushPaused=!1,i.pullPaused&&i.emit("active",{direction:"push"})}function y(){i.pullPaused=!1,i.pushPaused&&i.emit("active",{direction:"pull"})}var L={};function z(H){return function(ee,re){var he=ee==="change"&&(re===p||re===w),oe=ee==="denied"&&(re===J||re===F),ye=ee==="paused"&&(re===k||re===g),Ce=ee==="active"&&(re===y||re===N);(he||oe||ye||Ce)&&(ee in L||(L[ee]={}),L[ee][H]=!0,Object.keys(L[ee]).length===2&&i.removeAllListeners(ee))}}n.live&&(this.push.on("complete",i.pull.cancel.bind(i.pull)),this.pull.on("complete",i.push.cancel.bind(i.push)));function G(H,ee,re){H.listeners(ee).indexOf(re)==-1&&H.on(ee,re)}this.on("newListener",function(H){H==="change"?(G(i.pull,"change",p),G(i.push,"change",w)):H==="denied"?(G(i.pull,"denied",J),G(i.push,"denied",F)):H==="active"?(G(i.pull,"active",y),G(i.push,"active",N)):H==="paused"&&(G(i.pull,"paused",k),G(i.push,"paused",g))}),this.on("removeListener",function(H){H==="change"?(i.pull.removeListener("change",p),i.push.removeListener("change",w)):H==="denied"?(i.pull.removeListener("denied",J),i.push.removeListener("denied",F)):H==="active"?(i.pull.removeListener("active",y),i.push.removeListener("active",N)):H==="paused"&&(i.pull.removeListener("paused",k),i.push.removeListener("paused",g))}),this.pull.on("removeListener",z("pull")),this.push.on("removeListener",z("push"));var Q=Promise.all([this.push,this.pull]).then(function(H){var ee={push:H[0],pull:H[1]};return i.emit("complete",ee),r&&r(null,ee),i.removeAllListeners(),ee},function(H){if(i.cancel(),r?r(H):i.emit("error",H),i.removeAllListeners(),r)throw H});this.then=function(H,ee){return Q.then(H,ee)},this.catch=function(H){return Q.catch(H)}}tr.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())};function Oo(e){e.replicate=er,e.sync=So,Object.defineProperty(e.prototype,"replicate",{get:function(){var t=this;return typeof this.replicateMethods>"u"&&(this.replicateMethods={from:function(n,r,i){return t.constructor.replicate(n,t,r,i)},to:function(n,r,i){return t.constructor.replicate(t,n,r,i)}}),this.replicateMethods}}),e.prototype.sync=function(t,n,r){return this.constructor.sync(this,t,n,r)}}ke.plugin($a).plugin(Qa).plugin(ho).plugin(Oo),T.exports=ke}).call(this)}).call(this,C(11))},{1:1,10:10,11:11,12:12,13:13,28:28,3:3,4:4}]},{},[29])(29)});const ko="friendly-data",xo={revs_limit:50,adapter:"idb"},Tt=new PouchDB(ko,xo),nr=async(C,T,m={})=>{const A=zt();let P={};try{P=await Tt.get(C)}catch{}const D={createDate:A,...P,updateDate:A,...T,_id:C},K=D.fileInfos||{},R=[];Object.values(m).forEach(j=>{K[j.filename]={src:j.src,size:j.blob.size,type:j.blob.type},R.push({_id:C+"__"+j.filename,docId:C,filename:j.filename,type:"attachment",createDate:A,updateDate:A,_attachments:{attachment:{content_type:j.blob.type,data:j.blob}}})}),D.fileInfos=K;const M=await Tt.put(D);if(R.length>0){const j=await Tt.allDocs({keys:R.map(Z=>Z._id)}),ne={};j.rows.forEach(Z=>{Z.value&&(ne[Z.id]=Z.value.rev)}),R.forEach(Z=>{const Y=ne[Z._id];Y&&(Z._rev=Y)}),await Tt.bulkDocs(R)}return D._rev=M.rev,D},No=async(C,T)=>{try{return await Tt.get(C,{attachments:!1,binary:!0})}catch{}return null},Mo=async(C,T)=>{try{return await Tt.get(C+"__"+T,{attachments:!0,binary:!0})}catch{}return null},Uo=async(C=[])=>{const m=(await Tt.allDocs()).rows.map(A=>({_id:A.id,_rev:A.value.rev,_deleted:!0})).filter(A=>!C.find(P=>A._id.startsWith(P)));await Tt.bulkDocs(m),await Tt.compact()},Fo=50,$o=async C=>{let T=[];const m="fileIds";try{T=JSON.parse(localStorage.getItem(m))}catch{}T.push(C),T.length>Fo&&(T=T.slice(T.length-10),await Uo(T)),localStorage.setItem(m,JSON.stringify(T))};(async function(){var be;const C="xsjHeaderOutline",T=window.matchMedia("(prefers-color-scheme: dark)").matches;window.matchMedia("(max-width: 1023.5px)").matches;const m="textarea#open-source-plugins",A={};let P="";const D=`
  ::root{
      --scrollbarColor: transparent;
  }

  html:hover{
      --scrollbarColor: rgba(0,0,0,0.3);
  }

  ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
  }
  ::-webkit-scrollbar-track-piece {

  }
  ::-webkit-scrollbar-thumb:vertical {
      height: 5px;
      background-color: var(--scrollbarColor);
      -webkit-border-radius: 6px;
  }
  ::-webkit-scrollbar-thumb:horizontal {
      width: 5px;
      background-color: var(--scrollbarColor);
      -webkit-border-radius: 6px;
  }

  ::-webkit-scrollbar-thumb:hover{
      background-color: rgba(0,0,0,.7);
  }
  body {
    padding-top: 10px;
    padding-bottom: 50VH;
  }
  @media print{
    body {
      padding-top: initial;
      padding-bottom: initial;
    }
  }
  `,K=async(q,W)=>{const l="images/"+zt()+q.filename(),h=q.blob(),o={};o[l]={src:"",filename:l,blob:h},await nr(P,{},o);const f=window.URL.createObjectURL(h);return A[f]={fileId:P,filename:l},f};let R=null;const M=async(q={})=>{const l=(await tinymce.init({promotion:!1,branding:!1,resize:!1,help_accessibility:!1,selector:m,formats:{forecolor:{inline:"span",classes:"forecolor",styles:{color:"%value"}},hilitecolor:{inline:"span",classes:"hilitecolor",styles:{backgroundColor:"%value"}}},color_default_background:"#BA372A",color_default_foreground:"#169179",plugins:"importcss searchreplace autolink autosave save directionality code visualblocks visualchars image link media codesample table charmap pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help charmap quickbars emoticons accordion",editimage_cors_hosts:["picsum.photos"],menubar:"file edit view insert format tools table help",menu:{file:{title:"File",items:""},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"}},toolbar:"undo redo | h1 h2 h3 | bold italic underline strikethrough | forecolor backcolor removeformat | link quickimage | fontsize align lineheight numlist bullist | table media | outdent indent| charmap emoticons | codeformat pagebreak anchor codesample | ltr rtl | accordion accordionremove",autosave_ask_before_unload:!1,autosave_interval:"1s",autosave_prefix:"{path}{query}-{id}-",autosave_restore_when_empty:!1,autosave_retention:"2m",save_onsavecallback:()=>{},image_advtab:!0,importcss_append:!0,height:"100%",image_caption:!0,automatic_uploads:!0,images_upload_handler:K,quickbars_selection_toolbar:"bold italic underline strikethrough | forecolor backcolor removeformat | quicklink",quickbars_insert_toolbar:"quickimage quicktable numlist bullist pagebreak",quickbars_image_toolbar:"alignleft aligncenter alignright | rotateleft rotateright | imageoptions",noneditable_class:"mceNonEditable",toolbar_mode:"floating",contextmenu:"copy cut paste pastetext selectall | align | link image insertdatetime",skin:T?"oxide-dark":"oxide",content_css:T?"dark":"default",content_style:D}))[0];return l.editorUpload.addFilter(h=>!(!h.src||A[h.src])),l},j=_.debounce(()=>{const q=R.getContent(),l=new DOMParser().parseFromString(q,"text/html");l.querySelectorAll("img").forEach(h=>{const o=h.src,f=A[o];f&&(h.src="",h.dataset.filename=f.filename)}),nr(P,{content:l.body.innerHTML})},3e3),ne=()=>[...R.getDoc().querySelectorAll("h1,h2,h3,h4,h5,h6")].filter(l=>!0).map((l,h)=>(l.dataset[C]=h,[parseInt(l.tagName.substring(1)),l.innerText.replace(/\n*/g,""),h+""])),Z={},Y=async(q,W,l)=>{const h=async b=>{const we=b.src;if(l[we]){const{blob:Se,filename:Ie}=l[we],te=window.URL.createObjectURL(Se);A[te]={fileId:q,filename:Ie},b.src=te,b.dataset.filename=Ie}},f=new DOMParser().parseFromString(W,"text/html"),v=f.querySelectorAll("img");return await Promise.all([...v].map(h)),f.querySelectorAll("pre").forEach(b=>{const we=b.querySelector("code");if(we){let Se=we.dataset.lang||we.lang||"markup";const Ie=f.createElement("code");Ie.innerText=we.innerText;const te=f.createElement("pre");te.classList.add("language-"+Se),te.append(Ie),b.replaceWith(te)}}),f.body.innerHTML},u=q=>W=>{q.source.postMessage({type:"showProgressInfo",data:W},q.origin)},le=async q=>{var h;if(q.source===window)return;const W=q.data||{},l=W.data;switch(W.type){case"init":{if(R.on("ScrollContent",()=>{q.source.postMessage({type:"scroll"},q.origin)}),R.on("Change",()=>{const o=ne();j(),q.source.postMessage({type:"outline",data:{outline:o}},q.origin)}),(h=l.articleData)!=null&&h.html){const o=await Y(l.articleData.fileId,l.articleData.html,l.articleData.fileInfos);await nr(l.articleData.fileId,{title:l.articleData.title,meta:l.articleData.meta,type:"html",content:o},l.articleData.fileInfos),await $o(l.articleData.fileId),R.setContent(o),P=l.articleData.fileId}q.source.postMessage({type:"inited",data:{uniqueId:l.uniqueId,outline:ne()}},q.origin);break}case"wheel":{R.getDoc().documentElement.scrollTop+=l.deltaY;break}case"scrollToTarget":{const o=l.key,f=R.getDoc(),v=f.documentElement,b=R.getContentAreaContainer().getBoundingClientRect(),we=(Ie,te)=>{Ie.source.postMessage({type:"highlightPos",data:{info:te}},Ie.origin)};if(o==="home"){const Ie={top:0,left:0};v.scrollTo(Ie),Ie.top+=20,we(q,{offset:b,pos:"home"});return}if(o==="end"){const Ie={top:f.body.scrollHeight,left:0};v.scrollTo(Ie),we(q,{offset:b,pos:"end"});return}const Se=f.querySelector(`[data-xsj-header-outline="${o}"]`);if(Se){Se.scrollIntoViewIfNeeded();const Ie=Se.getBoundingClientRect();we(q,{offset:b,pos:{left:Ie.left,top:Ie.top}})}break}case"themeStyle":{const o=R.getDoc(),f=o.createElement("style");f.classList.add("theme-style"),f.innerHTML=l.style;const v=o.querySelector(".theme-style");v?v.replaceWith(f):o.head.append(f);break}case"print":{R.getDoc().defaultView.print();break}case"savePdf":{const o=(f,v)=>{setTimeout(()=>{v(f)},1)};Bo(l.authInfo,R.getContent(),l.title,l.themeStyle||"",l.exportConfig,o,{showProgressInfo:u(q)},(f,v,b,we)=>{q.source.postMessage({type:"savePdfResult",data:{uniqueId:l.uniqueId,error:f,downloadURL:b,downloadInfo:we}})})}case"getBlobByURLResult":{const o=l.uniqueId,f=Z[o];f&&(delete Z[o],f(l.err,l.blob));break}case"getHtml":{const o=R.getDoc(),f="vvvvvvvvvvvvvvvvvvvvvv";o.querySelectorAll("video").forEach(b=>{const we=tt.captureVideo(b);if(we){const Se=document.createElement("img");Se.src=we,Se.classList.add(f),b.parentElement.insertBefore(Se,b)}});const v=o.body.parentElement.outerHTML;o.querySelectorAll(`.${f}`).forEach(b=>b.remove()),q.source.postMessage({type:"getHtmlResult",data:{uniqueId:l.uniqueId,html:v}},q.origin)}}};if(window.parent!==window){const W=new URLSearchParams(globalThis.location.search).get("fileId");R=await M();const l={},h=await No(W);if(h){l.fileId=W,l.title=h.title,l.meta=h.meta;const o=h.content;R.setContent(o),P=W;const f=h.fileInfos;R.getDoc().querySelectorAll("img").forEach(async v=>{const b=v.dataset.filename;if(b&&f[b]){const we=await Mo(W,b),Se=we._attachments.attachment.data,Ie=window.URL.createObjectURL(Se);v.src=Ie,A[Ie]={fileId:we.docId,filename:we.filename}}})}(be=window.parent)==null||be.postMessage({type:"loaded",data:l},"*"),window.addEventListener("message",le)}else await M()})()});export default jo();
