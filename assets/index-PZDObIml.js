(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();const g={};g.parseBase64Data=function(n){var t,e;return e=n.substring(n.indexOf(":")+1,n.indexOf(";")),t=n.substring(n.indexOf(",")+1),{type:e,data:t}};g.parseQueryString=function(n){var t,e,r;return t=n.indexOf(":"),r="",e=n,t>0&&(r=n.substring(0,t),e=n.substring(t+1)),{tag:r,q:e}};g.dataURL2ObjectURL=function(n){if(!window.URL||!window.URL.createObjectURL)return"";const t=g.dataURL2Blob(n);return t?window.URL.createObjectURL(t):""};g.blobToString=function(n,t){const e=new FileReader;return e.onload=function(){return t(null,e.result)},e.readAsText(n)};g.base642Blob=function(n,t){var e,r,o,i,a,c,l,h,w,s,u,d;for(t=t||"",u=1024,i=atob(n),c=i.length,d=Math.ceil(c/u),o=new Array(d),s=0;s<d;){for(e=s*u,l=Math.min(e+u,c),a=new Array(l-e),w=e,h=0;w<l;)a[h]=i[w].charCodeAt(0),++h,++w;o[s]=new Uint8Array(a),s++}return r=new Blob(o,{type:t}),r};g.blob2Base64=function(n,t){var e;return e=new window.FileReader,e.onloadend=function(){var r,o;return o=e.result,r=o.substr(o.indexOf(",")+1),t(null,r)},e.readAsDataURL(n)};g.blob2Text=function(n,t){var e;return e=new window.FileReader,e.onloadend=function(){return t(null,e.result)},e.readAsText(n)};g.blob2DataURL=function(n,t){var e;return e=new window.FileReader,e.onloadend=function(){var r;return r=e.result,t(null,r)},e.readAsDataURL(n)};g.dataURL2String=function(n){var t,e,r,o,i,a,c;if(!(!window.URL||!window.URL.createObjectURL)){if(a=n.split(",")[0],r=n.split(",")[1],t="",a.indexOf("base64")>=0){c=function(l){var h,w,s,u;for(h=new ArrayBuffer(l.length),w=new Uint8Array(h),s=0,u=l.length;s<u;)w[s]=l.charCodeAt(s),s++;return h};try{t=atob(r),e=c(t),o=new TextDecoder("UTF-8"),t=o.decode(e)}catch(l){i=l,t=""}}else t=unescape(r);return t}};g.dataURL2Blob=function(n){var t,e,r,o,i,a,c,l,h;if(!(!window.URL||!window.URL.createObjectURL)){if(a=n.split(",")[0],r=n.split(",")[1],t="",a.indexOf("base64")>=0)try{t=atob(r)}catch(w){o=w,t=""}else t=unescape(r);for(i=a.split(":")[1].split(";")[0],e=new Uint8Array(t.length),c=l=0,h=t.length;0<=h?l<=h:l>=h;c=0<=h?++l:--l)e[c]=t.charCodeAt(c);return new Blob([e],{type:i})}};g.objectURLToArrayBuffer=function(n,t){var e;if(!n){t("objectURL required");return}return e=new XMLHttpRequest,e.open("GET",n,!0),e.responseType="arraybuffer",e.onload=function(r){return this.status===200||this.status===0?t(null,this.response,this.getResponseHeader("Content-Type")||"image/png"):t("convert error")},e.onerror=function(r){return t(r)},e.send()};g.objectURLToString=function(n,t){var e;return e=new XMLHttpRequest,e.open("GET",n,!0),e.responseType="text",e.onload=function(r){return this.status===200||this.status===0?t(null,this.response):t("convert error")},e.onerror=function(r){return t(r)},e.send()};g.urlToBlob=function(n,t){n||t(""),fetch(n,{referrer:""}).then(e=>e.blob()).then(e=>t(e)).catch(e=>{t("")})};g.urlToDataURL=function(n,t){var e;return e=new XMLHttpRequest,e.open("GET",n,!0),e.responseType="blob",e.onload=function(r){var o,i;return this.status===200||this.status===0?(o=this.response,i=new FileReader,i.onerror=function(a){return t(a)},i.onload=function(a){var c;return c=a.target.result,t(null,c)},i.readAsDataURL(o)):t("convert error")},e.onerror=function(r){t("error")},e.ontimeout=function(r){t("tiemout")},e.onabort=function(r){t("abort")},e.send()};g.stringToArrayBuffer=function(n){var t,e;return t=new TextEncoder,e=t.encode(n),e};g.arrayBufferToBase64=function(n){var t,e,r,o;for(t="",e=new Uint8Array(n),o=e.byteLength,r=0;r<o;)t+=String.fromCharCode(e[r]),r++;return window.btoa(t)};g.base64ToArrayBuffer=function(n){var t,e,r,o;for(t=window.atob(n),o=t.length,e=new Uint8Array(o),r=0;r<o;)e[r]=t.charCodeAt(r),r++;return e.buffer};g.blobToArrayBuffer=function(n,t){var e;return e=new FileReader,e.onerror=function(r){return t(r)},e.onload=function(){var r;return r=this.result,t(null,r)},e.readAsArrayBuffer(n)};g.arrayBufferToNodeBuffer=function(n){var t,e,r,o,i;for(t=new Buffer(n.byteLength),i=new Uint8Array(n),e=r=0,o=t.length;r<o;e=++r)t[e],t[e]=i[e];return t};g.nodeBufferToArrayBuffer=function(n){return new Uint8Array(n).buffer};g.blobToMd5=function(n,t){return g.blobToArrayBuffer(n,function(e){return function(r,o){var i,a;return o?(a=new SparkMD5.ArrayBuffer,a.append(o),i=a.end(),t(null,i)):t(r)}}())};const O={};O.timeoutFn=function(n="",t=3e3){return async function(){return new Promise(e=>{setTimeout(()=>{e(n)},t)})}};O.timeoutProxyFn=async function(n,t={}){const e=O.timeoutFn(t.result,t.maxTimeout);return Promise.race([n(),e()])};const b={},W=function(n){var t,e,r,o,i,a,c,l;for(c=[],r=[].slice.call(n.attributes),l=[],i=0,a=r.length;i<a;i++)e=r[i],t=e.name,t.indexOf("on")===0?(o={},o.attribute=e.name,o.value=e.value,c.push(o),l.push(n.attributes.removeNamedItem(t))):l.push(void 0);return l};b.stripScripts=function(n){var t,e,r,o,i,a,c,l,h,w,s;for(l=new DOMParser,s=l.parseFromString("","text/html"),r=s.body,r.innerHTML=n,c=r.getElementsByTagName("meta"),o=c.length;o--;)c[o].remove();for(h=r.getElementsByTagName("script"),o=h.length;o--;)t=h[o],t.remove();for(e=r.getElementsByTagName("*"),i=0,a=e.length;i<a;i++)w=e[i],W(w);return r.innerHTML};b.stripStyles=function(n){var t,e,r,o,i,a,c,l;for(a=new DOMParser,l=a.parseFromString("","text/html"),r=l.body,r.innerHTML=n,i=r.getElementsByTagName("link"),o=i.length;o--;)i[o].remove();for(c=r.getElementsByTagName("style"),o=c.length;o--;)t=c[o],e=t.outerHTML,t.outerHTML="<pre><code>"+_.escape(e)+"</code></pre>";return r.innerHTML};b.escapeHtml=function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};b.isElementInViewport=function(n){const t=n.ownerDocument;if(!t)return!1;const e=t.defaultView;if(!e)return!1;var r=n.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(e.innerHeight||t.documentElement.clientHeight)&&r.right<=(e.innerWidth||t.documentElement.clientWidth)};b.captureVideo=function(n){if(n.tagName!=="VIDEO")return"";const t=document.createElement("canvas");return t.width=n.videoWidth,t.height=n.videoHeight,t.getContext("2d").drawImage(n,0,0,n.videoWidth,n.videoHeight),t.toDataURL("image/jpeg")};b.appHighlightPos=function(n,t){if(t=t||{},t.skipIfHighlighting&&b.appHighlightPos.highlightPosTimeout)return;var e=document.querySelector(".app_highlight_pos_element"),r=function(){b.appHighlightPos.highlightPosTimeout&&clearTimeout(b.appHighlightPos.highlightPosTimeout),b.appHighlightPos.highlightPosTimeout=null,e&&e.parentNode&&e.parentNode.removeChild(e)};b.appHighlightPos.highlightPosTimeout&&(clearTimeout(b.appHighlightPos.highlightPosTimeout),b.appHighlightPos.highlightPosTimeout=null),e||(e=document.createElement("div"),e.classList.add("app_highlight_pos_element"),e.classList.add("highlight-pos"),document.body.append(e));let o=n.left,i=n.top;t.offsetLeft&&(o+=t.offsetLeft),t.offsetTop&&(i+=t.offsetTop),e.style.left=o+"px",e.style.top=i+"px",b.appHighlightPos.highlightPosTimeout=setTimeout(r,t.autoHideTimeout||1e3)};b.appHighlightPosByEl=function(n,t={}){const e=n.getBoundingClientRect(),r={left:e.left,top:e.top};t.rb&&(r.left+=e.width,r.top+=e.height),b.appHighlightPos(r,t)};b.convertElementToNewTagName=function(n,t){let e=n.tagName;const r=n.ownerDocument||document;if(e===t)return n;const o=r.createDocumentFragment();for(;n.firstChild;)o.appendChild(n.firstChild);const i=r.createElement(t);return i.appendChild(o),function(c,l){[...l.attributes].forEach(h=>{c.setAttribute(h.nodeName,h.nodeValue)})}(i,n),n.parentNode.replaceChild(i,n),i};window.CONSTANT||(window.CONSTANT={exportHosts:"http://localhost:3011",exportHost:"https://colorink.top"});var M;const H={host:(M=window.CONSTANT)==null?void 0:M.exportHost,maxFilesize:1024*1024*30},J=async function(n){const t=async function(){return(await(await fetch(H.host+"/getcrossorigindomainresource?"+new URLSearchParams({url:n}))).json()).data};return O.timeoutProxyFn(t,{maxTimeout:1e4})},X=function(n){const t=async function(r){return new Promise(function(o,i){n(r,function(a){o(a)})})},e=async function(r){const o=await t(r);return o||await J(r)};return function(r,o){e(r).then(o).catch(()=>o(""))}},G=function(n,t){const e=new Image;e.onload=function(){const r=document.createElement("canvas");r.width=this.naturalWidth,r.height=this.naturalHeight,r.getContext("2d").drawImage(this,0,0),r.toBlob(t,"image/jpeg",.95)},e.onerror=function(){t()},e.src=n.src},D=function(n,t){var e,r,o,i,a,c,l,h,w,s;const u=$(n);if(u.attr("width"),u.attr("height"),l=n.naturalWidth||u.width(),c=n.naturalHeight||u.height(),u.width(),u.height(),t.indexOf("data:image/svg")===0)return w=g.dataURL2String(t),i=`
      <!DOCTYPE html>
      <html lang="en">
        <head>
          <meta charset="UTF-8">
          <style>
          html, body{
            margin: 0;
            padding: 0;
            overflow: hidden;
          }
          body>svg{
            width: ${l}px!important;
            height: ${c}px!important;
            max-width: 100%!important;
          }
          </style>
        </head>
        <body>
        ${w}
        </body>
      </html>
    `,s=g.stringToArrayBuffer(i),a="data:text/html;base64,"+g.arrayBufferToBase64(s),h=u.attr("style"),r=u.attr("class"),o=u.attr("id"),e=$("<iframe src='"+a+"' style='max-width: 100%;'></iframe"),e.attr("width",l),e.attr("height",c),h&&e.attr("style",h),r&&e.attr("class",r),o&&e.attr("id",o),e.css({border:"0",overflow:"hidden",width:l,height:c,display:"inline-block"}),u.replaceWith(e)},Y=function(n){n.find(".attachment, video, audio, iframe").remove(),n.find("picture").each(function(t,e){b.convertElementToNewTagName(e,"div")}),n.find("figure").each(function(t,e){b.convertElementToNewTagName(e,"div")}),n.find("figcaption").each(function(t,e){b.convertElementToNewTagName(e,"span")})},K={marginTop:10,marginRight:10,marginBottom:10,marginLeft:10,zoom:1,orientation:"Portrait",pageSize:"A4",pageWidth:-1,pageHeiht:-1,title:"",background:!0,pageOffset:0,toc:!0,tocHeaderText:"",tocDisableDottedLine:!1,tocLevelIndentation:-1,tocCustomStyle:"",outline:!0,outlineDepth:4,footerCenter:"[page]/[toPage]",footerLeft:"",footerRight:"",footerFontName:"Arial",footerFontSize:10,footerLine:!1,footerSpacing:0,headerCenter:"[section]",headerLeft:"",headerRight:"",headerFontName:"Arial",headerFontSize:10,headerLine:!0,headerSpacing:3,password:"",cover:!0,coverTitle:"",coverTitleFont:"bold 2em/1.2 serif",coverTitleFontColor:"#000000",coverSubTitle:"",coverSubTitleFont:"1.5em/1.1 sans-serif",coverSubTitleFontColor:"#000000",coverAuthor:"",coverAuthorFont:"0.8em/1 serif",coverAuthorFontColor:"#bbbbbb",coverImagePath:"",coverImageMD5:"",watermarker:!0,watermarkerLetters:"",watermarkerLettersFont:"bold 2em/1 serif",watermarkerLettersFontColor:"#000",watermarkerPosition:"mc",watermarkerPositionXOffset:0,watermarkerPositionYOffset:0,watermarkerAngle:315,watermarkerOpacity:1,waterImagePath:""},Q=function(n,t,e,r,o,i,a,c){var x;n=n||{};const l=((x=n.user)==null?void 0:x.token)||"",h=n.authorizationHost||"";o=Object.assign({},K,o);const w=$("<div></div>");w.html(t),Y(w);const s={},u=a.showProgressInfo||function(){},d=a.isCancel||function(){return!1};if(o.coverImage&&o.coverImageMD5){const m=g.dataURL2Blob(o.coverImage),y=o.coverImage.split(";")[0];o.coverImage="",m.size>H.maxFilesize?o.coverImageMD5="":(o.coverImageForMD5Prefix=y,s[o.coverImageMD5]=m)}let f=0;const p=function(m,y){const R=$(m),I=m.src||"",P=function(){u(`(1/3) Converting imgs [${f++}/${T.length}] ...`),y()};X(i)(I,function(v){if(!v){m.src="",P();return}if(d()){P();return}if(/svg/i.test(m.dataset.filetype)){v.indexOf("data:image/svg")===0?(D(m,v),P()):g.urlToDataURL(v,function(F,A){A&&(D(m,A),P())});return}const U=function(F){if(!F||d()){P();return}return g.blobToMd5(F,function(A,C){return C&&(s[C]=F,m.src="",F.size>H.maxFilesize?u("filesize too big, system will ignore it","error",{el:m,size:F.size}):(R.attr("data-export-pdf-md5",C),R.attr("data-export-pdf",!0))),P()})};if(/webp|gif/i.test(m.dataset.filetype)){G(m,U);return}g.urlToBlob(v,U)})},L=function(m,y){if(d())return c("cancel");if(m==null&&(m="0"),y==null&&(y=0),y>10){c("upload fail by max limit");return}const R=1,I={fragment:w.html(),style:r,access_token:l,authorization_host_string:h,title:e,config:JSON.stringify(o),resourceMD5s:Object.keys(s),ignoreResource:m,resourceCacheVersion:R},P=JSON.stringify(I),N=new Blob([P]);return m==="0"&&u(`(2/3) Uploading html and process pdf [${filesize(N.size)}]...`),$.ajax({url:`${H.host}/pdf-server/vipexportpdffile`,type:"POST",data:I,success:function(v,U,F){if(!v||d())return c(JSON.stringify(v));if(v.uuid)return u(`(3/3) Downloading Pdf ${filesize(v.filesize)} ...`),c(null,v,`${H.host}/getpdffile?uuid=${v.uuid}`,v);if(v.resourceIds&&v.resourceIds.length>0){f=0,u(`(2/3) Uploading imgs [${f}/${v.resourceIds.length}] ...`);const A=function(E,z){const B=s[E],k=function(){B&&u(`(2/3) Uploading imgs [${f++}/${v.resourceIds.length}] ${filesize(B.size)}...`),z()};if(!B||d())return k();const S=new FormData,q=new File([B],E);return S.append("resourcefile",q),S.append("md5",E),S.append("access_token",l),S.append("authorization_host_string",h),S.append("resource_cache_version",R),$.ajax({url:`${H.host}/pdf-server/uploadresource`,type:"POST",data:S,processData:!1,contentType:!1,success:function(j,V,Z){return k()},error:function(j,V){return k()}})},C=function(){u("(3/3) Processing Pdf  ..."),L("1",++y)};return async.mapSeries(v.resourceIds,A,C)}return c(JSON.stringify(v))},error:function(v,U){return c(U)}})},T=w.find("img").toArray();return u(`(1/3) Converting imgs [${f}/${T.length}] ...`),async.mapLimit(T,20,p,function(){return L("0",0)})};(async function(){var w;const n="xsjHeaderOutline",t=window.matchMedia("(prefers-color-scheme: dark)").matches;window.matchMedia("(max-width: 1023.5px)").matches;const e="textarea#open-source-plugins";let r=null;const o=async(s={})=>(await tinymce.init({promotion:!1,branding:!1,resize:!1,help_accessibility:!1,selector:e,plugins:"importcss searchreplace autolink autosave save directionality code visualblocks visualchars image link media codesample table charmap pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help charmap quickbars emoticons accordion",editimage_cors_hosts:["picsum.photos"],menubar:"file edit view insert format tools table help",menu:{file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"}},toolbar:"undo redo | h1 h2 h3 | bold italic underline strikethrough | forecolor backcolor removeformat | link quickimage | fontsize align lineheight numlist bullist | table media | outdent indent| charmap emoticons | code pagebreak anchor codesample | ltr rtl | accordion accordionremove",autosave_ask_before_unload:!1,autosave_interval:"1s",autosave_prefix:"{path}{query}-{id}-",autosave_restore_when_empty:!1,autosave_retention:"2m",save_onsavecallback:()=>{},image_advtab:!0,importcss_append:!0,height:"100%",image_caption:!0,quickbars_selection_toolbar:"bold italic underline strikethrough | forecolor backcolor removeformat | quicklink",quickbars_insert_toolbar:"quickimage quicktable numlist bullist pagebreak",quickbars_image_toolbar:"alignleft aligncenter alignright | rotateleft rotateright | imageoptions",noneditable_class:"mceNonEditable",toolbar_mode:"floating",contextmenu:"copy cut paste pastetext selectall | align | link image insertdatetime",skin:t?"oxide-dark":"oxide",content_css:t?"dark":"default",content_style:s.contentStyle||"body { font-family:Helvetica,Arial,sans-serif; font-size:16px }"}))[0],i=()=>[...r.getDoc().querySelectorAll("h1,h2,h3,h4,h5,h6")].filter(d=>!0).map((d,f)=>(d.dataset[n]=f,[parseInt(d.tagName.substring(1)),d.innerText.replace(/\n*/g,""),f+""])),a={},c=async(s,u,d)=>{const f=async x=>{const m=x.src,y=d[m],R=window.URL.createObjectURL(y);x.src=R},L=new DOMParser().parseFromString(u,"text/html"),T=L.querySelectorAll("img");return await Promise.all([...T].map(f)),L.body.innerHTML},l=s=>u=>{s.source.postMessage({type:"showProgressInfo",data:u},s.origin)},h=async s=>{if(s.source===window)return;const u=s.data||{},d=u.data;switch(u.type){case"init":{r=await o(d),r.on("ScrollContent",()=>{s.source.postMessage({type:"scroll"},s.origin)}),r.on("SetContent",p=>{}),r.on("Change",()=>{const p=i();s.source.postMessage({type:"outline",data:{outline:p}},s.origin)});const f=await c(s,d.html,d.fileInfos);r.setContent(f),s.source.postMessage({type:"inited",data:{outline:i()}},s.origin);break}case"wheel":{r.getDoc().documentElement.scrollTop+=d.deltaY;break}case"scrollToTarget":{const f=d.key,p=r.getDoc(),L=p.documentElement,T=r.getContentAreaContainer().getBoundingClientRect(),x=(y,R)=>{y.source.postMessage({type:"highlightPos",data:{info:R}},y.origin)};if(f==="home"){const y={top:0,left:0};L.scrollTo(y),y.top+=20,x(s,{offset:T,pos:"home"});return}if(f==="end"){const y={top:p.body.scrollHeight,left:0};L.scrollTo(y),x(s,{offset:T,pos:"end"});return}const m=p.querySelector(`[data-xsj-header-outline="${f}"]`);if(m){m.scrollIntoViewIfNeeded();const y=m.getBoundingClientRect();x(s,{offset:T,pos:{left:y.left,top:y.top}})}break}case"themeStyle":{const f=r.getDoc(),p=f.createElement("style");p.classList.add("theme-style"),p.innerHTML=d.style;const L=f.querySelector(".theme-style");L?L.replaceWith(p):f.head.append(p);break}case"print":{r.getDoc().defaultView.print();break}case"savePdf":{const f=(p,L)=>{setTimeout(()=>{L(p)},1)};Q(d.authInfo,r.getContent(),d.title,d.themeStyle||"",d.exportConfig,f,{showProgressInfo:l(s)},(p,L,T,x)=>{s.source.postMessage({type:"savePdfResult",data:{uniqueId:d.uniqueId,error:p,downloadURL:T,downloadInfo:x}})})}case"getBlobByURLResult":{const f=d.uniqueId,p=a[f];p&&(delete a[f],p(d.err,d.blob));break}case"getHtml":{const f=r.getDoc(),p="vvvvvvvvvvvvvvvvvvvvvv";f.querySelectorAll("video").forEach(T=>{const x=b.captureVideo(T);if(x){const m=document.createElement("img");m.src=x,m.classList.add(p),T.parentElement.insertBefore(m,T)}});const L=f.body.parentElement.outerHTML;f.querySelectorAll(`.${p}`).forEach(T=>T.remove()),s.source.postMessage({type:"getHtmlResult",data:{uniqueId:d.uniqueId,html:L}},s.origin)}}};window.parent!==window?((w=window.parent)==null||w.postMessage({type:"loaded"},"*"),window.addEventListener("message",h)):await o()})();
